import{w as A,_ as j,a as E,m as Q}from"./DiI9-bkE.js";import{_ as W}from"./Bml5z8l2.js";import{_ as G}from"./CuFgEFCp.js";import{_ as H}from"./oJBVUttf.js";import{_ as J}from"./BdKneTYw.js";import{_ as X}from"./DkYr1hfb.js";import{_ as Y}from"./_BOBmhmt.js";import{_ as Z}from"./xC7ZNHnZ.js";import{_ as ee}from"./BkseHKFx.js";import{_ as te}from"./9B_i7pfW.js";import{_ as oe}from"./8gEztUrL.js";import{b as se,c as le,d as ae,t as ie,e as ne}from"./adOTzFDE.js";import{c as O}from"./B3KMLFeu.js";import{p as q,ai as re,w as de,z as c,a1 as h,a2 as d,u as s,R as L,Q as o,a7 as l,i as F,a6 as u,c as T,r as S,j as me,A as _,W as B,ah as ue,a5 as R}from"./Cp_GvCOL.js";import{f as ce}from"./CE7u-7DH.js";import"./CM1DIlR0.js";import"./BlLzDdHJ.js";import"./DaMwIZ4f.js";import"./BnfZ4xmv.js";import"./CangPKqO.js";import"./C8Jf-TuN.js";import"./DVCf4JVd.js";import"./D7PB4JkZ.js";import"./DZaB2s8a.js";import"./C-fFc4Sm.js";import"./De6cJ90F.js";import"./DnWsfCtc.js";import"./7ga_NNx6.js";import"./_eNQqsN0.js";import"./B9BvCEkO.js";const pe={class:"flex items-center gap-2"},fe={class:"font-semibold"},_e={class:"p-4 rounded-lg bg-(--ui-bg-elevated) border border-(--ui-border)"},ge={class:"flex items-center gap-2 mb-4"},be={class:"grid grid-cols-2 gap-4"},xe={class:"p-4 rounded-lg bg-(--ui-bg-elevated) border border-(--ui-border)"},ve={class:"flex items-center gap-2 mb-4"},ye={class:"grid grid-cols-2 gap-4"},Ve={class:"p-4 rounded-lg bg-(--ui-bg-elevated) border border-(--ui-border)"},$e={class:"flex items-center gap-2 mb-4"},we={class:"flex items-center gap-6"},he={class:"flex items-center h-9"},ke={class:"ml-2 text-sm"},Ue={class:"flex items-center h-9"},Me={class:"ml-2 text-sm"},Ce=q({__name:"Edit",props:{dialog:{type:Boolean,default:!1},currentForm:{default:()=>({})}},emits:["update:dialog","refresh"],setup(b,{emit:k}){const g=b,x=k,r=T({get:()=>g.dialog,set:i=>x("update:dialog",i)}),v=()=>{r.value=!1},y=re("formRef"),V=A(),m=T({get:()=>t.form.state===2,set:i=>{t.form.state=i?2:0}}),n=T({get:()=>t.form.stream===2,set:i=>{t.form.stream=i?2:1}}),t=S({loading:!1,testing:!1,form:{},presetOptions:[],modelOptions:[],modelLoading:!1}),$=async()=>{t.modelLoading=!0;const{data:i}=await se({});i&&(t.presetOptions=i.list.map(e=>({label:e.name,value:e.id}))),t.modelLoading=!1};async function w(){t.loading=!0;try{const i=O(t.form),{error:e}=await(i.id?le:ae)(i);e||(V.add({title:"保存成功",color:"success"}),v(),x("refresh"))}finally{t.loading=!1}}async function U(){if(!t.form.id){V.add({title:"请先保存模型",color:"warning"});return}t.testing=!0;try{const{data:i,error:e}=await ie({id:t.form.id});!e&&i?.list&&(t.modelOptions=i.list.map(p=>({label:p,value:p})),t.form.m&&!i.list.includes(t.form.m)&&t.modelOptions.unshift({label:t.form.m,value:t.form.m}),V.add({title:"获取模型列表成功",color:"success"}))}finally{t.testing=!1}}return de(()=>g.dialog,i=>{i&&(t.loading=!1,t.form=O(g.currentForm),$())}),(i,e)=>{const p=E,M=H,f=J,I=X,C=Y,N=Z,z=ee,K=te,D=j,P=oe;return c(),h(P,{open:s(r),"onUpdate:open":e[11]||(e[11]=a=>F(r)?r.value=a:null),ui:{content:"sm:max-w-4xl",footer:"justify-end"}},{header:d(()=>[o("div",pe,[l(p,{name:"i-lucide-bot",class:"w-5 h-5 text-(--ui-primary)"}),o("span",fe,u(b.currentForm.id?"编辑模型":"新建模型"),1)])]),body:d(()=>[l(K,{ref_key:"formRef",ref:y,state:s(t).form,class:"space-y-4",onSubmit:w},{default:d(()=>[o("div",_e,[o("div",ge,[l(p,{name:"i-lucide-info",class:"w-4 h-4 text-(--ui-primary)"}),e[12]||(e[12]=o("span",{class:"text-sm font-medium"},"基本信息",-1))]),o("div",be,[l(f,{label:"名称",name:"name",required:""},{default:d(()=>[l(M,{modelValue:s(t).form.name,"onUpdate:modelValue":e[0]||(e[0]=a=>s(t).form.name=a),modelModifiers:{trim:!0},placeholder:"输入模型名称"},null,8,["modelValue"])]),_:1}),l(f,{label:"预设类型",name:"preset_id",required:""},{default:d(()=>[l(I,{modelValue:s(t).form.preset_id,"onUpdate:modelValue":e[1]||(e[1]=a=>s(t).form.preset_id=a),items:s(t).presetOptions,loading:s(t).modelLoading,placeholder:"选择预设"},null,8,["modelValue","items","loading"])]),_:1}),l(f,{label:"描述",name:"description",class:"col-span-2"},{default:d(()=>[l(C,{modelValue:s(t).form.description,"onUpdate:modelValue":e[2]||(e[2]=a=>s(t).form.description=a),modelModifiers:{trim:!0},placeholder:"输入描述",rows:3,autoresize:"",class:"w-full"},null,8,["modelValue"])]),_:1})])]),o("div",xe,[o("div",ve,[l(p,{name:"i-lucide-settings",class:"w-4 h-4 text-(--ui-primary)"}),e[13]||(e[13]=o("span",{class:"text-sm font-medium"},"模型配置",-1))]),o("div",ye,[l(f,{label:"模型标识 (f)",name:"f",required:""},{default:d(()=>[l(M,{modelValue:s(t).form.f,"onUpdate:modelValue":e[3]||(e[3]=a=>s(t).form.f=a),modelModifiers:{trim:!0},placeholder:"输入模型标识",disabled:!!b.currentForm.id},null,8,["modelValue","disabled"])]),_:1}),l(f,{label:"模型名称 (m)",name:"m",required:""},{default:d(()=>[s(t).modelOptions.length?(c(),h(N,{key:0,modelValue:s(t).form.m,"onUpdate:modelValue":e[4]||(e[4]=a=>s(t).form.m=a),items:s(t).modelOptions,placeholder:"选择模型名称",searchable:""},null,8,["modelValue","items"])):(c(),h(M,{key:1,modelValue:s(t).form.m,"onUpdate:modelValue":e[5]||(e[5]=a=>s(t).form.m=a),modelModifiers:{trim:!0},placeholder:"点击测试链接获取模型列表"},null,8,["modelValue"]))]),_:1}),l(f,{label:"Key",name:"key",required:"",class:"col-span-2"},{default:d(()=>[l(C,{modelValue:s(t).form.key,"onUpdate:modelValue":e[6]||(e[6]=a=>s(t).form.key=a),modelModifiers:{trim:!0},placeholder:"输入 Key",rows:2,autoresize:"",class:"w-full"},null,8,["modelValue"])]),_:1}),l(f,{label:"请求地址",name:"uri",required:"",class:"col-span-2"},{default:d(()=>[l(C,{modelValue:s(t).form.uri,"onUpdate:modelValue":e[7]||(e[7]=a=>s(t).form.uri=a),modelModifiers:{trim:!0},placeholder:"输入请求地址",rows:2,autoresize:"",class:"w-full"},null,8,["modelValue"])]),_:1})])]),o("div",Ve,[o("div",$e,[l(p,{name:"i-lucide-sliders-horizontal",class:"w-4 h-4 text-(--ui-primary)"}),e[14]||(e[14]=o("span",{class:"text-sm font-medium"},"其他设置",-1))]),o("div",we,[l(f,{label:"流式输出",name:"stream"},{default:d(()=>[o("div",he,[l(z,{modelValue:s(n),"onUpdate:modelValue":e[8]||(e[8]=a=>F(n)?n.value=a:null)},null,8,["modelValue"]),o("span",ke,u(s(n)?"是":"否"),1)])]),_:1}),l(f,{label:"状态",name:"state"},{default:d(()=>[o("div",Ue,[l(z,{modelValue:s(m),"onUpdate:modelValue":e[9]||(e[9]=a=>F(m)?m.value=a:null)},null,8,["modelValue"]),o("span",Me,u(s(m)?"启用":"关闭"),1)])]),_:1})])])]),_:1},8,["state"])]),footer:d(()=>[b.currentForm.id?(c(),h(D,{key:0,loading:s(t).testing,label:"测试链接",color:"warning",variant:"outline",icon:"i-lucide-play",onClick:U},null,8,["loading"])):L("",!0),e[15]||(e[15]=o("div",{class:"flex-1"},null,-1)),l(D,{label:"取消",color:"neutral",variant:"outline",onClick:v}),l(D,{loading:s(t).loading,label:"保存",onClick:e[10]||(e[10]=a=>s(y)?.submit())},null,8,["loading"])]),_:1},8,["open"])}}}),De=Object.assign(Ce,{__name:"CommonModelEdit"}),Fe={key:0,class:"flex items-center justify-center py-20"},Te={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4"},Oe={class:"flex items-center justify-between mb-3"},Le={class:"flex items-center gap-2"},ze={class:"w-8 h-8 rounded-lg bg-(--ui-primary)/10 flex items-center justify-center"},Be={class:"font-medium"},Re={class:"text-xs text-(--ui-text-muted)"},je={class:"space-y-2 text-xs mb-3"},Ee={class:"flex items-center gap-2"},qe={class:"bg-(--ui-bg) px-1.5 py-0.5 rounded truncate"},Se={class:"flex items-center gap-2"},Ie={class:"bg-(--ui-bg) px-1.5 py-0.5 rounded truncate"},Ne={class:"flex items-center gap-2"},Ke={class:"truncate"},Pe={class:"flex items-center gap-2"},Ae={key:0,class:"text-xs text-(--ui-text-muted) mb-3 line-clamp-2"},Qe={class:"text-xs text-(--ui-text-muted) mb-3"},We={class:"flex items-center justify-end gap-2 pt-3 border-t border-(--ui-border)"},Ge={key:2,class:"text-center py-20 text-(--ui-text-muted)"},kt=q({name:"CommonModelList",__name:"list",setup(b){const k=Q(),g={2:["启用","success"],0:["关闭","error"]},x={2:["是","success"],1:["否","neutral"]},r=S({loading:!1,list:[],isDialog:!1,currentForm:{}}),v=async()=>{r.loading=!0;try{const{data:m}=await ne({});r.list=m?.list||[]}finally{r.loading=!1}},y=m=>{r.currentForm=m?O(m):{state:2,stream:2},r.isDialog=!0},V=()=>{r.isDialog=!1,v()};return me(()=>v()),(m,n)=>{const t=j,$=E,w=W,U=G,i=De;return c(),_(B,null,[l(U,null,{actions:d(()=>[l(t,{label:"新增",icon:"i-lucide-plus",onClick:n[0]||(n[0]=e=>y())})]),default:d(()=>[s(r).loading?(c(),_("div",Fe,[l($,{name:"i-lucide-loader",class:"w-8 h-8 animate-spin text-(--ui-text-muted)"})])):(c(),_("div",Te,[(c(!0),_(B,null,ue(s(r).list,e=>(c(),_("div",{key:e.id,class:"p-4 rounded-xl bg-(--ui-bg-elevated) border border-(--ui-border) hover:border-(--ui-primary) transition-all"},[o("div",Oe,[o("div",Le,[o("div",ze,[l($,{name:"i-lucide-bot",class:"w-4 h-4 text-(--ui-primary)"})]),o("div",null,[o("div",Be,u(e.name),1),o("div",Re," ID: "+u(e.id),1)])]),l(w,{color:g[e.state]?.[1]||"neutral",variant:"subtle"},{default:d(()=>[R(u(g[e.state]?.[0]||"未知"),1)]),_:2},1032,["color"])]),o("div",je,[o("div",Ee,[n[2]||(n[2]=o("span",{class:"text-(--ui-text-muted) w-16 shrink-0"},"模型标识",-1)),o("code",qe,u(e.f||"-"),1)]),o("div",Se,[n[3]||(n[3]=o("span",{class:"text-(--ui-text-muted) w-16 shrink-0"},"模型名称",-1)),o("code",Ie,u(e.m||"-"),1)]),o("div",Ne,[n[4]||(n[4]=o("span",{class:"text-(--ui-text-muted) w-16 shrink-0"},"预设",-1)),o("span",Ke,u(e.preset_name||"-"),1)]),o("div",Pe,[n[5]||(n[5]=o("span",{class:"text-(--ui-text-muted) w-16 shrink-0"},"流式",-1)),l(w,{color:x[e.stream]?.[1]||"neutral",variant:"subtle",size:"xs"},{default:d(()=>[R(u(x[e.stream]?.[0]||"-"),1)]),_:2},1032,["color"])])]),e.description?(c(),_("div",Ae,u(e.description),1)):L("",!0),o("div",Qe," 更新于 "+u(("formatToDateTime"in m?m.formatToDateTime:s(ce))(e.updated_at)),1),o("div",We,[l(t,{size:"xs",color:"neutral",variant:"ghost",icon:"i-lucide-pencil",label:"编辑",onClick:p=>y(e)},null,8,["onClick"]),l(t,{size:"xs",color:"neutral",variant:"ghost",icon:"i-lucide-key",label:"Token",onClick:p=>s(k).push(`/model/token/${e.id}`)},null,8,["onClick"])])]))),128))])),!s(r).loading&&s(r).list.length===0?(c(),_("div",Ge,[l($,{name:"i-lucide-bot",class:"w-12 h-12 mx-auto mb-2 opacity-50"}),n[6]||(n[6]=o("p",null,"暂无模型",-1))])):L("",!0)]),_:1}),l(i,{dialog:s(r).isDialog,"onUpdate:dialog":n[1]||(n[1]=e=>s(r).isDialog=e),"current-form":s(r).currentForm,onRefresh:V},null,8,["dialog","current-form"])],64)}}});export{kt as default};
