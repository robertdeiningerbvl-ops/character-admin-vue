import{_ as S}from"./CEcF5dWm.js";import{f as R,c as T,ap as V,j as C,aE as j,l as q,a as E,o as $,w as d,B as l,_ as D,b as r,a4 as P,aF as e,aq as A,i as L,k as K,A as N,C as I,D as z,G as O,ax as G}from"./DhOLkSnF.js";import{_ as H,a as J,b as Q,c as W}from"./DAqc9GYg.js";import{_ as X}from"./CSbqei5V.js";import{_ as Y}from"./CEomfZlh.js";import{_ as Z}from"./DAIKkUkW.js";import{_ as ee}from"./DAeRr84W.js";import{_ as te}from"./Db__RPjw.js";import{_ as ae}from"./BZLiX_8y.js";import{u as se,g as re}from"./CzWoDhk-.js";import{o as oe,n as F}from"./B-mCBPct.js";import{u as ie,b as le}from"./Bo5OMT4U.js";import{_ as B}from"./-rcGzxkB.js";import{_ as U}from"./CLU2_0cD.js";import{f as ne}from"./BmKy9gZZ.js";import{c as ce}from"./45RcOEEf.js";import"./CZg69nbc.js";import"./CwtpYSSp.js";import"./DPsBupTg.js";import"./9Rxep3Q5.js";import"./CLKxJTZi.js";import"./D0vBe5Vh.js";import"./BrXYpapi.js";import"./BXSyqGa5.js";import"./CVanS2c1.js";import"./HRiyi1uV.js";const me=R({__name:"battery",props:{dialog:{type:Boolean,default:!1},currentForm:{default:()=>({})},factoryOwnerOptions:{}},emits:["update:dialog","refresh"],setup(a,{emit:t}){const c=a,u=t,s=T({get(){return c.dialog},set(i){u("update:dialog",i)}}),x=()=>{s.value=!1},f=V("formRef"),g=oe({id:F(),battery:F()}),n=C({loading:!1,form:{id:void 0,battery:void 0}}),b=j();async function o(){n.loading=!0;const i={uid:n.form.id,battery:Number(n.form.battery)},{error:m}=await se(i);m||(b.add({title:"操作成功",color:"success"}),u("refresh")),n.loading=!1}return q(()=>c.dialog,i=>{i&&(n.loading=!1,n.form={id:c.currentForm.id,battery:void 0})}),(i,m)=>{const _=Z,h=ee,w=te,y=D,v=ae;return $(),E(v,{open:r(s),"onUpdate:open":m[2]||(m[2]=p=>P(s)?s.value=p:null),title:"充值",dismissible:!1,ui:{footer:"justify-end"}},{body:d(()=>[l(w,{ref_key:"formRef",ref:f,schema:r(g),state:r(n).form,class:"flex flex-col gap-4",onSubmit:o},{default:d(()=>[l(h,{label:"电量",name:"battery",required:""},{default:d(()=>[l(_,{modelValue:r(n).form.battery,"onUpdate:modelValue":m[0]||(m[0]=p=>r(n).form.battery=p),modelModifiers:{trim:!0},placeholder:"请输入",type:"number",class:"w-full",ui:{trailing:"pe-1"}},null,8,["modelValue"])]),_:1})]),_:1},8,["schema","state"])]),footer:d(()=>[l(y,{label:"取消",color:"neutral",variant:"outline",onClick:x}),l(y,{loading:r(n).loading,label:"确认",variant:"solid",onClick:m[1]||(m[1]=p=>r(f)?.submit())},null,8,["loading"])]),_:1},8,["open"])}}}),de=Object.assign(me,{__name:"MemberListBattery"}),M={2:["启用","success"],1:["待审核","warning"],4:["已删除","error"]},pe=[{accessorKey:"id",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},header:()=>e(D,{color:"neutral",variant:"ghost",label:"ID",class:"-mx-2.5 hover:bg-transparent focus:bg-transparent data-[state=open]:bg-transparent"}),cell:({row:a})=>e("span",{class:"font-mono text-sm text-gray-600 dark:text-gray-400"},`#${a.original.id}`)},{accessorKey:"avatar",header:"头像",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},cell:({row:a})=>{const t=a.original.avatar;return t?e(A,{src:t,alt:"avatar",size:"lg",class:"ring-2 ring-primary-200 dark:ring-primary-800"}):e("div",{class:"w-10 h-10 rounded-full bg-gradient-to-br from-primary-100 to-primary-200 dark:from-primary-900 dark:to-primary-800 flex items-center justify-center"},e("i",{class:"i-material-symbols-person w-6 h-6 text-primary-600 dark:text-primary-400"}))}},{accessorKey:"username",header:"客户昵称",searchPlaceholder:"筛选昵称",cell:({row:a})=>{const t=a.original.username;return t?e("div",{class:"flex items-center gap-2"},[e("i",{class:"i-material-symbols-person-outline w-4 h-4 text-primary-500"}),e("span",{class:"font-medium text-gray-900 dark:text-white"},t)]):e("span",{class:"text-gray-400 dark:text-gray-500"},"-")},meta:{class:{th:"w-[150px]",td:"w-[150px]"}}},{accessorKey:"is_admin",header:"官方号？",meta:{class:{th:"w-[90px]",td:"w-[80px]"}},cell:({row:a})=>a.original.is_admin===2?e(B,{variant:"solid",color:"orange",class:"font-bold"},()=>e("div",{class:"flex items-center gap-1"},[e("i",{class:"i-material-symbols-verified w-4 h-4"}),e("span","官方")])):e("span",{class:"text-gray-400 dark:text-gray-500"},"-")},{accessorKey:"battery",header:"账户电量",cell:({row:a})=>{const t=a.original.battery||0;return e("div",{class:"flex items-center gap-1.5"},[e("i",{class:"i-material-symbols-bolt w-4 h-4 text-yellow-600"}),e("span",{class:"font-semibold text-yellow-700 dark:text-yellow-400"},t)])},meta:{class:{th:"w-[120px]",td:"w-[120px]"}}},{accessorKey:"income_battery",header:"收益电量",cell:({row:a})=>{const t=a.original.income_battery||0;return e("div",{class:"flex items-center gap-1.5"},[e("i",{class:"i-material-symbols-trending-up w-4 h-4 text-green-600"}),e("span",{class:"font-semibold text-green-700 dark:text-green-400"},t)])},meta:{class:{th:"w-[120px]",td:"w-[120px]"}}},{accessorKey:"gift_battery",header:"赠送电量",cell:({row:a})=>{const t=a.original.gift_battery||0;return e("div",{class:"flex items-center gap-1.5"},[e("i",{class:"i-material-symbols-card-giftcard w-4 h-4 text-blue-600"}),e("span",{class:"font-semibold text-blue-700 dark:text-blue-400"},t)])},meta:{class:{th:"w-[120px]",td:"w-[120px]"}}},{accessorKey:"source",searchPlaceholder:"来源",header:"来源",meta:{class:{th:"w-[120px]",td:"w-[120px]"}},cell:({row:a})=>{const t=a.original.source;return t?e(B,{variant:"subtle",color:"primary"},()=>t):e("span",{class:"text-gray-400"},"-")}},{accessorKey:"code",header:"邀请码",cell:({row:a})=>{const t=a.original.code;return t?e("div",{class:"flex items-center gap-2"},[e("i",{class:"i-material-symbols-qr-code-2 w-4 h-4 text-blue-500"}),e("span",{class:"font-mono text-sm font-medium text-gray-900 dark:text-white"},t)]):e("span",{class:"text-gray-400"},"-")},meta:{class:{th:"w-[140px]",td:"w-[140px]"}}},{accessorKey:"invite",header:"邀请人数",cell:({row:a})=>{const t=a.original.invite||0;return e("div",{class:"flex items-center gap-1.5"},[e("i",{class:"i-material-symbols-person-add-outline w-4 h-4 text-purple-600"}),e("span",{class:"font-semibold text-purple-700 dark:text-purple-400"},t)])},meta:{class:{th:"w-[120px]",td:"w-[120px]"}}},{accessorKey:"income_amount",header:"累计收益",cell:({row:a})=>{const t=a.original.income_amount||0;return e("div",{class:"flex items-center gap-1.5"},[e("i",{class:"i-material-symbols-monetization-on-outline w-4 h-4 text-green-600"}),e("span",{class:"font-semibold text-green-700 dark:text-green-400"},`¥${t}`)])},meta:{class:{th:"w-[120px]",td:"w-[120px]"}}},{accessorKey:"created_at",header:"创建时间",meta:{class:{th:"w-[180px]",td:"w-[180px]"}},cell:({row:a})=>{const t=a.original.created_at;return t?e("div",{class:"flex items-center gap-1.5"},[e("i",{class:"i-material-symbols-schedule-outline w-4 h-4 text-gray-400 dark:text-gray-500"}),e("span",{class:"text-sm text-gray-600 dark:text-gray-300"},ne(t))]):e("span",{class:"text-gray-400"},"-")}},{accessorKey:"remarks",header:"备注",meta:{class:{th:"w-[100px]",td:"w-[100px]"}},cell:({row:a})=>{const t=a.original.remarks;return t?e(U,{text:t,ui:{content:"max-w-xs",text:"whitespace-pre-wrap break-all select-text"}},()=>e("div",{class:"flex items-center gap-2"},[e("i",{class:"i-material-symbols-note-outline w-4 h-4 text-gray-400 dark:text-gray-500"}),e("div",{class:"truncate text-gray-600 dark:text-gray-300"},t)])):e("span",{class:"text-gray-400"},"-")}},{accessorKey:"summary",header:"简介",meta:{class:{th:"w-[100px]",td:"w-[100px]"}},cell:({row:a})=>{const t=a.original.summary,c=a.original.fetish;return!t&&!c?e("span",{class:"text-gray-400"},"-"):e(U,{text:`${t||""}
${c||""}`},()=>e("div",{class:"cursor-pointer space-y-1"},[t&&e("p",{class:"truncate text-gray-700 dark:text-gray-300"},t),c&&e("p",{class:"truncate text-xs text-gray-500 dark:text-gray-400"},c)]))}},{accessorKey:"state",header:"状态",meta:{class:{th:"w-[100px]",td:"w-[100px]"}},searchPlaceholder:"筛选状态",formItemProps:{component:"Select",componentProps:{options:[{label:"待审核",value:1},{label:"启用",value:2},{label:"已删除",value:4}]}},cell:({row:a})=>e(B,{class:"capitalize",variant:"subtle",color:M[a.original.state]?.[1]},()=>M[a.original.state]?.[0])}],ue={key:0,class:"absolute top-0 left-0 right-0 h-(--ui-header-height) flex items-center justify-between border-b border-(--ui-border) px-4 sm:px-6 bg-(--ui-bg)"},fe={class:"flex items-center gap-4"},Le=R({name:"MemberList",__name:"list",setup(a){const c=ie(le).smaller("lg"),u=L(),s=C({isDialog:!1,isDialogBattery:!1,currentForm:{}}),x=async o=>{s.isDialog=!0,o?s.currentForm=ce(o):s.currentForm={state:2}},f=async o=>{s.isDialogBattery=!0,s.currentForm={id:o.id}},g=async()=>{u.value.reload(),s.isDialog=!1,s.isDialogBattery=!1};function n(o){const i=G();return[{label:"编辑",icon:"material-symbols:edit-square-outline",onSelect(){x(o.original)}},{label:"充值",icon:"material-symbols:battery-charging-full",onSelect(){f(o.original)}},{type:"separator"},{label:"查看收藏",icon:"material-symbols:visibility-outline",onSelect(){i.push(`/member/collect/${o.original.id}`)}},{type:"separator"},{label:"查看邀请",icon:"material-symbols:visibility-outline",onSelect(){i.push(`/member/invite/${o.original.id}`)}}]}const b=[...pe,{id:"actions",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},cell:({row:o})=>e("div",{class:"text-right"},e(S,{content:{align:"end"},items:n(o)},()=>e(D,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost",class:"ml-auto"})))}];return(o,i)=>{const m=J,_=H,h=Q,w=X,y=W,v=Y,p=de;return $(),K(O,null,[l(y,{ui:{body:"pb-[12px]! gap-0!"}},N({body:d(()=>[r(c)?I("",!0):($(),K("div",ue,[z("div",fe,[l(m),l(h)])])),l(w,{ref_key:"tableRef",ref:u,"data-request":r(re),columns:b,"scroll-x":"min-w-[1200px]"},null,8,["data-request"])]),_:2},[r(c)?{name:"header",fn:d(()=>[l(_,{title:"客户列表"},{leading:d(()=>[l(m)]),_:1})]),key:"0"}:void 0]),1024),l(v,{dialog:r(s).isDialog,"onUpdate:dialog":i[0]||(i[0]=k=>r(s).isDialog=k),"current-form":r(s).currentForm,onRefresh:g},null,8,["dialog","current-form"]),l(p,{dialog:r(s).isDialogBattery,"onUpdate:dialog":i[1]||(i[1]=k=>r(s).isDialogBattery=k),"current-form":r(s).currentForm,onRefresh:g},null,8,["dialog","current-form"])],64)}}});export{Le as default};
