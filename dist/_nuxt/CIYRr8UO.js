import{_ as D}from"./CEcF5dWm.js";import{i as d,ay as v,aF as t,_,f as R,c as $,a as B,o as g,A as z,w as u,b as h,B as l,k as S,C as K,D as P}from"./DhOLkSnF.js";import{_ as L,a as M,b as N,c as T}from"./DAqc9GYg.js";import{_ as U}from"./CSbqei5V.js";import{u as V,b as A}from"./Bo5OMT4U.js";import{_ as E}from"./-rcGzxkB.js";import{_ as j}from"./CLU2_0cD.js";import{l as q,m as F,n as G}from"./CxuEfYss.js";import{f as H}from"./BmKy9gZZ.js";import{u as J}from"./BVQSm7Ip.js";import"./CZg69nbc.js";import"./CwtpYSSp.js";import"./DPsBupTg.js";import"./9Rxep3Q5.js";import"./CLKxJTZi.js";import"./DAIKkUkW.js";import"./D0vBe5Vh.js";import"./BrXYpapi.js";import"./BXSyqGa5.js";import"./BZLiX_8y.js";function O(){const e=d(new Set),o=d(new Set),a=d({}),n=v();return{expandedIds:e,loadingIds:o,replyMap:a,toggle:async i=>{const s=i.id;if(e.value.has(s)){e.value.delete(s);return}if(e.value.add(s),a.value[s])return;const p=n.params.id;o.value.add(s);try{const m=await q({comment_id:s,biz_id:p});console.log("res",m),a.value[s]=m.data.list}finally{o.value.delete(s)}}}}const{expandedIds:Q,loadingIds:W,replyMap:X,toggle:Y}=O(),Z={2:["待审核","warning"],1:["启用","success"],4:["已删除","error"]},ee=[{accessorKey:"id",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},header:()=>t(_,{color:"neutral",variant:"ghost",label:"ID",class:"-mx-2.5 hover:bg-transparent focus:bg-transparent data-[state=open]:bg-transparent"})},{accessorKey:"content",header:"内容名称",cell:({row:e})=>{const o=e.original.id,a=Q.value.has(o),n=W.value.has(o),c=X.value[o]||[];return t("div",{class:"space-y-2"},[t(j,{text:e.original.content,ui:{content:"max-w-[200px] h-auto",text:"whitespace-pre-wrap break-all select-text"}},()=>t("div",{class:"truncate font-medium"},e.original.content)),t(_,{size:"xs",variant:"ghost",loading:n,icon:a?"i-heroicons-chevron-up":"i-heroicons-chevron-down",onClick:()=>Y(e.original)},()=>a?"收起回复":"查看回复"),a&&t("div",{class:"pl-3 border-l space-y-2 text-sm"},c.length?c.map(i=>t("div",{key:i.id},[t("div",{class:"font-medium"},i.member.username),t("div",{class:"text-gray-600"},i.content)])):t("div",{class:"text-gray-400"},"暂无回复"))])}},{accessorKey:"member.username",header:"评论用户",cell:({row:e})=>t("div",void 0,[t("p",{class:"font-medium text-(--ui-text-highlighted)"},e.original.member.username),t("p",{class:"text-xs text-gray-500"},`ID: ${e.original.member.id}`)])},{accessorKey:"created_at",meta:{class:{th:"w-[150px]",td:"w-[150px]"}},header:"创建时间",cell:({row:e})=>H(e.original.created_at)},{accessorKey:"state",meta:{class:{th:"w-[100px]",td:"w-[80px]"}},header:"状态",searchPlaceholder:"筛选状态",formItemProps:{component:"Select",componentProps:{options:[{label:"待审核",value:2},{label:"启用",value:1},{label:"已删除",value:4}]}},cell:({row:e})=>{const o=e.original.state,[a,n]=Z[o]||["未知","neutral"];return t(E,{class:"capitalize",variant:"subtle",color:n},()=>a)}}],te={key:0,class:"absolute top-0 left-0 right-0 h-(--ui-header-height) flex items-center justify-between border-b border-(--ui-border) px-4 sm:px-6 bg-(--ui-bg)"},ae={class:"flex items-center gap-4"},Ce=R({name:"MemberCollectList",__name:"[id]",setup(e){const a=V(A).smaller("lg"),n=d(),c=J(),i=v(),s=$(()=>i.params.id),p=r=>F({...r,biz_id:s.value}),m=async r=>{const{error:b}=await G({id:r.id});b||n.value.reload()};function x(r){return[{label:"删除",icon:"material-symbols:contract-delete-outline-rounded",color:"error",onSelect(){c.open({color:"error",title:"删除数据",description:"您确定要删除吗？",onPositiveClick(){m(r.original)}})}}]}const y=[...ee,{id:"actions",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},cell:({row:r})=>t("div",{class:"text-right"},t(D,{content:{align:"end"},items:x(r)},()=>t(_,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost",class:"ml-auto"})))}];return(r,b)=>{const f=M,w=L,C=N,k=U,I=T;return g(),B(I,{ui:{body:"pb-[12px]! gap-0!"}},z({body:u(()=>[h(a)?K("",!0):(g(),S("div",te,[P("div",ae,[l(f),l(C)])])),l(k,{ref_key:"tableRef",ref:n,"data-request":p,columns:y,"scroll-x":"min-w-[1200px]"},null,512)]),_:2},[h(a)?{name:"header",fn:u(()=>[l(w,{title:"评论列表"},{leading:u(()=>[l(f)]),_:1})]),key:"0"}:void 0]),1024)}}});export{Ce as default};
