import{_ as E}from"./CEcF5dWm.js";import{f as S,c as R,ap as I,j as B,aE as N,l as O,a as j,o as V,w as i,D as o,B as l,E as q,I as z,_ as P,b as n,F as b,a4 as M,aF as r,i as A,k as T,A as L,C as G,G as H}from"./DhOLkSnF.js";import{_ as J,a as Q,b as W,c as X}from"./DAqc9GYg.js";import{_ as Y}from"./CSbqei5V.js";import{_ as Z}from"./DAIKkUkW.js";import{_ as ee}from"./DAeRr84W.js";import{_ as te}from"./D0vBe5Vh.js";import{_ as ae}from"./Db__RPjw.js";import{_ as se}from"./BZLiX_8y.js";import{a as oe,b as re}from"./wj9UriJM.js";import{c as F}from"./45RcOEEf.js";import{o as ne,n as le,c as ie}from"./B-mCBPct.js";import{u as me,b as ce}from"./Bo5OMT4U.js";import{_ as D}from"./-rcGzxkB.js";import{f as de}from"./BmKy9gZZ.js";import"./CZg69nbc.js";import"./CwtpYSSp.js";import"./DPsBupTg.js";import"./9Rxep3Q5.js";import"./CLKxJTZi.js";import"./HRiyi1uV.js";import"./BrXYpapi.js";import"./BXSyqGa5.js";const pe={class:"p-6"},ue={class:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-5 mb-6"},fe={class:"grid grid-cols-2 gap-4"},_e={class:"space-y-1"},ge={class:"font-mono text-sm font-medium text-gray-900 dark:text-white"},xe={class:"space-y-1"},ye={class:"font-mono text-xs text-gray-600 dark:text-gray-300"},be={class:"space-y-1"},he={class:"font-medium text-gray-900 dark:text-white"},we={class:"space-y-1"},ke={class:"font-semibold text-blue-700 dark:text-blue-400"},ve={class:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-5 space-y-5"},$e={class:"grid grid-cols-2 gap-4"},Ue={class:"flex items-center justify-between w-full"},De={class:"text-sm text-gray-500 dark:text-gray-400"},Ve={class:"flex gap-3"},Fe=S({__name:"Edit",props:{dialog:{type:Boolean,default:!1},currentForm:{default:()=>({})}},emits:["update:dialog","refresh"],setup(a,{emit:t}){const m=a,p=t,c=R({get(){return m.dialog},set(u){p("update:dialog",u)}}),h=()=>{c.value=!1},g=I("formRef"),w=ne({real_amount:ie.number().min(0),state:le().min(0)}),k=[{label:"已完成",value:2},{label:"未支付",value:0}],s=B({loading:!1,form:{}}),x=N();async function y(){s.loading=!0;const u=F(s.form),{error:e}=await oe(u);e||(x.add({title:"操作成功",color:"success"}),p("refresh")),s.loading=!1}return O(()=>m.dialog,u=>{u&&(s.loading=!1,s.form=F(m.currentForm))}),(u,e)=>{const _=Z,f=ee,v=te,$=ae,U=z,K=P,C=se;return V(),j(C,{open:n(c),"onUpdate:open":e[5]||(e[5]=d=>M(c)?c.value=d:null),title:"编辑订单",dismissible:!1,ui:{content:"sm:max-w-2xl",body:"p-0",footer:"justify-end bg-gray-50 dark:bg-gray-900"}},{body:i(()=>[o("div",pe,[o("div",ue,[e[10]||(e[10]=o("h4",{class:"font-semibold text-gray-900 dark:text-white mb-4"}," 订单信息 ",-1)),o("div",fe,[o("div",_e,[e[6]||(e[6]=o("p",{class:"text-xs text-gray-500 dark:text-gray-400"}," 订单号 ",-1)),o("p",ge,b(n(s).form.order_sn||"-"),1)]),o("div",xe,[e[7]||(e[7]=o("p",{class:"text-xs text-gray-500 dark:text-gray-400"}," 支付单号 ",-1)),o("p",ye,b(n(s).form.trade_no||"-"),1)]),o("div",be,[e[8]||(e[8]=o("p",{class:"text-xs text-gray-500 dark:text-gray-400"}," 用户名 ",-1)),o("p",he,b(n(s).form.member?.username||"-"),1)]),o("div",we,[e[9]||(e[9]=o("p",{class:"text-xs text-gray-500 dark:text-gray-400"}," 订单金额 ",-1)),o("p",ke," ¥"+b(n(s).form.order_amount||0),1)])])]),l($,{ref_key:"formRef",ref:g,schema:n(w),state:n(s).form,class:"space-y-6",onSubmit:y},{default:i(()=>[o("div",ve,[e[12]||(e[12]=o("h4",{class:"font-semibold text-gray-900 dark:text-white mb-1"}," 可编辑信息 ",-1)),l(f,{label:"备注",name:"remark"},{default:i(()=>[l(_,{modelValue:n(s).form.remark,"onUpdate:modelValue":e[0]||(e[0]=d=>n(s).form.remark=d),modelModifiers:{trim:!0},class:"w-full",placeholder:"请输入备注信息",size:"lg"},null,8,["modelValue"])]),_:1}),o("div",$e,[l(f,{label:"能量",name:"coins",required:""},{default:i(()=>[l(_,{modelValue:n(s).form.coins,"onUpdate:modelValue":e[1]||(e[1]=d=>n(s).form.coins=d),modelModifiers:{number:!0},type:"number",step:"1",min:"0",placeholder:"请输入能量值",class:"w-full",size:"lg"},null,8,["modelValue"])]),_:1}),l(f,{label:"实付金额",name:"real_amount",required:""},{default:i(()=>[l(_,{modelValue:n(s).form.real_amount,"onUpdate:modelValue":e[2]||(e[2]=d=>n(s).form.real_amount=d),modelModifiers:{number:!0},type:"number",step:"0.01",min:"0",placeholder:"0.00",class:"w-full",size:"lg"},{trailing:i(()=>[...e[11]||(e[11]=[o("span",{class:"text-sm text-gray-500"},"¥",-1)])]),_:1},8,["modelValue"])]),_:1})]),l(f,{label:"状态",name:"state",required:""},{default:i(()=>[l(v,{modelValue:n(s).form.state,"onUpdate:modelValue":e[3]||(e[3]=d=>n(s).form.state=d),items:k,placeholder:"请选择订单状态",class:"w-full",size:"lg"},null,8,["modelValue"])]),_:1})])]),_:1},8,["schema","state"])])]),footer:i(()=>[o("div",Ue,[o("div",De,[l(U,{name:"i-material-symbols-info-outline",class:"inline w-4 h-4"}),e[13]||(e[13]=q(" 修改后将更新订单信息 ",-1))]),o("div",Ve,[l(K,{label:"取消",color:"neutral",variant:"outline",size:"lg",onClick:h},{leading:i(()=>[l(U,{name:"i-material-symbols-close"})]),_:1}),l(K,{loading:n(s).loading,label:"确认保存",variant:"solid",size:"lg",onClick:e[4]||(e[4]=d=>n(g)?.submit())},{leading:i(()=>[l(U,{name:"i-material-symbols-check"})]),_:1},8,["loading"])])])]),_:1},8,["open"])}}}),Pe=Object.assign(Fe,{__name:"PaymentOrderEdit"}),Ke={0:["待支付","warning"],2:["已支付","success"]},Te={4:["自建","primary"],3:["支付宝","info"],2:["微信","success"],1:["USDT","warning"]},Se=[{accessorKey:"id",header:()=>r(P,{color:"neutral",variant:"ghost",label:"ID",class:"-mx-2.5 hover:bg-transparent focus:bg-transparent data-[state=open]:bg-transparent"}),cell:({row:a})=>r("span",{class:"font-mono text-sm text-gray-600 dark:text-gray-400"},`#${a.original.id}`),meta:{class:{th:"w-[80px]",td:"w-[80px]"}}},{accessorKey:"member.username",searchPlaceholder:"请输入用户名",header:"用户信息",meta:{class:{th:"w-[150px]",td:"w-[150px]"}},cell:({row:a})=>{const t=a.original.member?.username,m=a.original.uid;return t?r("div",{class:"space-y-0.5"},[r("div",{class:"font-medium text-gray-900 dark:text-white text-sm"},t),r("div",{class:"text-xs text-gray-500"},`ID: ${m||"-"}`)]):r("span",{class:"text-gray-400"},"-")}},{accessorKey:"order_sn",searchPlaceholder:"请输入订单号",header:"订单号",cell:({row:a})=>{const t=a.original.order_sn;return t?r("span",{class:"font-mono text-sm text-gray-700 dark:text-gray-300"},t):r("span",{class:"text-gray-400"},"-")},meta:{class:{th:"w-[180px]",td:"w-[180px]"}}},{accessorKey:"trade_no",searchPlaceholder:"请输入支付单号",header:"支付单号",cell:({row:a})=>{const t=a.original.trade_no;return t?r("span",{class:"font-mono text-xs text-gray-600 dark:text-gray-400"},t):r("span",{class:"text-gray-400"},"-")},meta:{class:{th:"w-[180px]",td:"w-[180px]"}}},{accessorKey:"coins",header:"能量",cell:({row:a})=>{const t=a.original.coins||0;return r("span",{class:"font-semibold text-yellow-600 dark:text-yellow-400"},t)},meta:{class:{th:"w-[100px]",td:"w-[100px]"}}},{accessorKey:"order_amount",header:"订单金额",cell:({row:a})=>{const t=a.original.order_amount||0;return r("span",{class:"font-semibold text-gray-900 dark:text-white"},`¥${t}`)},meta:{class:{th:"w-[120px]",td:"w-[120px]"}}},{accessorKey:"real_amount",header:"实付金额",cell:({row:a})=>{const t=a.original.real_amount||0;return r("span",{class:"font-semibold text-green-600 dark:text-green-400"},`¥${t}`)},meta:{class:{th:"w-[120px]",td:"w-[120px]"}}},{accessorKey:"remark",header:"备注",meta:{class:{th:"w-[150px]",td:"w-[150px]"}},cell:({row:a})=>{const t=a.original.remark;return t?r("span",{class:"text-sm text-gray-600 dark:text-gray-300 truncate"},t):r("span",{class:"text-gray-400"},"-")}},{accessorKey:"payment_type_name",header:"支付类型",cell:({row:a})=>{const t=a.original.payment_type_name;return t?r(D,{variant:"subtle",color:"neutral"},()=>t):r("span",{class:"text-gray-400"},"-")},meta:{class:{th:"w-[120px]",td:"w-[120px]"}}},{accessorKey:"payment_ty",header:"支付方式",meta:{class:{th:"w-[120px]",td:"w-[120px]"}},formItemProps:{component:"Select",componentProps:{options:[{label:"自建",value:4},{label:"支付宝",value:3},{label:"微信",value:2},{label:"USDT",value:1}]}},cell:({row:a})=>{const t=a.original.payment_ty,[m,p]=Te[t]||["未知","neutral"];return r(D,{variant:"subtle",color:p},()=>m)}},{accessorKey:"state",meta:{class:{th:"w-[100px]",td:"w-[100px]"}},header:"状态",formItemProps:{component:"Select",componentProps:{options:[{label:"待支付",value:0},{label:"已支付",value:2}]}},cell:({row:a})=>{const t=a.original.state,[m,p]=Ke[t]||["未知","neutral"];return r(D,{variant:"subtle",color:p},()=>m)}},{accessorKey:"created_at",header:"创建时间",meta:{class:{th:"w-[180px]",td:"w-[180px]"}},cell:({row:a})=>{const t=a.original.created_at;return t?r("span",{class:"text-sm text-gray-600 dark:text-gray-300"},de(t)):r("span",{class:"text-gray-400"},"-")}}],Be={key:0,class:"absolute top-0 left-0 right-0 h-(--ui-header-height) flex items-center justify-between border-b border-(--ui-border) px-4 sm:px-6 bg-(--ui-bg)"},Ce={class:"flex items-center gap-4"},ot=S({name:"PaymentOrderList",__name:"order",setup(a){const m=me(ce).smaller("lg"),p=A(),c=B({isDialog:!1,currentForm:{}}),h=async s=>{c.isDialog=!0,s?c.currentForm=F(s):c.currentForm={state:2}},g=async()=>{p.value.reload(),c.isDialog=!1};function w(s){return[{label:"编辑",icon:"material-symbols:edit-square-outline",onSelect(){h(s.original)}}]}const k=[...Se,{id:"actions",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},cell:({row:s})=>r("div",{class:"text-right"},r(E,{content:{align:"end"},items:w(s)},()=>r(P,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost",class:"ml-auto"})))}];return(s,x)=>{const y=Q,u=J,e=W,_=Y,f=X,v=Pe;return V(),T(H,null,[l(f,{ui:{body:"pb-[12px]! gap-0!"}},L({body:i(()=>[n(m)?G("",!0):(V(),T("div",Be,[o("div",Ce,[l(y),l(e)])])),l(_,{ref_key:"tableRef",ref:p,"data-request":n(re),columns:k,"scroll-x":"min-w-[1800px]"},null,8,["data-request"])]),_:2},[n(m)?{name:"header",fn:i(()=>[l(u,{title:"支付订单列表"},{leading:i(()=>[l(y)]),_:1})]),key:"0"}:void 0]),1024),l(v,{dialog:n(c).isDialog,"onUpdate:dialog":x[0]||(x[0]=$=>n(c).isDialog=$),"current-form":n(c).currentForm,onRefresh:g},null,8,["dialog","current-form"])],64)}}});export{ot as default};
