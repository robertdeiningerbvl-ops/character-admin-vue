import{_ as ae}from"./1OJ4jHSB.js";import{w as N,_ as K,x as S,a as y,y as le,z as re,m as ie}from"./DiI9-bkE.js";import{_ as ne}from"./Odvr87Pg.js";import{_ as de}from"./CuFgEFCp.js";import{_ as C}from"./Bml5z8l2.js";import{_ as q}from"./oJBVUttf.js";import{_ as A}from"./BdKneTYw.js";import{_ as me}from"./DkYr1hfb.js";import{_ as ce}from"./_BOBmhmt.js";import{_ as Q}from"./9B_i7pfW.js";import{_ as W}from"./8gEztUrL.js";import{g as ue,u as pe,a as fe,b as xe}from"./B33qAI9M.js";import{c as M}from"./B3KMLFeu.js";import{p as T,ai as G,w as H,z as D,a1 as I,a2 as d,a7 as l,u as o,Q as e,a6 as u,a5 as J,R as ge,i as X,c as Y,h as Z,r as E,E as a,A as be,W as _e}from"./Cp_GvCOL.js";import{_ as U}from"./Baq49nZQ.js";import{f as ve}from"./CE7u-7DH.js";import"./D7PB4JkZ.js";import"./C-fFc4Sm.js";import"./DnWsfCtc.js";import"./C6Y-ieo6.js";import"./De6cJ90F.js";import"./BrwH2_O0.js";import"./7ga_NNx6.js";import"./BHtpJmxp.js";import"./BlLzDdHJ.js";import"./CM1DIlR0.js";import"./K6pfE6CB.js";import"./B9BvCEkO.js";import"./DxT_AjaP.js";import"./DaMwIZ4f.js";import"./BnfZ4xmv.js";import"./CangPKqO.js";import"./C8Jf-TuN.js";import"./DVCf4JVd.js";import"./DZaB2s8a.js";const ye={class:"flex items-center gap-2"},he={class:"font-semibold"},we={class:"p-4 rounded-lg bg-(--ui-bg-elevated) border border-(--ui-border)"},$e={class:"flex items-center gap-4"},Ve={class:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity rounded-full flex items-center justify-center"},Ue={class:"flex-1 min-w-0"},Fe={class:"flex items-center gap-2 mb-1"},ke={class:"font-semibold text-lg"},Me={class:"text-sm text-(--ui-text-muted)"},De={class:"text-xs text-(--ui-text-muted)"},Be={class:"p-4 rounded-lg bg-(--ui-bg-elevated) border border-(--ui-border)"},Re={class:"flex items-center gap-2 mb-3"},Le={class:"grid grid-cols-4 gap-3 text-center"},ze={class:"p-2 rounded bg-(--ui-bg) border border-(--ui-border)"},Ce={class:"text-lg font-semibold text-pink-500"},Ie={class:"p-2 rounded bg-(--ui-bg) border border-(--ui-border)"},Ke={class:"text-lg font-semibold text-blue-500"},Se={class:"p-2 rounded bg-(--ui-bg) border border-(--ui-border)"},Te={class:"text-lg font-semibold text-orange-500"},Ee={class:"p-2 rounded bg-(--ui-bg) border border-(--ui-border)"},Pe={class:"text-lg font-semibold text-teal-500"},je={class:"p-2 rounded bg-(--ui-bg) border border-(--ui-border)"},Oe={class:"text-lg font-semibold text-purple-500"},Ne={class:"p-2 rounded bg-(--ui-bg) border border-(--ui-border)"},qe={class:"text-lg font-semibold text-yellow-500"},Ae={class:"p-2 rounded bg-(--ui-bg) border border-(--ui-border)"},Qe={class:"text-lg font-semibold text-green-500"},We={class:"p-2 rounded bg-(--ui-bg) border border-(--ui-border)"},Ge={class:"text-lg font-semibold text-green-600"},He={class:"p-4 rounded-lg bg-(--ui-bg-elevated) border border-(--ui-border) space-y-4"},Je={class:"flex items-center gap-2"},Xe={class:"grid grid-cols-2 gap-4"},Ye={class:"grid grid-cols-2 gap-4"},Ze={class:"p-4 rounded-lg bg-(--ui-bg-elevated) border border-(--ui-border) space-y-4"},et={class:"flex items-center gap-2"},tt=T({__name:"Edit",props:{dialog:{type:Boolean,default:!1},currentForm:{default:()=>({})}},emits:["update:dialog","refresh"],setup(i,{emit:r}){const n=i,v=r,g=Y({get(){return n.dialog},set(x){v("update:dialog",x)}}),F=()=>{g.value=!1},w=G("formRef"),p=Z(),m=[{label:"启用",value:2},{label:"待审核",value:1},{label:"已删除",value:4}],b=[{label:"保密",value:0},{label:"男",value:1},{label:"女",value:2}],_=[{label:"否",value:0},{label:"是",value:2}],t=E({loading:!1,avatarLoading:!1,form:{},levelOptions:[]});async function $(x){const s=x.target;if(s.files?.length&&le(s.files[0])){t.avatarLoading=!0;const{data:f}=await re({image:s.files[0]});f&&(t.form.avatar=f.uri),t.avatarLoading=!1}}function k(){p.value?.click()}const V=N();async function B(){const{data:x,error:s}=await ue();!s&&x?.list&&(t.levelOptions=x.list.map(f=>({label:f.name,value:f.id})))}async function R(){t.loading=!0;const{error:x}=await pe(M(t.form));x||(V.add({title:"操作成功",color:"success"}),v("refresh")),t.loading=!1}return H(()=>n.dialog,x=>{x&&(t.loading=!1,t.form=M(n.currentForm),B())}),(x,s)=>{const f=y,ee=S,te=C,P=q,h=A,L=me,z=ce,se=Q,j=K,oe=W;return D(),I(oe,{open:o(g),"onUpdate:open":s[9]||(s[9]=c=>X(g)?g.value=c:null),ui:{content:"sm:max-w-2xl",footer:"justify-end"}},{header:d(()=>[e("div",ye,[l(f,{name:"i-lucide-user-cog",class:"w-5 h-5 text-(--ui-primary)"}),e("span",he,u(i.currentForm.id?"编辑用户":"新增用户"),1)])]),body:d(()=>[l(se,{ref_key:"formRef",ref:w,state:o(t).form,class:"space-y-4",onSubmit:R},{default:d(()=>[e("div",we,[e("div",$e,[e("div",{class:"relative group cursor-pointer",onClick:k},[l(ee,{src:o(t).form.avatar,alt:o(t).form.username,size:"xl"},null,8,["src","alt"]),e("div",Ve,[l(f,{name:"i-lucide-camera",class:"w-5 h-5 text-white"})]),e("input",{ref_key:"fileRef",ref:p,type:"file",class:"hidden",accept:".jpg,.jpeg,.png",onChange:$},null,544)]),e("div",Ue,[e("div",Fe,[e("span",ke,u(o(t).form.username||"未设置"),1),o(t).form.is_admin===2?(D(),I(te,{key:0,color:"warning",variant:"solid",size:"xs"},{default:d(()=>[...s[10]||(s[10]=[J(" 官方 ",-1)])]),_:1})):ge("",!0)]),e("div",Me," ID: "+u(o(t).form.id)+" · "+u(o(t).form.source||"-"),1),e("div",De," 邀请码: "+u(o(t).form.code||"-"),1)])])]),e("div",Be,[e("div",Re,[l(f,{name:"i-lucide-bar-chart-2",class:"w-4 h-4 text-(--ui-primary)"}),s[11]||(s[11]=e("span",{class:"text-sm font-medium"},"数据统计",-1))]),e("div",Le,[e("div",ze,[e("div",Ce,u(o(t).form.fans||0),1),s[12]||(s[12]=e("div",{class:"text-xs text-(--ui-text-muted)"}," 粉丝 ",-1))]),e("div",Ie,[e("div",Ke,u(o(t).form.focus||0),1),s[13]||(s[13]=e("div",{class:"text-xs text-(--ui-text-muted)"}," 关注 ",-1))]),e("div",Se,[e("div",Te,u(o(t).form.publish_count||0),1),s[14]||(s[14]=e("div",{class:"text-xs text-(--ui-text-muted)"}," 发布 ",-1))]),e("div",Ee,[e("div",Pe,u(o(t).form.game_num||0),1),s[15]||(s[15]=e("div",{class:"text-xs text-(--ui-text-muted)"}," 游戏 ",-1))]),e("div",je,[e("div",Oe,u(o(t).form.invite||0),1),s[16]||(s[16]=e("div",{class:"text-xs text-(--ui-text-muted)"}," 邀请 ",-1))]),e("div",Ne,[e("div",qe,u(o(t).form.battery||0),1),s[17]||(s[17]=e("div",{class:"text-xs text-(--ui-text-muted)"}," 电量 ",-1))]),e("div",Ae,[e("div",Qe,u(o(t).form.income_battery||0),1),s[18]||(s[18]=e("div",{class:"text-xs text-(--ui-text-muted)"}," 收益电量 ",-1))]),e("div",We,[e("div",Ge," ¥"+u(o(t).form.income_amount||0),1),s[19]||(s[19]=e("div",{class:"text-xs text-(--ui-text-muted)"}," 收益金额 ",-1))])])]),e("div",He,[e("div",Je,[l(f,{name:"i-lucide-user",class:"w-4 h-4 text-(--ui-primary)"}),s[20]||(s[20]=e("span",{class:"text-sm font-medium"},"基本信息",-1))]),l(h,{label:"昵称",name:"username"},{default:d(()=>[l(P,{modelValue:o(t).form.username,"onUpdate:modelValue":s[0]||(s[0]=c=>o(t).form.username=c),modelModifiers:{trim:!0},placeholder:"请输入昵称",class:"w-full"},null,8,["modelValue"])]),_:1}),e("div",Xe,[l(h,{label:"性别",name:"sex"},{default:d(()=>[l(L,{modelValue:o(t).form.sex,"onUpdate:modelValue":s[1]||(s[1]=c=>o(t).form.sex=c),items:b,placeholder:"请选择",class:"w-full"},null,8,["modelValue"])]),_:1}),l(h,{label:"状态",name:"state"},{default:d(()=>[l(L,{modelValue:o(t).form.state,"onUpdate:modelValue":s[2]||(s[2]=c=>o(t).form.state=c),items:m,placeholder:"请选择",class:"w-full"},null,8,["modelValue"])]),_:1})]),e("div",Ye,[l(h,{label:"官方号",name:"is_admin"},{default:d(()=>[l(L,{modelValue:o(t).form.is_admin,"onUpdate:modelValue":s[3]||(s[3]=c=>o(t).form.is_admin=c),items:_,placeholder:"请选择",class:"w-full"},null,8,["modelValue"])]),_:1}),l(h,{label:"修改密码",name:"password"},{default:d(()=>[l(P,{modelValue:o(t).form.password,"onUpdate:modelValue":s[4]||(s[4]=c=>o(t).form.password=c),modelModifiers:{trim:!0},type:"password",placeholder:"留空则不修改",class:"w-full"},null,8,["modelValue"])]),_:1})]),l(h,{label:"备注",name:"remarks"},{default:d(()=>[l(z,{modelValue:o(t).form.remarks,"onUpdate:modelValue":s[5]||(s[5]=c=>o(t).form.remarks=c),modelModifiers:{trim:!0},placeholder:"请输入备注",class:"w-full",rows:2},null,8,["modelValue"])]),_:1})]),e("div",Ze,[e("div",et,[l(f,{name:"i-lucide-file-text",class:"w-4 h-4 text-(--ui-primary)"}),s[21]||(s[21]=e("span",{class:"text-sm font-medium"},"详细信息",-1))]),l(h,{label:"简介",name:"summary"},{default:d(()=>[l(z,{modelValue:o(t).form.summary,"onUpdate:modelValue":s[6]||(s[6]=c=>o(t).form.summary=c),modelModifiers:{trim:!0},placeholder:"请输入简介",class:"w-full",rows:2},null,8,["modelValue"])]),_:1}),l(h,{label:"爱好",name:"fetish"},{default:d(()=>[l(z,{modelValue:o(t).form.fetish,"onUpdate:modelValue":s[7]||(s[7]=c=>o(t).form.fetish=c),modelModifiers:{trim:!0},placeholder:"请输入爱好",class:"w-full",rows:2},null,8,["modelValue"])]),_:1})])]),_:1},8,["state"])]),footer:d(()=>[l(j,{label:"取消",color:"neutral",variant:"outline",onClick:F}),l(j,{loading:o(t).loading,label:"确认",onClick:s[8]||(s[8]=c=>o(w)?.submit())},null,8,["loading"])]),_:1},8,["open"])}}}),st=Object.assign(tt,{__name:"MemberListEdit"}),ot={class:"flex items-center gap-2"},at={class:"p-4 rounded-lg bg-(--ui-bg-elevated) border border-(--ui-border)"},lt={class:"flex items-center gap-3"},rt={class:"font-medium"},it={class:"text-xs text-(--ui-text-muted)"},nt={class:"ml-auto text-right"},dt={class:"text-lg font-semibold text-yellow-500"},mt={class:"p-4 rounded-lg bg-(--ui-bg-elevated) border border-(--ui-border) space-y-3"},ct={class:"flex items-center gap-2"},ut={class:"text-xs text-(--ui-text-muted)"},pt={class:"text-yellow-500 font-medium"},ft=T({__name:"battery",props:{dialog:{type:Boolean,default:!1},currentForm:{default:()=>({})}},emits:["update:dialog","refresh"],setup(i,{emit:r}){const n=i,v=r,g=Y({get(){return n.dialog},set(_){v("update:dialog",_)}}),F=()=>{g.value=!1},w=G("formRef"),p=E({loading:!1,form:{id:void 0,battery:void 0}}),m=N();async function b(){p.loading=!0;const{error:_}=await fe({uid:p.form.id,battery:Number(p.form.battery)});_||(m.add({title:"充值成功",color:"success"}),v("refresh")),p.loading=!1}return H(()=>n.dialog,_=>{_&&(p.loading=!1,p.form={id:n.currentForm.id,battery:void 0})}),(_,t)=>{const $=y,k=S,V=q,B=A,R=Q,x=K,s=W;return D(),I(s,{open:o(g),"onUpdate:open":t[2]||(t[2]=f=>X(g)?g.value=f:null),ui:{footer:"justify-end",content:"sm:max-w-md"}},{header:d(()=>[e("div",ot,[l($,{name:"i-lucide-zap",class:"w-5 h-5 text-yellow-500"}),t[3]||(t[3]=e("span",{class:"font-semibold"},"电量充值",-1))])]),body:d(()=>[l(R,{ref_key:"formRef",ref:w,state:o(p).form,class:"space-y-4",onSubmit:b},{default:d(()=>[e("div",at,[e("div",lt,[l(k,{src:i.currentForm.avatar,alt:i.currentForm.username,size:"lg"},null,8,["src","alt"]),e("div",null,[e("div",rt,u(i.currentForm.username||"-"),1),e("div",it," ID: "+u(i.currentForm.id),1)]),e("div",nt,[t[4]||(t[4]=e("div",{class:"text-xs text-(--ui-text-muted)"}," 当前电量 ",-1)),e("div",dt,u(i.currentForm.battery||0),1)])])]),e("div",mt,[e("div",ct,[l($,{name:"i-lucide-plus-circle",class:"w-4 h-4 text-(--ui-primary)"}),t[5]||(t[5]=e("span",{class:"text-sm font-medium"},"充值电量",-1))]),l(B,{name:"battery",required:""},{default:d(()=>[l(V,{modelValue:o(p).form.battery,"onUpdate:modelValue":t[0]||(t[0]=f=>o(p).form.battery=f),modelModifiers:{number:!0},placeholder:"请输入充值电量",type:"number",class:"w-full",size:"lg"},{leading:d(()=>[l($,{name:"i-lucide-zap",class:"w-4 h-4 text-yellow-500"})]),_:1},8,["modelValue"])]),_:1}),e("div",ut,[t[6]||(t[6]=J(" 充值后电量: ",-1)),e("span",pt,u((i.currentForm.battery||0)+(o(p).form.battery||0)),1)])])]),_:1},8,["state"])]),footer:d(()=>[l(x,{label:"取消",color:"neutral",variant:"outline",onClick:F}),l(x,{loading:o(p).loading,label:"确认充值",color:"warning",onClick:t[1]||(t[1]=f=>o(w)?.submit())},null,8,["loading"])]),_:1},8,["open"])}}}),xt=Object.assign(ft,{__name:"MemberListBattery"}),O={2:["启用","success"],1:["待审核","warning"],4:["已删除","error"]},gt=[{accessorKey:"id",header:"ID",searchPlaceholder:"UID",formItemProps:{field:"uid"},meta:{class:{th:"w-[100px]",td:"w-[100px]"}},cell:({row:i})=>a("span",{class:"font-mono text-sm text-(--ui-text-muted)"},i.original.id)},{accessorKey:"username",header:"用户",searchPlaceholder:"用户昵称",meta:{class:{th:"w-[180px]",td:"w-[180px]"}},cell:({row:i})=>{const{avatar:r,username:n,source:v,is_admin:g}=i.original;return a("div",{class:"flex items-center gap-2"},[a(S,{src:r,alt:n,size:"sm"}),a("div",{class:"min-w-0"},[a("div",{class:"flex items-center gap-1"},[a("span",{class:"font-medium truncate"},n||"-"),g===2&&a(C,{color:"warning",variant:"solid",size:"xs"},()=>"官")]),a("div",{class:"text-xs text-(--ui-text-muted) truncate"},v||"-")])])}},{accessorKey:"stats",header:"数据统计",meta:{class:{th:"w-[160px]",td:"w-[160px]"}},cell:({row:i})=>{const r=i.original;return a("div",{class:"flex flex-col gap-1 text-xs"},[a("div",{class:"flex items-center gap-3"},[a(U,{text:"粉丝"},()=>a("span",{class:"inline-flex items-center gap-1 text-pink-500 cursor-help"},[a(y,{name:"i-lucide-heart",class:"w-3 h-3"}),r.fans||0])),a(U,{text:"关注"},()=>a("span",{class:"inline-flex items-center gap-1 text-blue-500 cursor-help"},[a(y,{name:"i-lucide-bookmark",class:"w-3 h-3"}),r.focus||0])),a(U,{text:"发布"},()=>a("span",{class:"inline-flex items-center gap-1 text-orange-500 cursor-help"},[a(y,{name:"i-lucide-file-text",class:"w-3 h-3"}),r.publish_count||0]))]),a("div",{class:"flex items-center gap-3"},[a(U,{text:"游戏"},()=>a("span",{class:"inline-flex items-center gap-1 text-teal-500 cursor-help"},[a(y,{name:"i-lucide-gamepad-2",class:"w-3 h-3"}),r.game_num||0])),a(U,{text:"邀请"},()=>a("span",{class:"inline-flex items-center gap-1 text-purple-500 cursor-help"},[a(y,{name:"i-lucide-user-plus",class:"w-3 h-3"}),r.invite||0]))])])}},{accessorKey:"battery",header:"电量",meta:{class:{th:"w-[100px]",td:"w-[100px]"}},cell:({row:i})=>{const{battery:r,income_battery:n}=i.original;return a("div",{class:"flex flex-col text-xs"},[a("span",{class:"inline-flex items-center gap-1 text-yellow-500"},[a(y,{name:"i-lucide-zap",class:"w-3 h-3"}),r||0]),a("span",{class:"inline-flex items-center gap-1 text-green-500"},[a(y,{name:"i-lucide-trending-up",class:"w-3 h-3"}),n||0])])}},{accessorKey:"income_amount",header:"收益",meta:{class:{th:"w-[90px]",td:"w-[90px]"}},cell:({row:i})=>{const{income_amount:r,amount:n}=i.original;return a("div",{class:"text-xs"},[a("div",{class:"font-medium text-green-600"},`¥${r||0}`),a("div",{class:"text-(--ui-text-muted)"},`可提 ¥${n||0}`)])}},{accessorKey:"code",header:"邀请码",searchPlaceholder:"邀请码",meta:{class:{th:"w-[120px]",td:"w-[120px]"}},cell:({row:i})=>{const{code:r}=i.original;return a("code",{class:"text-xs font-mono bg-(--ui-bg-elevated) px-1.5 py-0.5 rounded"},r||"-")}},{accessorKey:"email",header:"邮箱",searchPlaceholder:"邮箱",meta:{class:{th:"w-[180px]",td:"w-[180px]"}},cell:({row:i})=>{const{email:r}=i.original;return a("span",{class:"text-xs"},r||"-")}},{accessorKey:"created_at",header:"创建时间",meta:{class:{th:"w-[160px]",td:"w-[160px]"}},cell:({row:i})=>{const r=i.original.created_at;return r?a("span",{class:"text-xs text-(--ui-text-muted)"},ve(r)):a("span",{class:"text-gray-400"},"-")}},{accessorKey:"remarks",header:"备注",meta:{class:{th:"w-[120px]",td:"w-[120px]"}},cell:({row:i})=>{const r=i.original.remarks;if(!r)return a("span",{class:"text-gray-400"},"-");const n=r.length>6?r.slice(0,6)+"...":r;return a(U,{text:r,ui:{content:"max-w-xs"}},()=>a("span",{class:"text-xs cursor-pointer text-(--ui-text-muted) hover:text-(--ui-text)"},n))}},{accessorKey:"summary",header:"简介",meta:{class:{th:"w-[120px]",td:"w-[120px]"}},cell:({row:i})=>{const r=i.original.summary;if(!r)return a("span",{class:"text-gray-400"},"-");const n=r.length>6?r.slice(0,6)+"...":r;return a(U,{text:r,ui:{content:"max-w-xs"}},()=>a("span",{class:"text-xs cursor-pointer text-(--ui-text-muted) hover:text-(--ui-text)"},n))}},{accessorKey:"state",header:"状态",meta:{class:{th:"w-[100px]",td:"w-[100px]"}},searchPlaceholder:"筛选状态",formItemProps:{component:"Select",componentProps:{options:[{label:"待审核",value:1},{label:"启用",value:2},{label:"已删除",value:4}]}},cell:({row:i})=>a(C,{class:"capitalize",variant:"subtle",color:O[i.original.state]?.[1]},()=>O[i.original.state]?.[0])}],Yt=T({name:"MemberList",__name:"list",setup(i){const r=Z(),n=E({isDialog:!1,isDialogBattery:!1,currentForm:{}}),v=async m=>{n.isDialog=!0,m?n.currentForm=M(m):n.currentForm={state:2}},g=async m=>{n.isDialogBattery=!0,n.currentForm=M(m)},F=async()=>{r.value.reload(),n.isDialog=!1,n.isDialogBattery=!1};function w(m){const b=ie();return[{label:"编辑",icon:"material-symbols:edit-square-outline",onSelect(){v(m.original)}},{label:"充值",icon:"material-symbols:battery-charging-full",onSelect(){g(m.original)}},{type:"separator"},{label:"查看收藏",icon:"material-symbols:visibility-outline",onSelect(){b.push(`/member/collect/${m.original.id}`)}},{type:"separator"},{label:"查看邀请",icon:"material-symbols:visibility-outline",onSelect(){b.push(`/member/invite/${m.original.id}`)}},{type:"separator"},{label:"查看流水",icon:"material-symbols:receipt-long-outline",onSelect(){b.push(`/member/wallet-log?uid=${m.original.id}`)}},{type:"separator"},{label:"查看聊天",icon:"material-symbols:chat-outline",onSelect(){b.push(`/member/chat/${m.original.id}`)}}]}const p=[...gt,{id:"actions",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},cell:({row:m})=>a("div",{class:"text-right"},a(ae,{content:{align:"end"},items:w(m)},()=>a(K,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost",class:"ml-auto"})))}];return(m,b)=>{const _=ne,t=de,$=st,k=xt;return D(),be(_e,null,[l(t,null,{default:d(()=>[l(_,{ref_key:"tableRef",ref:r,"data-request":o(xe),columns:p,"scroll-x":"min-w-[1200px]"},null,8,["data-request"])]),_:1}),l($,{dialog:o(n).isDialog,"onUpdate:dialog":b[0]||(b[0]=V=>o(n).isDialog=V),"current-form":o(n).currentForm,onRefresh:F},null,8,["dialog","current-form"]),l(k,{dialog:o(n).isDialogBattery,"onUpdate:dialog":b[1]||(b[1]=V=>o(n).isDialogBattery=V),"current-form":o(n).currentForm,onRefresh:F},null,8,["dialog","current-form"])],64)}}});export{Yt as default};
