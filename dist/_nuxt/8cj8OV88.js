import{_ as N}from"./oJBVUttf.js";import{_ as z}from"./BdKneTYw.js";import{d as f,_ as j,a as E}from"./DiI9-bkE.js";import{_ as Z}from"./DWJKBe83.js";import{_ as $}from"./DxT_AjaP.js";import{_ as I}from"./DkYr1hfb.js";import{_ as B}from"./CuFgEFCp.js";import{a as L}from"./F_2iFtsw.js";import{p as P,r as H,w as F,j as K,z as p,a1 as O,a2 as x,a7 as i,Q as t,u as a,A as c,W as b,ah as R,a6 as n,a5 as y,R as A,c as Q}from"./Cp_GvCOL.js";import"./BlLzDdHJ.js";import"./DVCf4JVd.js";import"./CM1DIlR0.js";import"./B3KMLFeu.js";import"./D7PB4JkZ.js";import"./DZaB2s8a.js";import"./C-fFc4Sm.js";import"./De6cJ90F.js";import"./DnWsfCtc.js";import"./DaMwIZ4f.js";import"./BnfZ4xmv.js";import"./CangPKqO.js";import"./C8Jf-TuN.js";const T={class:"flex flex-wrap items-end gap-4"},W={class:"flex items-center gap-2"},q={class:"overflow-x-auto"},G={class:"w-full text-sm"},J={key:0},X={colspan:"9",class:"px-3 py-8 text-center text-(--ui-text-muted)"},tt={key:1},et={key:2},st={class:"border-t border-(--ui-border) hover:bg-(--ui-bg-elevated)/30 transition-colors"},ot={class:"px-3 py-3"},at={class:"px-3 py-3"},nt={class:"font-mono text-(--ui-primary)"},it={class:"px-3 py-3 text-right"},lt={class:"px-3 py-3 text-right"},dt={class:"px-3 py-3 text-right"},rt={class:"px-3 py-3 text-right"},pt={class:"px-3 py-3 text-right"},ct={class:"px-3 py-3 text-right"},ut={class:"px-3 py-3 text-right"},_t={key:0},mt={colspan:"9",class:"p-0"},xt={class:"bg-(--ui-bg-muted)/50 px-4 py-3"},gt={class:"text-xs text-(--ui-text-muted) mb-3 font-medium flex items-center gap-2"},ft={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3"},ht={class:"text-sm font-medium text-(--ui-text-highlighted) mb-2"},bt={class:"grid grid-cols-2 gap-x-4 gap-y-1 text-xs"},yt={class:"flex justify-between"},vt={class:"flex justify-between"},Ct={class:"flex justify-between"},wt={class:"flex justify-between"},Rt={class:"flex justify-between"},Ut={class:"text-(--ui-primary)"},Yt={class:"flex justify-between"},St={class:"text-(--ui-success)"},Mt={class:"flex items-center justify-between gap-3 pt-4 mt-4"},Vt={class:"text-sm text-(--ui-text-muted)"},kt={class:"font-medium text-(--ui-text)"},Dt={class:"flex items-center gap-2"},ee=P({name:"InviteStatistics",__name:"invite-statistics",setup(Nt){const e=H({loading:!1,list:[],total:0,searchCode:"",dateRange:{start:f().subtract(6,"day").format("YYYY-MM-DD"),end:f().format("YYYY-MM-DD")},page:1,pageSize:10,expandedRows:new Set}),v=Q(()=>e.searchCode?e.list.filter(l=>l.invitation_code.toLowerCase().includes(e.searchCode.toLowerCase())):e.list);async function g(l=!0){e.loading=!0,e.expandedRows.clear(),l&&(e.page=1);const{data:s,error:d}=await L({start:e.dateRange.start,end:e.dateRange.end,page:e.page,pagesize:e.pageSize});!d&&s&&(e.list=s.list||[],e.total=s.count||0),e.loading=!1}function U(){e.dateRange.start=f().subtract(6,"day").format("YYYY-MM-DD"),e.dateRange.end=f().format("YYYY-MM-DD"),e.searchCode="",g()}function Y(l){e.page=l,g(!1)}function S(){e.page=1,g(!1)}function u(l){const s={};return l.days?.forEach(d=>{d.stats?.forEach(_=>{s[_.f]=(s[_.f]||0)+_.num})}),s}function M(l){e.expandedRows.has(l)?e.expandedRows.delete(l):e.expandedRows.add(l)}function m(l,s){return l.stats?.find(d=>d.f===s)?.num||0}return F(()=>e.searchCode,()=>{e.page=1}),K(()=>{g()}),(l,s)=>{const d=N,_=z,h=j,C=Z,w=E,V=$,k=I,D=B;return p(),O(D,null,{default:x(()=>[i(C,{ui:{body:"p-4"},class:"mb-6"},{default:x(()=>[t("div",T,[i(_,{label:"开始日期",class:"w-[150px]"},{default:x(()=>[i(d,{modelValue:a(e).dateRange.start,"onUpdate:modelValue":s[0]||(s[0]=o=>a(e).dateRange.start=o),type:"date"},null,8,["modelValue"])]),_:1}),i(_,{label:"结束日期",class:"w-[150px]"},{default:x(()=>[i(d,{modelValue:a(e).dateRange.end,"onUpdate:modelValue":s[1]||(s[1]=o=>a(e).dateRange.end=o),type:"date"},null,8,["modelValue"])]),_:1}),i(_,{label:"邀请码",class:"w-[160px]"},{default:x(()=>[i(d,{modelValue:a(e).searchCode,"onUpdate:modelValue":s[2]||(s[2]=o=>a(e).searchCode=o),placeholder:"搜索邀请码"},null,8,["modelValue"])]),_:1}),t("div",W,[i(h,{loading:a(e).loading,label:"查询",icon:"i-lucide-search",onOnClick:g},null,8,["loading"]),i(h,{disabled:a(e).loading,label:"重置",icon:"fluent:arrow-reset-24-filled",color:"neutral",variant:"outline",onClick:U},null,8,["disabled"])])])]),_:1}),i(C,{ui:{body:"p-0"}},{default:x(()=>[t("div",q,[t("table",G,[s[12]||(s[12]=t("thead",null,[t("tr",{class:"bg-(--ui-bg-elevated)/50 text-(--ui-text-muted)"},[t("th",{class:"w-12 px-3 py-3"}),t("th",{class:"px-3 py-3 text-left font-semibold"}," 邀请码 "),t("th",{class:"px-3 py-3 text-right font-semibold"}," 注册 "),t("th",{class:"px-3 py-3 text-right font-semibold"}," 活跃 "),t("th",{class:"px-3 py-3 text-right font-semibold"}," 游客 "),t("th",{class:"px-3 py-3 text-right font-semibold"}," 充值人数 "),t("th",{class:"px-3 py-3 text-right font-semibold"}," 充值金额 "),t("th",{class:"px-3 py-3 text-right font-semibold"}," 成功单 "),t("th",{class:"px-3 py-3 text-right font-semibold"}," 未付款 ")])],-1)),a(e).loading?(p(),c("tbody",J,[t("tr",null,[t("td",X,[i(w,{name:"i-lucide-loader-2",class:"size-5 animate-spin"})])])])):a(v).length===0?(p(),c("tbody",tt,[...s[4]||(s[4]=[t("tr",null,[t("td",{colspan:"9",class:"px-3 py-8 text-center text-(--ui-text-muted)"}," 暂无数据 ")],-1)])])):(p(),c("tbody",et,[(p(!0),c(b,null,R(a(v),o=>(p(),c(b,{key:o.invitation_code},[t("tr",st,[t("td",ot,[i(h,{color:"neutral",variant:"ghost",size:"xs",icon:a(e).expandedRows.has(o.invitation_code)?"i-lucide-chevron-down":"i-lucide-chevron-right",onClick:r=>M(o.invitation_code)},null,8,["icon","onClick"])]),t("td",at,[t("span",nt,n(o.invitation_code),1)]),t("td",it,n(u(o).ZC_NUM||0),1),t("td",lt,n(u(o).HY_NUM||0),1),t("td",dt,n(u(o).HY_YK_NUM||0),1),t("td",rt,n(u(o).CZ_NUM||0),1),t("td",pt,n(u(o).CZ_PRICE||0),1),t("td",ct,n(u(o).CZ_SUCCESS||0),1),t("td",ut,n(u(o).CZ_ERROR||0),1)]),a(e).expandedRows.has(o.invitation_code)?(p(),c("tr",_t,[t("td",mt,[t("div",xt,[t("div",gt,[i(w,{name:"i-lucide-calendar-days",class:"size-4"}),s[5]||(s[5]=y(" 按日期明细 ",-1))]),t("div",ft,[(p(!0),c(b,null,R(o.days,r=>(p(),c("div",{key:r.tm,class:"bg-(--ui-bg) rounded-lg p-3 border border-(--ui-border)"},[t("div",ht,n(r.tm),1),t("div",bt,[t("div",yt,[s[6]||(s[6]=t("span",{class:"text-(--ui-text-muted)"},"注册",-1)),t("span",null,n(m(r,"ZC_NUM")),1)]),t("div",vt,[s[7]||(s[7]=t("span",{class:"text-(--ui-text-muted)"},"活跃",-1)),t("span",null,n(m(r,"HY_NUM")),1)]),t("div",Ct,[s[8]||(s[8]=t("span",{class:"text-(--ui-text-muted)"},"游客",-1)),t("span",null,n(m(r,"HY_YK_NUM")),1)]),t("div",wt,[s[9]||(s[9]=t("span",{class:"text-(--ui-text-muted)"},"充值人数",-1)),t("span",null,n(m(r,"CZ_NUM")),1)]),t("div",Rt,[s[10]||(s[10]=t("span",{class:"text-(--ui-text-muted)"},"充值金额",-1)),t("span",Ut,n(m(r,"CZ_PRICE")),1)]),t("div",Yt,[s[11]||(s[11]=t("span",{class:"text-(--ui-text-muted)"},"成功单",-1)),t("span",St,n(m(r,"CZ_SUCCESS")),1)])])]))),128))])])])])):A("",!0)],64))),128))]))])])]),_:1}),t("div",Mt,[t("div",Vt,[s[13]||(s[13]=y(" 共 ",-1)),t("span",kt,n(a(e).total),1),s[14]||(s[14]=y(" 条数据 ",-1))]),t("div",Dt,[i(V,{"show-edges":"","sibling-count":1,page:a(e).page,"items-per-page":a(e).pageSize,total:a(e).total,"onUpdate:page":Y},null,8,["page","items-per-page","total"]),i(k,{modelValue:a(e).pageSize,"onUpdate:modelValue":[s[3]||(s[3]=o=>a(e).pageSize=o),S],items:[{value:10,label:"10 / 页"},{value:20,label:"20 / 页"},{value:50,label:"50 / 页"},{value:100,label:"100 / 页"}],class:"w-24"},null,8,["modelValue"])])])]),_:1})}}});export{ee as default};
