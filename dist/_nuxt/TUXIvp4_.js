import{_ as B}from"./1OJ4jHSB.js";import{w as S,_ as C,a as V}from"./DiI9-bkE.js";import{_ as q}from"./Odvr87Pg.js";import{_ as K}from"./CuFgEFCp.js";import{_ as j}from"./oJBVUttf.js";import{_ as L}from"./BdKneTYw.js";import{_ as M}from"./DkYr1hfb.js";import{_ as O}from"./9B_i7pfW.js";import{_ as N}from"./8gEztUrL.js";import{u as z,a as A,g as Q,r as W}from"./adOTzFDE.js";import{c as $}from"./B3KMLFeu.js";import{p as R,ai as G,w as H,z as k,a1 as J,a2 as m,a7 as n,u as o,Q as x,a6 as X,i as Y,c as Z,r as I,E as s,A as ee,W as te,h as oe}from"./Cp_GvCOL.js";import{_ as F}from"./Bml5z8l2.js";import{f as ae}from"./CE7u-7DH.js";import{u as se}from"./BCMcqMGM.js";import"./D7PB4JkZ.js";import"./C-fFc4Sm.js";import"./DnWsfCtc.js";import"./C6Y-ieo6.js";import"./De6cJ90F.js";import"./BrwH2_O0.js";import"./7ga_NNx6.js";import"./BHtpJmxp.js";import"./BlLzDdHJ.js";import"./CM1DIlR0.js";import"./K6pfE6CB.js";import"./B9BvCEkO.js";import"./DxT_AjaP.js";import"./DaMwIZ4f.js";import"./BnfZ4xmv.js";import"./CangPKqO.js";import"./C8Jf-TuN.js";import"./DVCf4JVd.js";import"./DZaB2s8a.js";const ne={class:"flex items-center gap-2"},le={class:"font-semibold"},re={class:"p-4 rounded-lg bg-(--ui-bg-elevated) border border-(--ui-border) space-y-4"},ie={class:"grid grid-cols-2 gap-4"},me=R({__name:"Edit",props:{dialog:{type:Boolean,default:!1},currentForm:{default:()=>({})}},emits:["update:dialog","refresh"],setup(l,{emit:t}){const p=l,c=t,r=Z({get:()=>p.dialog,set:i=>c("update:dialog",i)}),f=()=>{r.value=!1},_=G("formRef"),b=S(),y=[{label:"启用",value:2},{label:"已删除",value:4}],v=[{label:"系统",value:0},{label:"业务",value:1}],e=I({loading:!1,form:{}});async function u(){e.loading=!0;const i=$(e.form),{error:a}=await(i.id?z:A)(i);a||(b.add({title:"操作成功",color:"success"}),f(),c("refresh")),e.loading=!1}return H(()=>p.dialog,i=>{i&&(e.loading=!1,e.form=$(p.currentForm))}),(i,a)=>{const w=V,g=j,h=L,U=M,E=O,D=C,P=N;return k(),J(P,{open:o(r),"onUpdate:open":a[4]||(a[4]=d=>Y(r)?r.value=d:null),ui:{content:"sm:max-w-md",footer:"justify-end"}},{header:m(()=>[x("div",ne,[n(w,{name:"i-lucide-tag",class:"w-5 h-5 text-(--ui-primary)"}),x("span",le,X(l.currentForm.id?"编辑标签":"新增标签"),1)])]),body:m(()=>[n(E,{ref_key:"formRef",ref:_,state:o(e).form,class:"space-y-4",onSubmit:u},{default:m(()=>[x("div",re,[n(h,{label:"名称",name:"name",required:""},{default:m(()=>[n(g,{modelValue:o(e).form.name,"onUpdate:modelValue":a[0]||(a[0]=d=>o(e).form.name=d),modelModifiers:{trim:!0},placeholder:"请输入标签名称",class:"w-full"},null,8,["modelValue"])]),_:1}),x("div",ie,[n(h,{label:"类型",name:"ty",required:""},{default:m(()=>[n(U,{modelValue:o(e).form.ty,"onUpdate:modelValue":a[1]||(a[1]=d=>o(e).form.ty=d),items:v,placeholder:"请选择",class:"w-full"},null,8,["modelValue"])]),_:1}),n(h,{label:"状态",name:"state",required:""},{default:m(()=>[n(U,{modelValue:o(e).form.state,"onUpdate:modelValue":a[2]||(a[2]=d=>o(e).form.state=d),items:y,placeholder:"请选择",class:"w-full"},null,8,["modelValue"])]),_:1})])])]),_:1},8,["state"])]),footer:m(()=>[n(D,{label:"取消",color:"neutral",variant:"outline",onClick:f}),n(D,{loading:o(e).loading,label:"确认",onClick:a[3]||(a[3]=d=>o(_)?.submit())},null,8,["loading"])]),_:1},8,["open"])}}}),ce=Object.assign(me,{__name:"CommonTagEdit"}),ue={2:["启用","success"],4:["已删除","error"]},T={0:["系统","info","i-lucide-settings"],1:["业务","success","i-lucide-tag"]},de=[{accessorKey:"id",header:"ID",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},cell:({row:l})=>s("span",{class:"font-mono text-sm text-(--ui-text-muted)"},l.original.id)},{accessorKey:"name",header:"名称",searchPlaceholder:"标签名称",meta:{class:{th:"w-[200px]",td:"w-[200px]"}},cell:({row:l})=>{const{name:t,ty:p}=l.original,c=T[p]||["未知","neutral","i-lucide-tag"];return s("div",{class:"flex items-center gap-2"},[s("div",{class:`w-7 h-7 rounded-lg flex items-center justify-center bg-${c[1]}-500/10`},[s(V,{name:c[2],class:`w-4 h-4 text-${c[1]}-500`})]),s("span",{class:"font-medium"},t||"-")])}},{accessorKey:"ty",header:"类型",searchPlaceholder:"筛选类型",meta:{class:{th:"w-[100px]",td:"w-[100px]"}},formItemProps:{component:"Select",componentProps:{options:[{label:"系统",value:0},{label:"业务",value:1}]}},cell:({row:l})=>{const t=T[l.original.ty];return t?s(F,{variant:"subtle",color:t[1]},()=>t[0]):s("span",{class:"text-(--ui-text-muted)"},"-")}},{accessorKey:"state",header:"状态",searchPlaceholder:"筛选状态",meta:{class:{th:"w-[100px]",td:"w-[100px]"}},formItemProps:{component:"Select",componentProps:{options:[{label:"启用",value:2},{label:"已删除",value:4}]}},cell:({row:l})=>{const t=ue[l.original.state];return t?s(F,{variant:"subtle",color:t[1]},()=>t[0]):s("span",{class:"text-(--ui-text-muted)"},"-")}},{accessorKey:"created_at",header:"创建时间",meta:{class:{th:"w-[160px]",td:"w-[160px]"}},cell:({row:l})=>{const t=l.original.created_at;return t?s("span",{class:"text-xs text-(--ui-text-muted)"},ae(t)):s("span",{class:"text-(--ui-text-muted)"},"-")}}],We=R({name:"TagList",__name:"tag",setup(l){const t=oe(),p=C,c=se(),r=I({isDialog:!1,currentForm:{}}),f=async e=>{r.isDialog=!0,e?r.currentForm=$(e):r.currentForm={state:2}},_=async()=>{t.value.reload(),r.isDialog=!1},b=async e=>{const{error:u}=await W({id:e.id});u||t.value.reload()};function y(e){return[{label:"编辑",icon:"material-symbols:edit-square-outline",onSelect(){f(e.original)}},{type:"separator"},{label:"删除",icon:"material-symbols:contract-delete-outline-rounded",color:"error",onSelect(){c.open({color:"error",title:"删除数据",description:"您确定要删除吗？",onPositiveClick(){b(e.original)}})}}]}const v=[...de,{id:"actions",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},cell:({row:e})=>s("div",{class:"text-right"},s(B,{content:{align:"end"},items:y(e)},()=>s(C,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost",class:"ml-auto"})))}];return(e,u)=>{const i=q,a=K,w=ce;return k(),ee(te,null,[n(a,null,{actions:m(()=>[n(o(p),{label:"新增",icon:"i-lucide-plus",color:"neutral",onClick:u[0]||(u[0]=g=>f(null))})]),default:m(()=>[n(i,{ref_key:"tableRef",ref:t,"data-request":o(Q),columns:v,"scroll-x":"min-w-[400px]"},null,8,["data-request"])]),_:1}),n(w,{dialog:o(r).isDialog,"onUpdate:dialog":u[1]||(u[1]=g=>o(r).isDialog=g),"current-form":o(r).currentForm,onRefresh:_},null,8,["dialog","current-form"])],64)}}});export{We as default};
