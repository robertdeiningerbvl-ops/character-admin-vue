import{_ as ie}from"./CEcF5dWm.js";import{f as ee,c as de,ap as me,j as oe,aE as ce,l as ue,a as pe,o as f,w as i,D as l,B as o,E as R,I as ge,F as z,b as d,_ as F,k as b,C as E,G as A,H as M,a4 as fe,aF as k,i as be,A as _e}from"./DhOLkSnF.js";import{_ as xe,a as ye,b as he,c as ke}from"./DAqc9GYg.js";import{_ as ve}from"./CSbqei5V.js";import{_ as we}from"./DAIKkUkW.js";import{_ as Ve}from"./DAeRr84W.js";import{_ as Ue}from"./D0vBe5Vh.js";import{_ as $e}from"./DEtjlJ-S.js";import{_ as ze}from"./CVanS2c1.js";import{_ as Ce}from"./Kwaskf5N.js";import{_ as Oe}from"./Db__RPjw.js";import{_ as Pe}from"./BZLiX_8y.js";import{h as Se,i as De,j as Re,k as Ee}from"./CxuEfYss.js";import{c as L}from"./45RcOEEf.js";import{o as Ae,n as Q,s as Fe}from"./B-mCBPct.js";import{u as Ne,b as je}from"./Bo5OMT4U.js";import{_ as W}from"./-rcGzxkB.js";import{_ as Be}from"./CLU2_0cD.js";import{f as X}from"./BmKy9gZZ.js";import{u as Te}from"./BVQSm7Ip.js";import"./CZg69nbc.js";import"./CwtpYSSp.js";import"./DPsBupTg.js";import"./9Rxep3Q5.js";import"./CLKxJTZi.js";import"./HRiyi1uV.js";import"./BrXYpapi.js";import"./BXSyqGa5.js";import"./CemQtCgh.js";import"./CseYhDvv.js";const qe={class:"max-h-[75vh] overflow-y-auto p-6"},Ie={class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 space-y-5"},Ke={class:"flex items-center gap-2 pb-3 border-b border-gray-200 dark:border-gray-700"},Me={class:"grid grid-cols-2 gap-4"},Le={key:0,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 space-y-5"},Je={class:"flex items-center justify-between pb-3 border-b border-gray-200 dark:border-gray-700"},Ge={class:"flex items-center gap-2"},He={class:"flex items-center gap-3"},Qe={class:"text-sm text-gray-600 dark:text-gray-400"},We={key:0,class:"space-y-4"},Xe={class:"flex items-center justify-between mb-4"},Ye={class:"flex items-center gap-2"},Ze={class:"w-7 h-7 rounded-full bg-orange-100 dark:bg-orange-900/30 flex items-center justify-center"},eo={class:"font-semibold text-orange-600 dark:text-orange-400 text-sm"},oo={class:"font-medium text-gray-900 dark:text-white"},ao={class:"space-y-5"},to={class:"grid grid-cols-2 gap-4"},lo={class:"flex items-center gap-3 p-3 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700"},so={class:"flex items-center gap-3 p-3 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700"},ro={class:"flex items-center gap-3 p-3 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700"},no={class:"flex items-center gap-3 p-3 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700"},io={class:"grid grid-cols-2 gap-4"},mo={class:"flex items-center gap-3 p-3 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700"},co={class:"flex items-center gap-3 p-3 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700"},uo={class:"flex items-center gap-3 p-3 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700"},po={class:"flex items-center gap-3 p-3 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700"},go={key:1,class:"bg-white dark:bg-gray-800 rounded-xl border border-gray-200 dark:border-gray-700 p-6 space-y-5"},fo={class:"flex items-center gap-2 pb-3 border-b border-gray-200 dark:border-gray-700"},bo={class:"space-y-4"},_o={class:"flex items-center justify-between mb-4"},xo={class:"flex items-center gap-2"},yo={class:"w-7 h-7 rounded-full bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center"},ho={class:"font-semibold text-purple-600 dark:text-purple-400 text-sm"},ko={class:"font-medium text-gray-900 dark:text-white"},vo={class:"space-y-5"},wo={class:"space-y-2"},Vo={class:"grid grid-cols-3 gap-4"},Uo={class:"grid grid-cols-2 gap-4"},$o={class:"grid grid-cols-2 gap-4"},zo={class:"flex items-center gap-3 p-3 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700"},Co={class:"flex items-center gap-3 p-3 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700"},Oo={class:"flex items-center gap-3 p-3 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700"},Po={class:"flex items-center gap-3 p-3 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700"},So={class:"flex items-center justify-between w-full"},Do={class:"text-sm text-gray-500 dark:text-gray-400"},Ro={class:"flex gap-3"},Eo=ee({__name:"Edit",props:{dialog:{type:Boolean,default:!1},currentForm:{default:()=>({})}},emits:["update:dialog","refresh"],setup(u,{emit:J}){const v=u,V=J,w=de({get(){return v.dialog},set(s){V("update:dialog",s)}}),P=()=>{w.value=!1},_=me("formRef"),C=Ae({name:Fe().nonempty("名称不能为空"),state:Q().min(0),ty:Q().min(0)}),N=[{label:"删除",value:9},{label:"待审核",value:2},{label:"正常",value:1}],j=[{label:"正则规则",value:1},{label:"世界观",value:2}],B=[{label:"角色定义前",value:"0-0"},{label:"角色定义后",value:"1-0"},{label:"角色定义后-1",value:"2-0"},{label:"角色定义后-2",value:"3-0"},{label:"智能插入",value:"4-0"},{label:"智能插入-User",value:"4-1"},{label:"智能插入-AI",value:"4-2"},{label:"智能插入-System",value:"4-3"}],n=oe({loading:!1,form:{name:"",ty:1,state:1,regex_enabled:!1,regex:[],character_book:{name:"",entries:[]}}}),p=ce(),x=()=>{n.form.regex||(n.form.regex=[]),n.form.regex.push({id:"",scriptName:"",findRegex:"",replaceString:"",trimStrings:[],placement:[],disabled:!1,markdownOnly:!1,promptOnly:!1,runOnEdit:!1,substituteRegex:0,minDepth:null,maxDepth:null})},S=s=>{n.form.regex?.splice(s,1)},U=(s,e)=>{s.placement||(s.placement=[]);const m=s.placement.indexOf(e);m>-1?s.placement.splice(m,1):s.placement.push(e)},$=(s,e)=>s.placement&&s.placement.includes(e),T=s=>{if(!s.extensions)return"0-0";const e=s.extensions.position||0,m=s.extensions.role||0;return`${e}-${m}`},q=(s,e)=>{if(s.extensions||(s.extensions={}),e){const[m,t]=e.split("-").map(Number);s.extensions.position=m,s.extensions.role=t}},I=()=>{n.form.character_book||(n.form.character_book={name:"",entries:[]}),n.form.character_book.entries||(n.form.character_book.entries=[]),n.form.character_book.entries.push({id:0,keys:[],secondary_keys:[],comment:"",content:"",constant:!1,selective:!1,insertion_order:0,priority:0,enabled:!0,position:"",use_regex:!1,extensions:{position:0,exclude_recursion:!1,display_index:0,probability:100,useProbability:!1,depth:4,selectiveLogic:0,group:"",group_override:!1,group_weight:0,prevent_recursion:!1,scan_depth:null,match_whole_words:null,use_group_scoring:!1,case_sensitive:null,automation_id:"",role:0,vectorized:!1,sticky:0,cooldown:0,delay:0}})},O=s=>{n.form.character_book?.entries?.splice(s,1)},ae=s=>{s.keys||(s.keys=[]),s.keys.push("")},te=(s,e)=>{s.keys?.splice(e,1)};async function le(){n.loading=!0;const s=L(n.form);s.ty===1?s.content=JSON.stringify(s.regex||[]):s.ty===2&&(s.content=JSON.stringify(s.character_book||{name:"",entries:[]})),delete s.regex_enabled,delete s.regex,delete s.character_book;const{error:e}=await(s.id?Se:De)(s);e||(p.add({title:"操作成功",color:"success"}),V("refresh"),P()),n.loading=!1}return ue(()=>v.dialog,s=>{if(s)if(v.currentForm?.id){const e=L(v.currentForm);if(console.log("编辑模式 - 原始数据:",e),e.regex_enabled=!1,e.regex=[],e.character_book={name:"",entries:[]},e.content)try{const m=typeof e.content=="string"?JSON.parse(e.content):e.content;console.log("解析后的 content 数据:",m),console.log("参数类型 ty:",e.ty),e.ty===1?Array.isArray(m)&&(console.log("解析正则规则数组"),e.regex_enabled=!0,e.regex=m.map(t=>({id:t.id||"",scriptName:t.scriptName||"",findRegex:t.findRegex||"",replaceString:t.replaceString||"",trimStrings:t.trimStrings||[],placement:t.placement||[],disabled:t.disabled||!1,markdownOnly:t.markdownOnly||!1,promptOnly:t.promptOnly||!1,runOnEdit:t.runOnEdit||!1,substituteRegex:t.substituteRegex||0,minDepth:t.minDepth||null,maxDepth:t.maxDepth||null}))):e.ty===2&&(console.log("解析世界书对象"),e.character_book={name:m.name||"",entries:[]},m.entries&&Array.isArray(m.entries)&&(e.character_book.entries=m.entries.map(t=>({id:t.id||0,keys:t.keys||[],secondary_keys:t.secondary_keys||[],comment:t.comment||"",content:t.content||"",constant:t.constant||!1,selective:t.selective||!1,insertion_order:t.insertion_order||0,priority:t.priority||0,enabled:t.enabled!==void 0?t.enabled:!0,position:t.position||"",use_regex:t.use_regex||!1,extensions:t.extensions?{position:t.extensions.position||0,exclude_recursion:t.extensions.exclude_recursion||!1,display_index:t.extensions.display_index||0,probability:t.extensions.probability||100,useProbability:t.extensions.useProbability||!1,depth:t.extensions.depth||4,selectiveLogic:t.extensions.selectiveLogic||0,group:t.extensions.group||"",group_override:t.extensions.group_override||!1,group_weight:t.extensions.group_weight||0,prevent_recursion:t.extensions.prevent_recursion||!1,scan_depth:t.extensions.scan_depth||null,match_whole_words:t.extensions.match_whole_words||null,use_group_scoring:t.extensions.use_group_scoring||!1,case_sensitive:t.extensions.case_sensitive||null,automation_id:t.extensions.automation_id||"",role:t.extensions.role||0,vectorized:t.extensions.vectorized||!1,sticky:t.extensions.sticky||0,cooldown:t.extensions.cooldown||0,delay:t.extensions.delay||0}:{position:0,exclude_recursion:!1,display_index:0,probability:100,useProbability:!1,depth:4,selectiveLogic:0,group:"",group_override:!1,group_weight:0,prevent_recursion:!1,scan_depth:null,match_whole_words:null,use_group_scoring:!1,case_sensitive:null,automation_id:"",role:0,vectorized:!1,sticky:0,cooldown:0,delay:0}})))),console.log("展开后的表单数据:",{regex_enabled:e.regex_enabled,regex:e.regex,character_book:e.character_book})}catch(m){console.error("解析 content 失败:",m,"原始 content:",e.content),p.add({title:"解析参数数据失败",color:"error"})}else console.warn("content 字段为空");n.form=e,console.log("最终表单状态:",n.form)}else console.log("新增模式"),n.form={name:"",ty:1,state:1,regex_enabled:!1,regex:[],character_book:{name:"",entries:[]}}}),(s,e)=>{const m=ge,t=we,c=Ve,K=Ue,se=$e,h=F,G=ze,g=Ce,re=Oe,ne=Pe;return f(),pe(ne,{open:d(w),"onUpdate:open":e[6]||(e[6]=a=>fe(w)?w.value=a:null),title:d(n).form.id?"编辑参数":"新增参数",description:d(n).form.id?"编辑参数配置":"新增参数配置",dismissible:!1,ui:{content:"sm:max-w-6xl",body:"p-0",footer:"justify-end bg-gray-50 dark:bg-gray-900"}},{body:i(()=>[l("div",qe,[o(re,{ref_key:"formRef",ref:_,schema:d(C),state:d(n).form,class:"flex flex-col gap-5",onSubmit:le},{default:i(()=>[l("div",Ie,[l("div",Ke,[o(m,{name:"i-material-symbols-info-outline",class:"w-5 h-5 text-primary-600"}),e[7]||(e[7]=l("h4",{class:"font-semibold text-gray-900 dark:text-white"}," 基本信息 ",-1))]),o(c,{label:"参数名称",name:"name",required:"",class:"w-full"},{default:i(()=>[o(t,{modelValue:d(n).form.name,"onUpdate:modelValue":e[0]||(e[0]=a=>d(n).form.name=a),modelModifiers:{trim:!0},placeholder:"请输入参数名称",size:"lg",class:"w-full"},null,8,["modelValue"])]),_:1}),l("div",Me,[o(c,{label:"参数类型",name:"ty",required:"",class:"w-full"},{default:i(()=>[o(K,{modelValue:d(n).form.ty,"onUpdate:modelValue":e[1]||(e[1]=a=>d(n).form.ty=a),items:j,placeholder:"请选择类型",size:"lg",class:"w-full"},null,8,["modelValue"])]),_:1}),o(c,{label:"参数状态",name:"state",required:"",class:"w-full"},{default:i(()=>[o(K,{modelValue:d(n).form.state,"onUpdate:modelValue":e[2]||(e[2]=a=>d(n).form.state=a),items:N,placeholder:"请选择状态",size:"lg",class:"w-full"},null,8,["modelValue"])]),_:1})])]),d(n).form.ty===1?(f(),b("div",Le,[l("div",Je,[l("div",Ge,[o(m,{name:"i-material-symbols-regular-expression",class:"w-5 h-5 text-orange-600"}),e[8]||(e[8]=l("h4",{class:"font-semibold text-gray-900 dark:text-white"}," 正则表达式配置 ",-1))]),l("div",He,[l("span",Qe,z(d(n).form.regex_enabled?"已启用":"已禁用"),1),o(se,{modelValue:d(n).form.regex_enabled,"onUpdate:modelValue":e[3]||(e[3]=a=>d(n).form.regex_enabled=a)},null,8,["modelValue"])])]),d(n).form.regex_enabled?(f(),b("div",We,[(f(!0),b(A,null,M(d(n).form.regex,(a,y)=>(f(),b("div",{key:y,class:"bg-gray-50 dark:bg-gray-900/50 rounded-lg border border-gray-200 dark:border-gray-700 p-5"},[l("div",Xe,[l("div",Ye,[l("div",Ze,[l("span",eo,z(y+1),1)]),l("span",oo,"规则 "+z(y+1),1)]),o(h,{icon:"i-material-symbols-delete-outline",size:"sm",variant:"ghost",color:"error",onClick:r=>S(y)},null,8,["onClick"])]),l("div",ao,[o(c,{label:"脚本名称",class:"w-full"},{default:i(()=>[o(t,{modelValue:a.scriptName,"onUpdate:modelValue":r=>a.scriptName=r,placeholder:"可选",size:"lg",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(c,{label:"查找正则",required:"",class:"w-full"},{default:i(()=>[o(t,{modelValue:a.findRegex,"onUpdate:modelValue":r=>a.findRegex=r,placeholder:"例如：^hello|你好",class:"font-mono w-full",size:"lg"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(c,{label:"替换内容",required:"",class:"w-full"},{default:i(()=>[o(G,{modelValue:a.replaceString,"onUpdate:modelValue":r=>a.replaceString=r,placeholder:"匹配成功后的替换内容...",rows:3,size:"lg",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(c,{label:"生效位置",class:"w-full",description:"留空表示所有位置生效"},{default:i(()=>[l("div",to,[l("div",lo,[o(g,{"model-value":$(a,1),"onUpdate:modelValue":r=>U(a,1)},null,8,["model-value","onUpdate:modelValue"]),e[9]||(e[9]=l("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"用户输入",-1))]),l("div",so,[o(g,{"model-value":$(a,2),"onUpdate:modelValue":r=>U(a,2)},null,8,["model-value","onUpdate:modelValue"]),e[10]||(e[10]=l("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"AI输出",-1))]),l("div",ro,[o(g,{"model-value":$(a,3),"onUpdate:modelValue":r=>U(a,3)},null,8,["model-value","onUpdate:modelValue"]),e[11]||(e[11]=l("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"快捷命令",-1))]),l("div",no,[o(g,{"model-value":$(a,4),"onUpdate:modelValue":r=>U(a,4)},null,8,["model-value","onUpdate:modelValue"]),e[12]||(e[12]=l("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"世界信息",-1))])])]),_:2},1024),o(c,{label:"其他选项",class:"w-full"},{default:i(()=>[l("div",io,[l("div",mo,[o(g,{modelValue:a.disabled,"onUpdate:modelValue":r=>a.disabled=r},null,8,["modelValue","onUpdate:modelValue"]),e[13]||(e[13]=l("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"禁用规则",-1))]),l("div",co,[o(g,{modelValue:a.markdownOnly,"onUpdate:modelValue":r=>a.markdownOnly=r},null,8,["modelValue","onUpdate:modelValue"]),e[14]||(e[14]=l("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"仅Markdown",-1))]),l("div",uo,[o(g,{modelValue:a.promptOnly,"onUpdate:modelValue":r=>a.promptOnly=r},null,8,["modelValue","onUpdate:modelValue"]),e[15]||(e[15]=l("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"仅Prompt",-1))]),l("div",po,[o(g,{modelValue:a.runOnEdit,"onUpdate:modelValue":r=>a.runOnEdit=r},null,8,["modelValue","onUpdate:modelValue"]),e[16]||(e[16]=l("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"编辑时运行",-1))])])]),_:2},1024)])]))),128)),o(h,{variant:"outline",color:"primary",size:"lg",block:"",onClick:x},{leading:i(()=>[o(m,{name:"i-material-symbols-add-circle-outline"})]),default:i(()=>[e[17]||(e[17]=R(" 新增正则规则 ",-1))]),_:1})])):E("",!0)])):E("",!0),d(n).form.ty===2?(f(),b("div",go,[l("div",fo,[o(m,{name:"i-material-symbols-public",class:"w-5 h-5 text-purple-600"}),e[18]||(e[18]=l("h4",{class:"font-semibold text-gray-900 dark:text-white"}," 世界书设定 ",-1))]),o(c,{label:"世界书名称"},{default:i(()=>[o(t,{modelValue:d(n).form.character_book.name,"onUpdate:modelValue":e[4]||(e[4]=a=>d(n).form.character_book.name=a),placeholder:"例如：中世纪魔法世界",size:"lg"},null,8,["modelValue"])]),_:1}),l("div",bo,[(f(!0),b(A,null,M(d(n).form.character_book.entries,(a,y)=>(f(),b("div",{key:y,class:"bg-gray-50 dark:bg-gray-900/50 rounded-lg border border-gray-200 dark:border-gray-700 p-5"},[l("div",_o,[l("div",xo,[l("div",yo,[l("span",ho,z(y+1),1)]),l("span",ko,"条目 "+z(y+1),1)]),o(h,{icon:"i-material-symbols-delete-outline",size:"sm",variant:"ghost",color:"error",onClick:r=>O(y)},null,8,["onClick"])]),l("div",vo,[o(c,{label:"备注",class:"w-full"},{default:i(()=>[o(t,{modelValue:a.comment,"onUpdate:modelValue":r=>a.comment=r,placeholder:"备注说明",size:"lg",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(c,{label:"触发关键词",required:"",class:"w-full"},{default:i(()=>[l("div",wo,[(f(!0),b(A,null,M(a.keys||[],(r,D)=>(f(),b("div",{key:D,class:"flex gap-2"},[o(t,{modelValue:a.keys[D],"onUpdate:modelValue":H=>a.keys[D]=H,placeholder:"输入关键词",size:"lg",class:"flex-1"},null,8,["modelValue","onUpdate:modelValue"]),o(h,{icon:"i-material-symbols-close",size:"lg",variant:"ghost",color:"error",onClick:H=>te(a,D)},null,8,["onClick"])]))),128)),o(h,{variant:"soft",size:"sm",onClick:r=>ae(a)},{leading:i(()=>[o(m,{name:"i-material-symbols-add"})]),default:i(()=>[e[19]||(e[19]=R(" 添加关键词 ",-1))]),_:1},8,["onClick"])])]),_:2},1024),o(c,{label:"内容",required:"",class:"w-full"},{default:i(()=>[o(G,{modelValue:a.content,"onUpdate:modelValue":r=>a.content=r,placeholder:"输入世界书内容...",rows:4,size:"lg",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),l("div",Vo,[o(c,{label:"优先级",class:"w-full"},{default:i(()=>[o(t,{modelValue:a.insertion_order,"onUpdate:modelValue":r=>a.insertion_order=r,modelModifiers:{number:!0},type:"number",placeholder:"0",size:"lg",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(c,{label:"触发概率 (0%-100%)",class:"w-full"},{default:i(()=>[o(t,{modelValue:a.extensions.probability,"onUpdate:modelValue":r=>a.extensions.probability=r,modelModifiers:{number:!0},type:"number",min:"0",max:"100",placeholder:"100",size:"lg",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(c,{label:"记录深度",class:"w-full"},{default:i(()=>[o(t,{modelValue:a.extensions.depth,"onUpdate:modelValue":r=>a.extensions.depth=r,modelModifiers:{number:!0},type:"number",placeholder:"4",size:"lg",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),l("div",Uo,[o(c,{label:"深度扫描",class:"w-full"},{default:i(()=>[o(t,{modelValue:a.extensions.scan_depth,"onUpdate:modelValue":r=>a.extensions.scan_depth=r,modelModifiers:{number:!0},type:"number",placeholder:"留空使用默认值",size:"lg",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),o(c,{label:"插入位置",class:"w-full"},{default:i(()=>[o(K,{"model-value":T(a),items:B,placeholder:"请选择插入位置",size:"lg",class:"w-full","onUpdate:modelValue":r=>q(a,r)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024)]),l("div",$o,[l("div",zo,[o(g,{modelValue:a.enabled,"onUpdate:modelValue":r=>a.enabled=r},null,8,["modelValue","onUpdate:modelValue"]),e[20]||(e[20]=l("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"启用条目",-1))]),l("div",Co,[o(g,{modelValue:a.constant,"onUpdate:modelValue":r=>a.constant=r},null,8,["modelValue","onUpdate:modelValue"]),e[21]||(e[21]=l("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"常驻内存",-1))]),l("div",Oo,[o(g,{modelValue:a.selective,"onUpdate:modelValue":r=>a.selective=r},null,8,["modelValue","onUpdate:modelValue"]),e[22]||(e[22]=l("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"选择性注入",-1))]),l("div",Po,[o(g,{modelValue:a.use_regex,"onUpdate:modelValue":r=>a.use_regex=r},null,8,["modelValue","onUpdate:modelValue"]),e[23]||(e[23]=l("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"},"使用正则",-1))])])])]))),128)),o(h,{variant:"outline",color:"primary",size:"lg",block:"",onClick:I},{leading:i(()=>[o(m,{name:"i-material-symbols-add-circle-outline"})]),default:i(()=>[e[24]||(e[24]=R(" 新增世界书条目 ",-1))]),_:1})])])):E("",!0)]),_:1},8,["schema","state"])])]),footer:i(()=>[l("div",So,[l("div",Do,[o(m,{name:"i-material-symbols-info-outline",class:"inline w-4 h-4"}),R(" "+z(d(n).form.id?"修改后将更新参数配置":"确认后将创建新参数"),1)]),l("div",Ro,[o(h,{label:"取消",color:"neutral",variant:"outline",size:"lg",onClick:P},{leading:i(()=>[o(m,{name:"i-material-symbols-close"})]),_:1}),o(h,{loading:d(n).loading,label:"确认保存",variant:"solid",size:"lg",onClick:e[5]||(e[5]=a=>d(_)?.submit())},{leading:i(()=>[o(m,{name:"i-material-symbols-check"})]),_:1},8,["loading"])])])]),_:1},8,["open","title","description"])}}}),Ao=Object.assign(Eo,{__name:"AmusementParameterEdit"}),Y={4:["删除","error"],2:["待审核","warning"],1:["正常","success"]},Z={1:["正则","info"],2:["世界观","warning"]},Fo=[{accessorKey:"id",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},header:()=>k(F,{color:"neutral",variant:"ghost",label:"ID",class:"-mx-2.5 hover:bg-transparent focus:bg-transparent data-[state=open]:bg-transparent"})},{accessorKey:"name",searchPlaceholder:"名称标题",header:"名称"},{accessorKey:"content",header:"内容",meta:{class:{th:"w-[150px]",td:"w-[150px]"}},cell:({row:u})=>k(Be,{text:u.original.content,ui:{content:"max-w-[150px] h-auto",text:"whitespace-pre-wrap break-all select-text"}},()=>k("div",{class:"truncate"},u.original.content))},{accessorKey:"updated_at",header:"更新时间",cell:({row:u})=>X(u.original.updated_at)},{accessorKey:"created_at",header:"创建时间",cell:({row:u})=>X(u.original.updated_at)},{accessorKey:"ty",header:"类型",formItemProps:{component:"Select",componentProps:{options:[{label:"正则",value:1},{label:"世界观",value:2}]}},cell:({row:u})=>k(W,{class:"capitalize",variant:"subtle",color:Z[u.original.ty]?.[1]},()=>Z[u.original.ty]?.[0])},{accessorKey:"state",meta:{class:{th:"w-[100px]",td:"w-[80px]"}},header:"状态",formItemProps:{component:"Select",componentProps:{options:[{label:"删除",value:4},{label:"待审核",value:2},{label:"正常",value:1}]}},cell:({row:u})=>k(W,{class:"capitalize",variant:"subtle",color:Y[u.original.state]?.[1]},()=>Y[u.original.state]?.[0])}],No={key:0,class:"absolute top-0 left-0 right-0 h-(--ui-header-height) flex items-center justify-between border-b border-(--ui-border) px-4 sm:px-6 bg-(--ui-bg)"},jo={class:"flex items-center gap-4"},fa=ee({name:"AmusementParameterList",__name:"parameter",setup(u){const v=Ne(je).smaller("lg"),V=be(),w=F,P=Te(),_=oe({isDialog:!1,currentForm:{}}),C=async p=>{_.isDialog=!0,p?_.currentForm=L(p):_.currentForm={state:2}},N=async()=>{V.value.reload(),_.isDialog=!1},j=async p=>{const{error:x}=await Ee({id:p.id});x||V.value.reload()};function B(p){return[{label:"编辑",icon:"material-symbols:edit-square-outline",onSelect(){C(p.original)}},{type:"separator"},{label:"删除",icon:"material-symbols:contract-delete-outline-rounded",color:"error",onSelect(){P.open({color:"error",title:"删除数据",description:"您确定要删除吗？",onPositiveClick(){j(p.original)}})}}]}const n=[...Fo,{id:"actions",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},cell:({row:p})=>k("div",{class:"text-right"},k(ie,{content:{align:"end"},items:B(p)},()=>k(F,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost",class:"ml-auto"})))}];return(p,x)=>{const S=ye,U=xe,$=he,T=ve,q=ke,I=Ao;return f(),b(A,null,[o(q,{ui:{body:"pb-[12px]! gap-0!"}},_e({body:i(()=>[d(v)?E("",!0):(f(),b("div",No,[l("div",jo,[o(S),o($)]),o(d(w),{label:"新增",icon:"i-lucide-plus",onClick:x[1]||(x[1]=O=>C(null))})])),o(T,{ref_key:"tableRef",ref:V,"data-request":d(Re),columns:n,"scroll-x":"min-w-[1000px]"},null,8,["data-request"])]),_:2},[d(v)?{name:"header",fn:i(()=>[o(U,{title:"游戏参数列表"},{leading:i(()=>[o(S)]),right:i(()=>[o(d(w),{label:"新增",icon:"i-lucide-plus",onClick:x[0]||(x[0]=O=>C(null))})]),_:1})]),key:"0"}:void 0]),1024),o(I,{dialog:d(_).isDialog,"onUpdate:dialog":x[2]||(x[2]=O=>d(_).isDialog=O),"current-form":d(_).currentForm,onRefresh:N},null,8,["dialog","current-form"])],64)}}});export{fa as default};
