import{_ as h}from"./1OJ4jHSB.js";import{n as _,_ as d}from"./DiI9-bkE.js";import{_ as v}from"./Odvr87Pg.js";import{_ as x}from"./CuFgEFCp.js";import{_ as b}from"./Bml5z8l2.js";import{_ as y}from"./Baq49nZQ.js";import{p as w,q as C,t as I}from"./DXr9T7Lu.js";import{h as m,E as t,p as k,z,a1 as R,a2 as D,a7 as K,c as L}from"./Cp_GvCOL.js";import{f as $}from"./CE7u-7DH.js";import{u as P}from"./BCMcqMGM.js";import"./D7PB4JkZ.js";import"./C-fFc4Sm.js";import"./DnWsfCtc.js";import"./C6Y-ieo6.js";import"./De6cJ90F.js";import"./BrwH2_O0.js";import"./7ga_NNx6.js";import"./BHtpJmxp.js";import"./BlLzDdHJ.js";import"./CM1DIlR0.js";import"./B3KMLFeu.js";import"./oJBVUttf.js";import"./DkYr1hfb.js";import"./DZaB2s8a.js";import"./K6pfE6CB.js";import"./B9BvCEkO.js";import"./DxT_AjaP.js";import"./DaMwIZ4f.js";import"./BnfZ4xmv.js";import"./CangPKqO.js";import"./C8Jf-TuN.js";import"./8gEztUrL.js";function S(){const e=m(new Set),o=m(new Set),a=m({}),n=_();return{expandedIds:e,loadingIds:o,replyMap:a,toggle:async i=>{const s=i.id;if(e.value.has(s)){e.value.delete(s);return}if(e.value.add(s),a.value[s])return;const p=n.params.id;o.value.add(s);try{const l=await w({comment_id:s,biz_id:p});console.log("res",l),a.value[s]=l.data.list}finally{o.value.delete(s)}}}}const{expandedIds:M,loadingIds:T,replyMap:q,toggle:B}=S(),E={2:["待审核","warning"],1:["启用","success"],4:["已删除","error"]},N=[{accessorKey:"id",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},header:()=>t(d,{color:"neutral",variant:"ghost",label:"ID",class:"-mx-2.5 hover:bg-transparent focus:bg-transparent data-[state=open]:bg-transparent"})},{accessorKey:"content",header:"内容名称",cell:({row:e})=>{const o=e.original.id,a=M.value.has(o),n=T.value.has(o),c=q.value[o]||[];return t("div",{class:"space-y-2"},[t(y,{text:e.original.content,ui:{content:"max-w-[200px] h-auto",text:"whitespace-pre-wrap break-all select-text"}},()=>t("div",{class:"truncate font-medium"},e.original.content)),t(d,{size:"xs",variant:"ghost",loading:n,icon:a?"i-heroicons-chevron-up":"i-heroicons-chevron-down",onClick:()=>B(e.original)},()=>a?"收起回复":"查看回复"),a&&t("div",{class:"pl-3 border-l space-y-2 text-sm"},c.length?c.map(i=>t("div",{key:i.id},[t("div",{class:"font-medium"},i.member.username),t("div",{class:"text-gray-600"},i.content)])):t("div",{class:"text-gray-400"},"暂无回复"))])}},{accessorKey:"member.username",header:"评论用户",cell:({row:e})=>t("div",void 0,[t("p",{class:"font-medium text-(--ui-text-highlighted)"},e.original.member.username),t("p",{class:"text-xs text-gray-500"},`ID: ${e.original.member.id}`)])},{accessorKey:"created_at",meta:{class:{th:"w-[150px]",td:"w-[150px]"}},header:"创建时间",cell:({row:e})=>$(e.original.created_at)},{accessorKey:"state",meta:{class:{th:"w-[100px]",td:"w-[80px]"}},header:"状态",searchPlaceholder:"筛选状态",formItemProps:{component:"Select",componentProps:{options:[{label:"待审核",value:2},{label:"启用",value:1},{label:"已删除",value:4}]}},cell:({row:e})=>{const o=e.original.state,[a,n]=E[o]||["未知","neutral"];return t(b,{class:"capitalize",variant:"subtle",color:n},()=>a)}}],ve=k({name:"MemberCollectList",__name:"[id]",setup(e){const o=m(),a=P(),n=_(),c=L(()=>n.params.id),i=r=>C({...r,biz_id:c.value}),s=async r=>{const{error:u}=await I({id:r.id});u||o.value.reload()};function p(r){return[{label:"删除",icon:"material-symbols:contract-delete-outline-rounded",color:"error",onSelect(){a.open({color:"error",title:"删除数据",description:"您确定要删除吗？",onPositiveClick(){s(r.original)}})}}]}const l=[...N,{id:"actions",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},cell:({row:r})=>t("div",{class:"text-right"},t(h,{content:{align:"end"},items:p(r)},()=>t(d,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost",class:"ml-auto"})))}];return(r,u)=>{const f=v,g=x;return z(),R(g,null,{default:D(()=>[K(f,{ref_key:"tableRef",ref:o,"data-request":i,columns:l,"scroll-x":"min-w-[1200px]"},null,512)]),_:1})}}});export{ve as default};
