import{w as S,_ as B,a as R,x as z,y as G,z as P}from"./DiI9-bkE.js";import{_ as J}from"./Bml5z8l2.js";import{_ as Q}from"./Baq49nZQ.js";import{_ as W}from"./CuFgEFCp.js";import{_ as H}from"./oJBVUttf.js";import{_ as K}from"./BdKneTYw.js";import{_ as X}from"./DkYr1hfb.js";import{_ as Y}from"./_BOBmhmt.js";import{_ as Z}from"./9B_i7pfW.js";import{_ as ee}from"./8gEztUrL.js";import{c as te,g as oe}from"./B33qAI9M.js";import{c as E}from"./B3KMLFeu.js";import{p as N,ai as se,w as ae,z as c,a1 as le,a2 as i,a7 as o,u as l,Q as s,a6 as f,i as ne,c as ie,h as re,r as T,j as de,A as u,W as C,ah as me,a5 as j,R as D}from"./Cp_GvCOL.js";import"./CM1DIlR0.js";import"./BlLzDdHJ.js";import"./D7PB4JkZ.js";import"./BHtpJmxp.js";import"./C-fFc4Sm.js";import"./DaMwIZ4f.js";import"./BnfZ4xmv.js";import"./CangPKqO.js";import"./C8Jf-TuN.js";import"./DVCf4JVd.js";import"./DZaB2s8a.js";import"./De6cJ90F.js";import"./DnWsfCtc.js";const ce={class:"flex items-center gap-2"},ue={class:"font-semibold"},fe={class:"p-4 rounded-lg bg-(--ui-bg-elevated) border border-(--ui-border) space-y-4"},pe={class:"flex items-center gap-2"},_e={class:"grid grid-cols-2 gap-4"},ge={class:"p-4 rounded-lg bg-(--ui-bg-elevated) border border-(--ui-border) space-y-4"},xe={class:"flex items-center gap-2"},be={class:"flex items-center gap-4"},ve=N({__name:"Edit",props:{dialog:{type:Boolean,default:!1},currentForm:{default:()=>({})}},emits:["update:dialog","refresh"],setup(v,{emit:n}){const p=v,x=n,_=ie({get(){return p.dialog},set(a){x("update:dialog",a)}}),y=()=>{_.value=!1},m=se("formRef"),d=re(),h=[{label:"启用",value:2},{label:"待审核",value:1},{label:"已删除",value:4}],w=[{label:"是",value:1},{label:"否",value:0}],t=T({loading:!1,avatarLoading:!1,form:{}});async function k(a){const e=a.target;if(e.files?.length&&G(e.files[0])){t.avatarLoading=!0;const{data:g}=await P({image:e.files[0]});g&&(t.form.logo=g.uri),t.avatarLoading=!1}}function $(){d.value?.click()}const U=S();async function V(){t.loading=!0;const a=E(t.form),{error:e}=await te(a);e||(U.add({title:"操作成功",color:"success"}),x("refresh")),t.loading=!1}return ae(()=>p.dialog,a=>{a&&(t.loading=!1,t.form=p.currentForm)}),(a,e)=>{const g=R,M=H,b=K,L=X,q=Y,I=z,F=B,A=Z,O=ee;return c(),le(O,{open:l(_),"onUpdate:open":e[6]||(e[6]=r=>ne(_)?_.value=r:null),ui:{footer:"justify-end",content:"sm:max-w-xl"}},{header:i(()=>[s("div",ce,[o(g,{name:"i-lucide-award",class:"w-5 h-5 text-(--ui-primary)"}),s("span",ue,f(v.currentForm.id?"编辑等级":"新增等级"),1)])]),body:i(()=>[o(A,{ref_key:"formRef",ref:m,state:l(t).form,class:"space-y-5",onSubmit:V},{default:i(()=>[s("div",fe,[s("div",pe,[o(g,{name:"i-lucide-info",class:"w-4 h-4 text-(--ui-primary)"}),e[7]||(e[7]=s("span",{class:"text-sm font-medium text-(--ui-text-highlighted)"},"基本信息",-1))]),o(b,{label:"等级名称",name:"name",required:""},{default:i(()=>[o(M,{modelValue:l(t).form.name,"onUpdate:modelValue":e[0]||(e[0]=r=>l(t).form.name=r),modelModifiers:{trim:!0},placeholder:"请输入等级名称",class:"w-full"},null,8,["modelValue"])]),_:1}),s("div",_e,[o(b,{label:"所需电量",name:"battery",required:""},{default:i(()=>[o(M,{modelValue:l(t).form.battery,"onUpdate:modelValue":e[1]||(e[1]=r=>l(t).form.battery=r),modelModifiers:{number:!0},placeholder:"请输入",type:"number",min:"0",class:"w-full"},null,8,["modelValue"])]),_:1}),o(b,{label:"参与分成",name:"divided",required:""},{default:i(()=>[o(L,{modelValue:l(t).form.divided,"onUpdate:modelValue":e[2]||(e[2]=r=>l(t).form.divided=r),items:w,placeholder:"请选择",class:"w-full"},null,8,["modelValue"])]),_:1})]),o(b,{label:"状态",name:"state",required:""},{default:i(()=>[o(L,{modelValue:l(t).form.state,"onUpdate:modelValue":e[3]||(e[3]=r=>l(t).form.state=r),items:h,placeholder:"请选择",class:"w-full"},null,8,["modelValue"])]),_:1}),o(b,{label:"备注",name:"remark"},{default:i(()=>[o(q,{modelValue:l(t).form.remark,"onUpdate:modelValue":e[4]||(e[4]=r=>l(t).form.remark=r),modelModifiers:{trim:!0},placeholder:"请输入备注",class:"w-full",rows:2},null,8,["modelValue"])]),_:1})]),s("div",ge,[s("div",xe,[o(g,{name:"i-lucide-image",class:"w-4 h-4 text-(--ui-warning)"}),e[8]||(e[8]=s("span",{class:"text-sm font-medium text-(--ui-text-highlighted)"},"等级图标",-1))]),s("div",be,[o(I,{src:l(t).form.logo,alt:l(t).form.name,size:"xl"},null,8,["src","alt"]),s("div",null,[o(F,{loading:l(t).avatarLoading,label:"上传图标",color:"neutral",variant:"soft",onClick:$},null,8,["loading"]),e[9]||(e[9]=s("p",{class:"text-xs text-(--ui-text-muted) mt-1"}," 支持 JPG、PNG，最大 1MB ",-1))]),s("input",{ref_key:"fileRef",ref:d,type:"file",class:"hidden",accept:".jpg,.jpeg,.png",onChange:k},null,544)])])]),_:1},8,["state"])]),footer:i(()=>[o(F,{label:"取消",color:"neutral",variant:"outline",onClick:y}),o(F,{loading:l(t).loading,label:"确认",variant:"solid",onClick:e[5]||(e[5]=r=>l(m)?.submit())},null,8,["loading"])]),_:1},8,["open"])}}}),ye=Object.assign(ve,{__name:"MemberLevelEdit"}),he={key:0,class:"flex items-center justify-center py-20"},we={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4"},ke={class:"flex items-center gap-3 mb-3"},$e={class:"flex-1 min-w-0"},Ue={class:"font-semibold text-(--ui-text-highlighted) truncate"},Ve={class:"text-xs text-(--ui-text-muted)"},Fe={class:"space-y-2 text-sm mb-3"},Me={class:"flex justify-between"},Le={class:"font-medium text-yellow-600"},Ce={class:"flex justify-between"},je={key:0,class:"flex justify-between items-start"},De={class:"text-xs text-(--ui-text-muted) truncate max-w-[200px] cursor-help"},Be={class:"pt-3 border-t border-(--ui-border) flex justify-end"},Re={key:2,class:"text-center py-20 text-(--ui-text-muted)"},it=N({name:"MemberLevelList",__name:"level",setup(v){const n=T({isDialog:!1,currentForm:{},loading:!1,list:[]}),p={2:["启用","success"],1:["待审核","warning"],4:["已删除","error"]},x=async()=>{n.loading=!0;try{const{data:m}=await oe({});n.list=m?.list||[]}finally{n.loading=!1}},_=m=>{n.currentForm=m?E(m):{state:2},n.isDialog=!0},y=()=>{n.isDialog=!1,x()};return de(()=>x()),(m,d)=>{const h=R,w=z,t=J,k=Q,$=B,U=W,V=ye;return c(),u(C,null,[o(U,null,{default:i(()=>[l(n).loading?(c(),u("div",he,[o(h,{name:"i-lucide-loader",class:"w-8 h-8 animate-spin text-(--ui-text-muted)"})])):(c(),u("div",we,[(c(!0),u(C,null,me(l(n).list,a=>(c(),u("div",{key:a.id,class:"p-4 rounded-xl bg-(--ui-bg-elevated) border border-(--ui-border) hover:border-(--ui-primary) transition-all"},[s("div",ke,[o(w,{src:a.logo,alt:a.name,size:"lg"},null,8,["src","alt"]),s("div",$e,[s("div",Ue,f(a.name),1),s("div",Ve," ID: "+f(a.id),1)]),o(t,{color:p[a.state]?.[1]||"neutral",variant:"subtle"},{default:i(()=>[j(f(p[a.state]?.[0]||"未知"),1)]),_:2},1032,["color"])]),s("div",Fe,[s("div",Me,[d[1]||(d[1]=s("span",{class:"text-(--ui-text-muted)"},"所需电量",-1)),s("span",Le,f(a.battery),1)]),s("div",Ce,[d[2]||(d[2]=s("span",{class:"text-(--ui-text-muted)"},"参与分成",-1)),o(t,{color:a.divided===1?"success":"error",variant:"subtle"},{default:i(()=>[j(f(a.divided===1?"是":"否"),1)]),_:2},1032,["color"])]),a.remark?(c(),u("div",je,[d[3]||(d[3]=s("span",{class:"text-(--ui-text-muted) shrink-0"},"备注",-1)),o(k,{text:a.remark},{default:i(()=>[s("span",De,f(a.remark),1)]),_:2},1032,["text"])])):D("",!0)]),s("div",Be,[o($,{size:"xs",color:"neutral",variant:"ghost",icon:"i-lucide-pencil",label:"编辑",onClick:e=>_(a)},null,8,["onClick"])])]))),128))])),!l(n).loading&&l(n).list.length===0?(c(),u("div",Re," 暂无用户等级 ")):D("",!0)]),_:1}),o(V,{dialog:l(n).isDialog,"onUpdate:dialog":d[0]||(d[0]=a=>l(n).isDialog=a),"current-form":l(n).currentForm,onRefresh:y},null,8,["dialog","current-form"])],64)}}});export{it as default};
