import{f as k,L as B,a as f,o as n,w as g,r as h,E as K,M as N,b as l,P as L,N as J,h as Z,R as Q,c as m,a7 as W,aa as Y,F as M,C as _,Z as ee,af as ae,u as te,a8 as le,ag as se,t as j,B as b,n as V,k as x,_ as S,G as U,H as O,j as X,D as I,U as oe,y as ne}from"./DhOLkSnF.js";import{_ as re}from"./DAIKkUkW.js";import{a as A,_ as ie}from"./D0vBe5Vh.js";var ue=k({__name:"PaginationEllipsis",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(a){const r=a;return B(),(e,i)=>(n(),f(l(L),N(r,{"data-type":"ellipsis"}),{default:g(()=>[h(e.$slots,"default",{},()=>[i[0]||(i[0]=K("…"))])]),_:3},16))}}),de=ue;const[T,ce]=J("PaginationRoot");var pe=k({__name:"PaginationRoot",props:{page:{type:Number,required:!1},defaultPage:{type:Number,required:!1,default:1},itemsPerPage:{type:Number,required:!0},total:{type:Number,required:!1,default:0},siblingCount:{type:Number,required:!1,default:2},disabled:{type:Boolean,required:!1},showEdges:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"nav"}},emits:["update:page"],setup(a,{emit:r}){const e=a,i=r,{siblingCount:t,disabled:s,showEdges:c}=Z(e);B();const y=Q(e,"page",i,{defaultValue:e.defaultPage,passive:e.page===void 0}),u=m(()=>Math.max(1,Math.ceil(e.total/(e.itemsPerPage||1))));return ce({page:y,onPageChange(v){y.value=v},pageCount:u,siblingCount:t,disabled:s,showEdges:c}),(v,P)=>(n(),f(l(L),{as:v.as,"as-child":v.asChild},{default:g(()=>[h(v.$slots,"default",{page:l(y),pageCount:u.value})]),_:3},8,["as","as-child"]))}}),fe=pe,ge=k({__name:"PaginationFirst",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(a){const r=a,e=T();B();const i=m(()=>e.page.value===1||e.disabled.value);return(t,s)=>(n(),f(l(L),N(r,{"aria-label":"First Page",type:t.as==="button"?"button":void 0,disabled:i.value,onClick:s[0]||(s[0]=c=>!i.value&&l(e).onPageChange(1))}),{default:g(()=>[h(t.$slots,"default",{},()=>[s[1]||(s[1]=K("First page"))])]),_:3},16,["type","disabled"]))}}),me=ge,ve=k({__name:"PaginationLast",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(a){const r=a,e=T();B();const i=m(()=>e.page.value===e.pageCount.value||e.disabled.value);return(t,s)=>(n(),f(l(L),N(r,{"aria-label":"Last Page",type:t.as==="button"?"button":void 0,disabled:i.value,onClick:s[0]||(s[0]=c=>!i.value&&l(e).onPageChange(l(e).pageCount.value))}),{default:g(()=>[h(t.$slots,"default",{},()=>[s[1]||(s[1]=K("Last page"))])]),_:3},16,["type","disabled"]))}}),be=ve;function $(a,r){const e=r-a+1;return Array.from({length:e},(i,t)=>t+a)}function he(a){return a.map(r=>typeof r=="number"?{type:"page",value:r}:{type:"ellipsis"})}const D="ellipsis";function ye(a,r,e,i){const s=r,c=Math.max(a-e,1),y=Math.min(a+e,s);if(i){const v=Math.min(2*e+5,r)-2,P=c>3&&Math.abs(s-v-1+1)>2&&Math.abs(c-1)>2,z=y<s-2&&Math.abs(s-v)>2&&Math.abs(s-y)>2;if(!P&&z)return[...$(1,v),D,s];if(P&&!z){const d=$(s-v+1,s);return[1,D,...d]}if(P&&z){const d=$(c,y);return[1,D,...d,D,s]}return $(1,s)}else{const u=e*2+1;return r<u?$(1,s):a<=e+1?$(1,u):r-a<=e?$(r-u+1,s):$(c,y)}}var Pe=k({__name:"PaginationList",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(a){const r=a;B();const e=T(),i=m(()=>he(ye(e.page.value,e.pageCount.value,e.siblingCount.value,e.showEdges.value)));return(t,s)=>(n(),f(l(L),W(Y(r)),{default:g(()=>[h(t.$slots,"default",{items:i.value})]),_:3},16))}}),_e=Pe,xe=k({__name:"PaginationListItem",props:{value:{type:Number,required:!0},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(a){const r=a;B();const e=T(),i=m(()=>e.page.value===r.value),t=m(()=>e.disabled.value);return(s,c)=>(n(),f(l(L),N(r,{"data-type":"page","aria-label":`Page ${s.value}`,"aria-current":i.value?"page":void 0,"data-selected":i.value?"true":void 0,disabled:t.value,type:s.as==="button"?"button":void 0,onClick:c[0]||(c[0]=y=>!t.value&&l(e).onPageChange(s.value))}),{default:g(()=>[h(s.$slots,"default",{},()=>[K(M(s.value),1)])]),_:3},16,["aria-label","aria-current","data-selected","disabled","type"]))}}),Ce=xe,Ie=k({__name:"PaginationNext",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(a){const r=a;B();const e=T(),i=m(()=>e.page.value===e.pageCount.value||e.disabled.value);return(t,s)=>(n(),f(l(L),N(r,{"aria-label":"Next Page",type:t.as==="button"?"button":void 0,disabled:i.value,onClick:s[0]||(s[0]=c=>!i.value&&l(e).onPageChange(l(e).page.value+1))}),{default:g(()=>[h(t.$slots,"default",{},()=>[s[1]||(s[1]=K("Next page"))])]),_:3},16,["type","disabled"]))}}),ke=Ie,qe=k({__name:"PaginationPrev",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(a){const r=a;B();const e=T(),i=m(()=>e.page.value===1||e.disabled.value);return(t,s)=>(n(),f(l(L),N(r,{"aria-label":"Previous Page",type:t.as==="button"?"button":void 0,disabled:i.value,onClick:s[0]||(s[0]=c=>!i.value&&l(e).onPageChange(l(e).page.value-1))}),{default:g(()=>[h(t.$slots,"default",{},()=>[s[1]||(s[1]=K("Prev page"))])]),_:3},16,["type","disabled"]))}}),we=qe;const ze=k({__name:"ExpandTable",props:{data:{default:[]},columns:{default:[]},scrollX:{default:""}},setup(a){return(r,e)=>{const i=G,t=A;return n(),f(t,{class:"shrink-0",data:a.data,columns:a.columns,ui:{base:`table-fixed border-separate border-spacing-0 w-full ${a.scrollX}`,thead:"[&>tr]:bg-(--ui-bg-elevated)/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-1 first:rounded-l-[calc(var(--ui-radius)*2)] last:rounded-r-[calc(var(--ui-radius)*2)] border-y border-(--ui-border) first:border-l last:border-r",td:"border-b border-(--ui-border) whitespace-normal",tr:"data-[expanded=true]:bg-(--ui-bg-elevated)/50"}},{expanded:g(({row:s})=>[s.original.children?(n(),f(i,{key:0,data:s.original.children,columns:a.columns},null,8,["data","columns"])):_("",!0)]),_:1},8,["data","columns","ui"])}}}),G=Object.assign(ze,{__name:"ExpandTable"}),$e={slots:{root:"",list:"flex items-center gap-1",ellipsis:"pointer-events-none",label:"min-w-5 text-center",first:"",prev:"",item:"",next:"",last:""}},Ne={__name:"UPagination",props:{as:{type:null,required:!1},firstIcon:{type:null,required:!1},prevIcon:{type:null,required:!1},nextIcon:{type:null,required:!1},lastIcon:{type:null,required:!1},ellipsisIcon:{type:null,required:!1},color:{type:null,required:!1,default:"neutral"},variant:{type:null,required:!1,default:"outline"},activeColor:{type:null,required:!1,default:"primary"},activeVariant:{type:null,required:!1,default:"solid"},showControls:{type:Boolean,required:!1,default:!0},size:{type:null,required:!1},to:{type:Function,required:!1},class:{type:null,required:!1},ui:{type:null,required:!1},defaultPage:{type:Number,required:!1},disabled:{type:Boolean,required:!1},itemsPerPage:{type:Number,required:!1,default:10},page:{type:Number,required:!1},showEdges:{type:Boolean,required:!1,default:!1},siblingCount:{type:Number,required:!1,default:2},total:{type:Number,required:!1,default:0}},emits:["update:page"],setup(a,{emit:r}){const e=a,i=r,t=ee(),{dir:s}=ae(),c=te(),y=le(se(e,"as","defaultPage","disabled","itemsPerPage","page","showEdges","siblingCount","total"),i),u=m(()=>e.firstIcon||(s.value==="rtl"?c.ui.icons.chevronDoubleRight:c.ui.icons.chevronDoubleLeft)),v=m(()=>e.prevIcon||(s.value==="rtl"?c.ui.icons.chevronRight:c.ui.icons.chevronLeft)),P=m(()=>e.nextIcon||(s.value==="rtl"?c.ui.icons.chevronLeft:c.ui.icons.chevronRight)),z=m(()=>e.lastIcon||(s.value==="rtl"?c.ui.icons.chevronDoubleLeft:c.ui.icons.chevronDoubleRight)),p=m(()=>j({extend:j($e),...c.ui?.pagination||{}})());return(d,q)=>(n(),f(l(fe),N(l(y),{"data-slot":"root",class:p.value.root({class:[e.ui?.root,e.class]})}),{default:g(({page:C,pageCount:E})=>[b(l(_e),{"data-slot":"list",class:V(p.value.list({class:e.ui?.list}))},{default:g(({items:H})=>[a.showControls||t.first?(n(),f(l(me),{key:0,"as-child":"","data-slot":"first",class:V(p.value.first({class:e.ui?.first}))},{default:g(()=>[h(d.$slots,"first",{},()=>[b(S,{color:a.color,variant:a.variant,size:a.size,icon:u.value,to:a.to?.(1)},null,8,["color","variant","size","icon","to"])])]),_:3},8,["class"])):_("",!0),a.showControls||t.prev?(n(),f(l(we),{key:1,"as-child":"","data-slot":"prev",class:V(p.value.prev({class:e.ui?.prev}))},{default:g(()=>[h(d.$slots,"prev",{},()=>[b(S,{color:a.color,variant:a.variant,size:a.size,icon:v.value,to:C>1?a.to?.(C-1):void 0},null,8,["color","variant","size","icon","to"])])]),_:2},1032,["class"])):_("",!0),(n(!0),x(U,null,O(H,(w,F)=>(n(),x(U,{key:F},[w.type==="page"?(n(),f(l(Ce),{key:0,"as-child":"",value:w.value,"data-slot":"item",class:V(p.value.item({class:e.ui?.item}))},{default:g(()=>[h(d.$slots,"item",N({ref_for:!0},{item:w,index:F,page:C,pageCount:E}),()=>[b(S,{color:C===w.value?a.activeColor:a.color,variant:C===w.value?a.activeVariant:a.variant,size:a.size,label:String(w.value),ui:{label:p.value.label()},to:a.to?.(w.value),square:""},null,8,["color","variant","size","label","ui","to"])])]),_:2},1032,["value","class"])):(n(),f(l(de),{key:1,"as-child":"","data-slot":"ellipsis",class:V(p.value.ellipsis({class:e.ui?.ellipsis}))},{default:g(()=>[h(d.$slots,"ellipsis",{ui:p.value},()=>[b(S,{as:"div",color:a.color,variant:a.variant,size:a.size,icon:a.ellipsisIcon||l(c).ui.icons.ellipsis},null,8,["color","variant","size","icon"])])]),_:3},8,["class"]))],64))),128)),a.showControls||t.next?(n(),f(l(ke),{key:2,"as-child":"","data-slot":"next",class:V(p.value.next({class:e.ui?.next}))},{default:g(()=>[h(d.$slots,"next",{},()=>[b(S,{color:a.color,variant:a.variant,size:a.size,icon:P.value,to:C<E?a.to?.(C+1):void 0},null,8,["color","variant","size","icon","to"])])]),_:2},1032,["class"])):_("",!0),a.showControls||t.last?(n(),f(l(be),{key:3,"as-child":"","data-slot":"last",class:V(p.value.last({class:e.ui?.last}))},{default:g(()=>[h(d.$slots,"last",{},()=>[b(S,{color:a.color,variant:a.variant,size:a.size,icon:z.value,to:a.to?.(E)},null,8,["color","variant","size","icon","to"])])]),_:2},1032,["class"])):_("",!0)]),_:2},1032,["class"])]),_:3},16,["class"]))}},Be={class:"pt-[var(--ui-header-height)]"},Le={key:0,class:"flex flex-wrap items-center mb-4 sm:mb-6 gap-4"},Re={class:"pointer-events-none absolute left-0 -top-2.5 text-highlighted text-xs font-medium px-1.5 transition-all peer-focus:-top-2.5 peer-focus:text-highlighted peer-focus:text-xs peer-focus:font-medium peer-placeholder-shown:text-sm peer-placeholder-shown:text-dimmed peer-placeholder-shown:top-1.5 peer-placeholder-shown:font-normal"},Ve={class:"inline-flex bg-default px-1"},Se={key:1,class:"relative"},Ee=["value","placeholder"],Ue={class:"pointer-events-none absolute left-0 -top-2.5 text-highlighted text-xs font-medium px-1.5 transition-all peer-focus:-top-2.5 peer-focus:text-highlighted peer-focus:text-xs peer-focus:font-medium peer-placeholder-shown:text-sm peer-placeholder-shown:text-dimmed peer-placeholder-shown:top-1.5 peer-placeholder-shown:font-normal"},Ke={class:"inline-flex bg-default px-1"},Te={key:2,class:"relative"},Me={class:"pointer-events-none absolute left-0 -top-2.5 text-highlighted text-xs font-medium px-1.5"},Fe={class:"inline-flex bg-default px-1"},De={class:"flex flex-wrap items-center gap-4"},He={key:1,class:"mb-4 sm:mb-6"},je={key:1,class:"flex items-center justify-between gap-3 border-t border-(--ui-border) pt-4 mt-auto"},Xe={class:"text-sm text-(--ui-text-muted)"},Oe={class:"flex items-center gap-1.5"},Ae=k({__name:"DynamicTable",props:{hideToolbar:{type:Boolean,default:!1},search:{type:Boolean,default:!0},loading:{type:Boolean},dataRequest:{},columns:{default:[]},scrollX:{default:"min-w-[1000px]"},defaultPageSize:{default:10}},setup(a,{expose:r}){const e=a,i=m(()=>e.search&&e.columns.some(p=>p.searchPlaceholder)),t=X({loading:!1,isBackendPagination:!1,formHash:"",form:null,list:[],showList:[]}),s=m(()=>e.columns.filter(p=>!p.hideInTable)),c=m(()=>e.loading||t.loading),y=async(p,d)=>{t.form[d]=p.trim()},u=X({page:1,pageSize:e.defaultPageSize,itemCount:0,onUpdatePage:p=>{u.page=p,t.isBackendPagination?P():v()}});function v(){t.showList=t.list.slice((Number(u.page)-1)*Number(u.pageSize),Number(u.page)*Number(u.pageSize))}async function P(){t.loading=!0;const p=JSON.stringify(t.form);t.formHash!==p&&(u.page=1,t.formHash=p);const{data:d}=await e.dataRequest({page:u.page,pagesize:u.pageSize,...t.form});d&&(t.isBackendPagination=!!d.count,t.isBackendPagination?(u.itemCount=d.count,t.showList=d.list):(t.list=d.list,u.itemCount=d.list.length,v())),t.loading=!1}async function z(){u.page=1,t.form=null,ne(()=>{const p={};e.columns.forEach(d=>{if(d.formItemProps?.defaultValue!==void 0){const q=d.formItemProps?.field||d.accessorKey;p[q]=d.formItemProps.defaultValue}}),t.form=p,P()})}return z(),r({reload:P}),(p,d)=>{const q=S,C=re,E=ie,H=G,w=A,F=Ne;return n(),x("div",Be,[a.hideToolbar?_("",!0):(n(),x(U,{key:0},[l(i)&&l(t).form?(n(),x("div",Le,[(n(!0),x(U,null,O(a.columns,o=>(n(),x(U,{key:o.accessorKey},[o.searchPlaceholder?(n(),x(U,{key:0},[o.formItemProps?o.formItemProps&&o.formItemProps.component==="Select"?(n(),x("div",Se,[b(E,{modelValue:l(t).form[o.formItemProps?.field||o.accessorKey],"onUpdate:modelValue":R=>l(t).form[o.formItemProps?.field||o.accessorKey]=R,items:o.formItemProps.componentProps.options,placeholder:o.searchPlaceholder,class:"w-[180px]",ui:{placeholder:"opacity-0",trailing:"pe-1"}},{trailing:g(()=>[l(t).form[o.formItemProps?.field||o.accessorKey]||l(t).form[o.formItemProps?.field||o.accessorKey]===0?(n(),f(q,{key:0,color:"neutral",variant:"link",size:"sm",icon:"i-lucide-circle-x"})):_("",!0)]),_:2},1032,["modelValue","onUpdate:modelValue","items","placeholder"]),I("input",{type:"text",value:l(t).form[o.formItemProps?.field||o.accessorKey],placeholder:o.searchPlaceholder,class:"hidden peer"},null,8,Ee),I("label",Ue,[I("span",Ke,M(o.searchPlaceholder),1)]),l(t).form[o.formItemProps?.field||o.accessorKey]||l(t).form[o.formItemProps?.field||o.accessorKey]===0?(n(),f(q,{key:0,color:"neutral",variant:"link",size:"sm",icon:"i-lucide-circle-x",class:"absolute top-1/2 right-1 -translate-y-1/2 opacity-0",onClick:R=>l(t).form[o.formItemProps?.field||o.accessorKey]=""},null,8,["onClick"])):_("",!0)])):o.formItemProps&&o.formItemProps.component==="DateInput"?(n(),x("div",Te,[b(C,{modelValue:l(t).form[o.formItemProps?.field||o.accessorKey],"onUpdate:modelValue":R=>l(t).form[o.formItemProps?.field||o.accessorKey]=R,type:"date",class:"w-[160px]"},null,8,["modelValue","onUpdate:modelValue"]),I("label",Me,[I("span",Fe,M(o.searchPlaceholder),1)])])):_("",!0):(n(),f(C,{key:0,"model-value":l(t).form[o.accessorKey],placeholder:"",class:"w-[180px]",ui:{base:"peer",trailing:"pe-1"},"onUpdate:modelValue":R=>{y(R,o.accessorKey)},onKeyup:oe(P,["enter"])},{trailing:g(()=>[l(t).form[o.accessorKey]?(n(),f(q,{key:0,color:"neutral",variant:"link",size:"sm",icon:"i-lucide-circle-x",onClick:R=>l(t).form[o.accessorKey]=""},null,8,["onClick"])):_("",!0)]),default:g(()=>[I("label",Re,[I("span",Ve,M(o.searchPlaceholder),1)])]),_:2},1032,["model-value","onUpdate:modelValue"]))],64)):_("",!0)],64))),128)),I("div",De,[b(q,{disabled:l(c),label:"查询",icon:"i-lucide-search",onClick:P},null,8,["disabled"]),b(q,{disabled:l(c),label:"重置",icon:"fluent:arrow-reset-24-filled",color:"neutral",variant:"outline",onClick:z},null,8,["disabled"])])])):(n(),x("div",He,[b(q,{disabled:l(c),label:"刷新",icon:"mdi-refresh",color:"neutral",variant:"outline",onClick:P},null,8,["disabled"])]))],64)),b(w,{ref:"table",sticky:"",class:"flex-1 shrink-0",data:l(t).showList,columns:l(s),loading:l(c),ui:{base:`table-fixed border-separate border-spacing-0 w-full ${a.scrollX}`,thead:"[&>tr]:bg-(--ui-bg-elevated)/50 [&>tr]:after:content-none",tbody:"[&>tr]:last:[&>td]:border-b-0",th:"py-1 first:rounded-l-[calc(var(--ui-radius)*2)] last:rounded-r-[calc(var(--ui-radius)*2)] border-y border-(--ui-border) first:border-l last:border-r",td:"border-b border-(--ui-border) whitespace-normal break-all",tr:"data-[expanded=true]:bg-(--ui-bg-elevated)/50"}},{expanded:g(({row:o})=>[o.original.children?(n(),f(H,{key:0,data:o.original.children,columns:l(s),"scroll-x":a.scrollX},null,8,["data","columns","scroll-x"])):_("",!0)]),_:1},8,["data","columns","loading","ui"]),l(u).pageSize!==999?(n(),x("div",je,[I("div",Xe," 共 "+M(l(u).itemCount)+" 条数据 ",1),I("div",Oe,[b(F,{"show-edges":"","sibling-count":1,page:l(u).page,"items-per-page":l(u).pageSize,total:l(u).itemCount,"onUpdate:page":l(u).onUpdatePage},null,8,["page","items-per-page","total","onUpdate:page"]),b(E,{modelValue:l(u).pageSize,"onUpdate:modelValue":d[0]||(d[0]=o=>l(u).pageSize=o),items:[{value:10,label:"10 / 页"},{value:20,label:"20 / 页"},{value:50,label:"50 / 页"},{value:100,label:"100 / 页"}],onChange:d[1]||(d[1]=o=>l(u).onUpdatePage(1))},null,8,["modelValue"])])])):_("",!0)])}}}),Qe=Object.assign(Ae,{__name:"DynamicTable"});export{Qe as _};
