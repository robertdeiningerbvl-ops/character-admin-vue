import{_ as q}from"./CEcF5dWm.js";import{f as E,c as j,ap as I,j as P,aE as K,l as M,a as N,o as U,w as i,B as o,_ as v,b as e,a4 as L,aF as p,i as O,k as D,A as z,C as A,D as G,G as H}from"./DhOLkSnF.js";import{_ as J,a as Q,b as W,c as X}from"./DAqc9GYg.js";import{_ as Y}from"./CSbqei5V.js";import{_ as Z}from"./DAIKkUkW.js";import{_ as ee}from"./DAeRr84W.js";import{_ as oe}from"./D0vBe5Vh.js";import{_ as te}from"./Db__RPjw.js";import{_ as ae}from"./BZLiX_8y.js";import{u as se,a as ne,g as le,r as re}from"./D1QVHQma.js";import{c as S}from"./45RcOEEf.js";import{o as ie,n as F,s as me}from"./B-mCBPct.js";import{u as ce,b as ue}from"./Bo5OMT4U.js";import{_ as V}from"./-rcGzxkB.js";import{f as de}from"./BmKy9gZZ.js";import{u as pe}from"./BVQSm7Ip.js";import"./CZg69nbc.js";import"./CwtpYSSp.js";import"./DPsBupTg.js";import"./9Rxep3Q5.js";import"./CLKxJTZi.js";import"./HRiyi1uV.js";import"./BrXYpapi.js";import"./BXSyqGa5.js";const fe=E({__name:"Edit",props:{dialog:{type:Boolean,default:!1},currentForm:{default:()=>({})}},emits:["update:dialog","refresh"],setup(l,{emit:$}){const u=l,d=$,c=j({get(){return u.dialog},set(t){d("update:dialog",t)}}),h=()=>{c.value=!1},r=I("formRef"),f=ie({name:me().nonempty(),ty:F().min(0),state:F().min(0)}),x=[{label:"启用",value:2},{label:"已删除",value:4}],C=[{label:"系统",value:0},{label:"业务",value:1}],a=P({loading:!1,avatarLoading:!1,form:{}}),k=K();async function n(){a.loading=!0;const t=S(a.form);console.log("postForm",t);const{error:s}=await(t.id?se:ne)(t);s||(k.add({title:"操作成功",color:"success"}),d("refresh")),a.loading=!1}return M(()=>u.dialog,t=>{t&&(a.loading=!1,a.form=u.currentForm)}),(t,s)=>{const T=Z,_=ee,b=oe,w=te,y=v,g=ae;return U(),N(g,{open:e(c),"onUpdate:open":s[4]||(s[4]=m=>L(c)?c.value=m:null),title:l.currentForm.id?"修改":"新增",dismissible:!1,ui:{footer:"justify-end"}},{body:i(()=>[o(w,{ref_key:"formRef",ref:r,schema:e(f),state:e(a).form,class:"flex flex-col gap-4",onSubmit:n},{default:i(()=>[o(_,{label:"名称",name:"name",required:""},{default:i(()=>[o(T,{modelValue:e(a).form.name,"onUpdate:modelValue":s[0]||(s[0]=m=>e(a).form.name=m),modelModifiers:{trim:!0},placeholder:"请输入",class:"w-full",ui:{trailing:"pe-1"}},null,8,["modelValue"])]),_:1}),o(_,{label:"类型",name:"ty",required:""},{default:i(()=>[o(b,{modelValue:e(a).form.ty,"onUpdate:modelValue":s[1]||(s[1]=m=>e(a).form.ty=m),items:C,placeholder:"请选择",class:"w-full"},null,8,["modelValue"])]),_:1}),o(_,{label:"状态",name:"state",required:""},{default:i(()=>[o(b,{modelValue:e(a).form.state,"onUpdate:modelValue":s[2]||(s[2]=m=>e(a).form.state=m),items:x,placeholder:"请选择",class:"w-full"},null,8,["modelValue"])]),_:1})]),_:1},8,["schema","state"])]),footer:i(()=>[o(y,{label:"取消",color:"neutral",variant:"outline",onClick:h}),o(y,{loading:e(a).loading,label:"确认",variant:"solid",onClick:s[3]||(s[3]=m=>e(r)?.submit())},null,8,["loading"])]),_:1},8,["open","title"])}}}),_e=Object.assign(fe,{__name:"CommonTagEdit"}),B={2:["启用","success"],4:["删除","error"]},R={1:["业务","success"],0:["系统","error"]},ge=[{accessorKey:"id",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},header:()=>p(v,{color:"neutral",variant:"ghost",label:"ID",class:"-mx-2.5 hover:bg-transparent focus:bg-transparent data-[state=open]:bg-transparent"})},{accessorKey:"name",searchPlaceholder:"筛选名称",header:"名称"},{accessorKey:"ty",searchPlaceholder:"筛选类型",header:"类型",formItemProps:{component:"Select",componentProps:{options:[{label:"系统",value:0},{label:"业务",value:1}]}},cell:({row:l})=>p(V,{class:"capitalize",variant:"subtle",color:R[l.original.ty]?.[1]},()=>R[l.original.ty]?.[0])},{accessorKey:"state",header:"状态",formItemProps:{component:"Select",componentProps:{options:[{label:"启动",value:2},{label:"关闭",value:4}]}},cell:({row:l})=>p(V,{class:"capitalize",variant:"subtle",color:B[l.original.state]?.[1]},()=>B[l.original.state]?.[0])},{accessorKey:"updated_at",header:"更新时间",cell:({row:l})=>de(l.original.updated_at)}],be={key:0,class:"absolute top-0 left-0 right-0 h-(--ui-header-height) flex items-center justify-between border-b border-(--ui-border) px-4 sm:px-6 bg-(--ui-bg)"},ye={class:"flex items-center gap-4"},Oe=E({name:"TagList",__name:"tag",setup(l){const u=ce(ue).smaller("lg"),d=O(),c=v,h=pe(),r=P({isDialog:!1,currentForm:{}}),f=async n=>{r.isDialog=!0,n?r.currentForm=S(n):r.currentForm={state:2}},x=async()=>{d.value.reload(),r.isDialog=!1},C=async n=>{const{error:t}=await re({id:n.id});t||d.value.reload()};function a(n){return[{label:"编辑",icon:"material-symbols:edit-square-outline",onSelect(){f(n.original)}},{type:"separator"},{label:"删除",icon:"material-symbols:contract-delete-outline-rounded",color:"error",onSelect(){h.open({color:"error",title:"删除数据",description:"您确定要删除吗？",onPositiveClick(){C(n.original)}})}}]}const k=[...ge,{id:"actions",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},cell:({row:n})=>p("div",{class:"text-right"},p(q,{content:{align:"end"},items:a(n)},()=>p(v,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost",class:"ml-auto"})))}];return(n,t)=>{const s=Q,T=J,_=W,b=Y,w=X,y=_e;return U(),D(H,null,[o(w,{ui:{body:"pb-[12px]! gap-0!"}},z({body:i(()=>[e(u)?A("",!0):(U(),D("div",be,[G("div",ye,[o(s),o(_)]),o(e(c),{label:"新增",icon:"i-lucide-plus",onClick:t[1]||(t[1]=g=>f(null))})])),o(b,{ref_key:"tableRef",ref:d,"data-request":e(le),columns:k,"scroll-x":"min-w-[400px]"},null,8,["data-request"])]),_:2},[e(u)?{name:"header",fn:i(()=>[o(T,{title:"模型列表"},{leading:i(()=>[o(s)]),right:i(()=>[o(e(c),{label:"新增",icon:"i-lucide-plus",onClick:t[0]||(t[0]=g=>f(null))})]),_:1})]),key:"0"}:void 0]),1024),o(y,{dialog:e(r).isDialog,"onUpdate:dialog":t[2]||(t[2]=g=>e(r).isDialog=g),"current-form":e(r).currentForm,onRefresh:x},null,8,["dialog","current-form"])],64)}}});export{Oe as default};
