import{_ as I}from"./Bml5z8l2.js";import{_ as K}from"./DkYr1hfb.js";import{u as T,P as q,t as L,_ as Q,a as J,d as U}from"./DiI9-bkE.js";import{_ as W}from"./BWlWix-i.js";import{z as n,a1 as p,a2 as x,B as X,ae as C,u as s,c as G,p as ee,J as te,Q as o,a5 as Y,a6 as _,R as j,a7 as i,A as c,W as b,ah as y,r as ae,h as se}from"./Cp_GvCOL.js";import{_ as re}from"./K6pfE6CB.js";import{_ as oe}from"./C8Jf-TuN.js";import{r as ne,g as le}from"./F_2iFtsw.js";import{S as ie,C as ce,b as de,d as B,A as ue,z as me}from"./CM1DIlR0.js";import{_ as fe}from"./DlAUqK2U.js";import"./D7PB4JkZ.js";import"./DZaB2s8a.js";import"./C-fFc4Sm.js";import"./De6cJ90F.js";import"./DnWsfCtc.js";import"./BlLzDdHJ.js";import"./B3KMLFeu.js";import"./B9BvCEkO.js";import"./BnfZ4xmv.js";const pe={base:"animate-pulse rounded-md bg-elevated"},ge={__name:"USkeleton",props:{as:{type:null,required:!1},class:{type:null,required:!1}},setup(w){const t=w,m=T(),f=G(()=>L({extend:L(pe),...m.ui?.skeleton||{}}));return(d,$)=>(n(),p(s(q),{as:w.as,"aria-busy":"true","aria-label":"loading","aria-live":"polite",role:"alert",class:C(f.value({class:t.class}))},{default:x(()=>[X(d.$slots,"default")]),_:3},8,["as","class"]))}},_e={class:"p-4 md:p-6 lg:p-8"},xe={class:"flex items-center justify-between mb-6"},he={class:"flex items-center gap-3"},be={class:"flex items-center gap-2"},ye={key:0,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-8"},ve={key:1,class:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-8"},ke={class:"flex items-start justify-between"},Ce={class:"text-sm text-(--ui-text-muted) mb-1"},we={class:"text-2xl font-semibold text-(--ui-text-highlighted)"},De={key:0,class:"mt-2 flex items-center gap-1 text-xs"},Me={class:"rounded-xl border border-(--ui-border) bg-(--ui-bg) p-4 md:p-6 mb-8"},Ue={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-6"},Ye={class:"flex flex-wrap gap-2"},$e={key:1,class:"h-80"},ze={key:2,class:"h-80 flex items-center justify-center text-(--ui-text-muted)"},Ne={class:"text-center"},Se={class:"rounded-xl border border-(--ui-border) bg-(--ui-bg) p-4 md:p-6"},Le={class:"flex items-center justify-between mb-4"},je={key:1,class:"overflow-x-auto"},Be={key:2,class:"py-12 text-center text-(--ui-text-muted)"},Ee=ee({name:"Home",__name:"index",setup(w){const t=ae({loading:!0,range:7,rangeOptions:[{label:"今日",value:0},{label:"昨天",value:1},{label:"近3天",value:3},{label:"近7天",value:7},{label:"近30天",value:30}],summaryList:[],rawList:[],chartData:[]}),m=[{f:"ZC_NUM",name:"注册人数",icon:"lucide:user-plus",color:"primary"},{f:"HY_NUM",name:"活跃人数",icon:"lucide:users",color:"success"},{f:"CZ_NUM",name:"充值人数",icon:"lucide:wallet",color:"warning"},{f:"CZ_PRICE",name:"充值金额",icon:"lucide:banknote",color:"error"},{f:"HY_YK_NUM",name:"游客人数",icon:"lucide:user",color:"info"},{f:"AQ_NUM",name:"邀请人数",icon:"lucide:share-2",color:"secondary"},{f:"DH_NUM",name:"对话数",icon:"lucide:message-circle",color:"primary"},{f:"XF_NUM",name:"消费电量",icon:"lucide:zap",color:"warning"},{f:"CZ_SUCCESS",name:"成功订单",icon:"lucide:check-circle",color:"success"},{f:"CZ_ERROR",name:"未付款单",icon:"lucide:x-circle",color:"error"}],f={primary:"var(--ui-primary)",success:"#22c55e",warning:"#f59e0b",error:"#ef4444",info:"#3b82f6",secondary:"#8b5cf6"},d=se(["ZC_NUM","HY_NUM","CZ_PRICE"]),$=()=>{const r=U();if(t.range===0){const a=r.format("YYYY-MM-DD");return{start:a,end:a}}if(t.range===1){const a=r.subtract(1,"day").format("YYYY-MM-DD");return{start:a,end:a}}return{start:r.subtract(t.range-1,"day").format("YYYY-MM-DD"),end:r.format("YYYY-MM-DD")}},E=()=>{if(!t.rawList.length){t.summaryList=[],t.chartData=[];return}const r=new Map;t.rawList.forEach(a=>{a.stats?.forEach(l=>{r.set(l.f,(r.get(l.f)||0)+l.num)})}),t.summaryList=m.map(a=>({...a,num:r.get(a.f)||0})),t.chartData=[...t.rawList].sort((a,l)=>U(a.tm).valueOf()-U(l.tm).valueOf()).map(a=>{const l={date:a.tm};return a.stats?.forEach(g=>{l[g.f]=g.num}),l})},z=async()=>{const{data:r}=await le($());r&&r.list&&(t.rawList=r.list,E())},N=async()=>{t.loading=!0,await z(),t.loading=!1},R=async()=>{t.loading=!0,await ne(),await z(),t.loading=!1};async function V(){N()}te(()=>{V()});const S=(r,a)=>a,Z=r=>t.chartData[r]?.date?.slice(5)||"",O=r=>{if(!r)return"";const a=d.value.map(l=>{const g=m.find(v=>v.f===l);return`<div class="flex items-center gap-2">
      <span class="size-2 rounded-full" style="background: ${f[g?.color]||f.primary}"></span>
      <span>${g?.name||l}: ${r[l]??0}</span>
    </div>`});return`<div class="text-sm space-y-1">
    <div class="font-medium mb-1">${r.date}</div>
    ${a.join("")}
  </div>`},D=r=>r>=1e4?(r/1e4).toFixed(1)+"w":r>=1e3?(r/1e3).toFixed(1)+"k":r.toString(),h=r=>{if(t.chartData.length<2)return null;const a=t.chartData[t.chartData.length-1]?.[r]||0,l=t.chartData[t.chartData.length-2]?.[r]||0;return l===0?a>0?100:0:Math.round((a-l)/l*100)};return(r,a)=>{const l=I,g=K,v=Q,P=W,M=ge,k=J,A=re,H=oe;return n(),p(H,null,{body:x(()=>[o("div",_e,[o("div",xe,[o("div",he,[a[1]||(a[1]=o("h1",{class:"text-xl font-semibold text-(--ui-text-highlighted)"}," 数据概览 ",-1)),s(t).loading?j("",!0):(n(),p(l,{key:0,color:"neutral",variant:"subtle"},{default:x(()=>[Y(_(s(t).rangeOptions.find(e=>e.value===s(t).range)?.label),1)]),_:1}))]),o("div",be,[i(g,{modelValue:s(t).range,"onUpdate:modelValue":a[0]||(a[0]=e=>s(t).range=e),disabled:s(t).loading,icon:"lucide:calendar",size:"sm",items:s(t).rangeOptions,class:"w-28",onChange:N},null,8,["modelValue","disabled","items"]),i(v,{color:"neutral",variant:"ghost",size:"sm",icon:"lucide:refresh-cw",loading:s(t).loading,onClick:R},null,8,["loading"]),i(P,{size:"sm"})])]),s(t).loading?(n(),c("div",ye,[(n(),c(b,null,y(10,e=>i(M,{key:e,class:"h-24 rounded-xl"})),64))])):(n(),c("div",ve,[(n(!0),c(b,null,y(s(t).summaryList,e=>(n(),c("div",{key:e.f,class:"relative p-4 rounded-xl border border-(--ui-border) bg-(--ui-bg) hover:bg-(--ui-bg-elevated) transition-colors group"},[o("div",ke,[o("div",null,[o("p",Ce,_(e.name),1),o("p",we,_(D(e.num)),1)]),o("div",{class:C(["size-10 rounded-lg flex items-center justify-center",{"bg-primary/10 text-primary":e.color==="primary","bg-green-500/10 text-green-500":e.color==="success","bg-amber-500/10 text-amber-500":e.color==="warning","bg-red-500/10 text-red-500":e.color==="error","bg-blue-500/10 text-blue-500":e.color==="info","bg-purple-500/10 text-purple-500":e.color==="secondary"}])},[i(k,{name:e.icon,class:"size-5"},null,8,["name"])],2)]),h(e.f)!==null&&s(t).chartData.length>1?(n(),c("div",De,[i(k,{name:h(e.f)>=0?"lucide:trending-up":"lucide:trending-down",class:C(["size-3.5",h(e.f)>=0?"text-green-500":"text-red-500"])},null,8,["name","class"]),o("span",{class:C(h(e.f)>=0?"text-green-500":"text-red-500")},_(Math.abs(h(e.f)))+"% ",3),a[2]||(a[2]=o("span",{class:"text-(--ui-text-dimmed)"},"较前一天",-1))])):j("",!0)]))),128))])),o("div",Me,[o("div",Ue,[a[3]||(a[3]=o("div",null,[o("h2",{class:"text-lg font-semibold text-(--ui-text-highlighted)"}," 数据趋势 "),o("p",{class:"text-sm text-(--ui-text-muted)"}," 查看各项指标的变化趋势 ")],-1)),o("div",Ye,[(n(!0),c(b,null,y(m.slice(0,6),e=>(n(),p(v,{key:e.f,size:"xs",color:s(d).includes(e.f)?"primary":"neutral",variant:s(d).includes(e.f)?"solid":"outline",onClick:u=>s(d).includes(e.f)?d.value=s(d).filter(F=>F!==e.f):s(d).push(e.f)},{default:x(()=>[Y(_(e.name),1)]),_:2},1032,["color","variant","onClick"]))),128))])]),s(t).loading?(n(),p(M,{key:0,class:"h-80 rounded-lg"})):s(t).chartData.length>1?(n(),c("div",$e,[i(s(ie),{data:s(t).chartData,padding:{top:10}},{default:x(()=>[(n(!0),c(b,null,y(s(d),e=>(n(),p(s(ce),{key:"area-"+e,x:S,y:u=>u[e]||0,color:f[m.find(u=>u.f===e)?.color]||f.primary,opacity:.1,"curve-type":"linear"},null,8,["y","color"]))),128)),(n(!0),c(b,null,y(s(d),e=>(n(),p(s(de),{key:"line-"+e,x:S,y:u=>u[e]||0,color:f[m.find(u=>u.f===e)?.color]||f.primary,"line-width":2,"curve-type":"linear"},null,8,["y","color"]))),128)),i(s(B),{type:"x","tick-format":Z,"grid-line":!1}),i(s(B),{type:"y","tick-format":e=>D(e)},null,8,["tick-format"]),i(s(ue),{template:O}),i(s(me))]),_:1},8,["data"])])):(n(),c("div",ze,[o("div",Ne,[i(k,{name:"lucide:bar-chart-3",class:"size-12 mb-2 opacity-50"}),a[4]||(a[4]=o("p",null,"数据不足，无法显示趋势图",-1)),a[5]||(a[5]=o("p",{class:"text-sm"}," 请选择更长的时间范围 ",-1))])]))]),o("div",Se,[o("div",Le,[a[6]||(a[6]=o("h2",{class:"text-lg font-semibold text-(--ui-text-highlighted)"}," 详细数据 ",-1)),i(l,{color:"neutral",variant:"subtle"},{default:x(()=>[Y(" 共 "+_(s(t).chartData.length)+" 条记录 ",1)]),_:1})]),s(t).loading?(n(),p(M,{key:0,class:"h-60 rounded-lg"})):s(t).chartData.length?(n(),c("div",je,[i(A,{data:s(t).chartData,columns:[{accessorKey:"date",header:"日期"},...m.map(e=>({accessorKey:e.f,header:e.name,cell:({row:u})=>D(u.original[e.f]||0)}))],ui:{base:"min-w-[1200px]",thead:"[&>tr]:bg-(--ui-bg-elevated)/50",th:"py-3 text-center font-medium",td:"text-center"}},null,8,["data","columns"])])):(n(),c("div",Be,[i(k,{name:"lucide:inbox",class:"size-10 mb-2 opacity-50"}),a[7]||(a[7]=o("p",null,"暂无数据",-1))]))])])]),_:1})}}}),at=fe(Ee,[["__scopeId","data-v-574ad92f"]]);export{at as default};
