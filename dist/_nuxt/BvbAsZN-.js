import{_ as I}from"./1OJ4jHSB.js";import{w as S,_ as k,a as L}from"./DiI9-bkE.js";import{_ as O}from"./Odvr87Pg.js";import{_ as A}from"./CuFgEFCp.js";import{_ as j}from"./oJBVUttf.js";import{_ as N}from"./BdKneTYw.js";import{_ as z}from"./DkYr1hfb.js";import{_ as Q}from"./_BOBmhmt.js";import{_ as W}from"./9B_i7pfW.js";import{_ as G}from"./8gEztUrL.js";import{c as H,d as J,g as X,e as Y,r as Z}from"./BWGna7Av.js";import{c as q}from"./B3KMLFeu.js";import{p as K,ai as ee,w as te,z as F,a1 as le,a2 as r,a7 as l,u as a,Q as i,a6 as ae,i as oe,c as se,h as P,r as E,E as n,A as ie,W as re}from"./Cp_GvCOL.js";import{_ as T}from"./Bml5z8l2.js";import{f as ne}from"./CE7u-7DH.js";import{u as me}from"./BCMcqMGM.js";import"./D7PB4JkZ.js";import"./C-fFc4Sm.js";import"./DnWsfCtc.js";import"./C6Y-ieo6.js";import"./De6cJ90F.js";import"./BrwH2_O0.js";import"./7ga_NNx6.js";import"./BHtpJmxp.js";import"./BlLzDdHJ.js";import"./CM1DIlR0.js";import"./K6pfE6CB.js";import"./B9BvCEkO.js";import"./DxT_AjaP.js";import"./DaMwIZ4f.js";import"./BnfZ4xmv.js";import"./CangPKqO.js";import"./C8Jf-TuN.js";import"./DVCf4JVd.js";import"./DZaB2s8a.js";const de={class:"flex items-center gap-2"},ue={class:"font-semibold"},ce={class:"p-4 rounded-lg bg-(--ui-bg-elevated) border border-(--ui-border) space-y-4"},pe={class:"flex items-center gap-2"},fe={class:"grid grid-cols-2 gap-4"},ge={class:"p-4 rounded-lg bg-(--ui-bg-elevated) border border-(--ui-border) space-y-4"},_e={class:"flex items-center gap-2"},xe={class:"grid grid-cols-2 gap-4"},ye={class:"p-4 rounded-lg bg-(--ui-bg-elevated) border border-(--ui-border) space-y-4"},be={class:"flex items-center gap-2"},we={class:"grid grid-cols-2 gap-4"},he={class:"p-4 rounded-lg bg-(--ui-bg-elevated) border border-(--ui-border) space-y-4"},ve={class:"flex items-center gap-2"},Ve={class:"grid grid-cols-2 gap-4"},Ue={class:"p-4 rounded-lg bg-(--ui-bg-elevated) border border-(--ui-border) space-y-4"},De={class:"flex items-center gap-2"},Me=K({__name:"Edit",props:{dialog:{type:Boolean,default:!1},currentForm:{default:()=>({})}},emits:["update:dialog","refresh"],setup(s,{emit:c}){const p=s,x=c,f=se({get(){return p.dialog},set(u){x("update:dialog",u)}}),y=()=>{f.value=!1},b=ee("formRef"),v=[{label:"正常",value:2},{label:"删除",value:4},{label:"待审核",value:0}],w=P([]),V=[{label:"范围金额",value:2},{label:"固定金额",value:1}],d=[{label:"MD5-方式1",value:1},{label:"MD5-方式2",value:2},{label:"MD5-方式3",value:3},{label:"MD5-方式4",value:4},{label:"MD5-方式5",value:5}],t=E({loading:!1,avatarLoading:!1,form:{}}),U=S();async function D(){t.loading=!0;const u=q(t.form),{error:e}=await(u.id?H:J)(u);e||(U.add({title:"操作成功",color:"success"}),x("refresh")),t.loading=!1}const M=async()=>{const{data:u}=await X();w.value=(u?.list||[]).map(e=>({label:e.name,value:e.id}))};return te(()=>p.dialog,u=>{u&&(t.loading=!1,t.form=p.currentForm,M())}),(u,e)=>{const _=L,g=j,m=N,h=z,R=Q,C=W,$=k,B=G;return F(),le(B,{open:a(f),"onUpdate:open":e[15]||(e[15]=o=>oe(f)?f.value=o:null),ui:{footer:"justify-end",content:"sm:max-w-2xl"}},{header:r(()=>[i("div",de,[l(_,{name:"i-lucide-credit-card",class:"w-5 h-5 text-(--ui-primary)"}),i("span",ue,ae(s.currentForm.id?"编辑支付通道":"新增支付通道"),1)])]),body:r(()=>[l(C,{ref_key:"formRef",ref:b,state:a(t).form,class:"space-y-5",onSubmit:D},{default:r(()=>[i("div",ce,[i("div",pe,[l(_,{name:"i-lucide-info",class:"w-4 h-4 text-(--ui-primary)"}),e[16]||(e[16]=i("span",{class:"text-sm font-medium text-(--ui-text-highlighted)"},"基本信息",-1))]),l(m,{label:"通道名称",name:"name",required:""},{default:r(()=>[l(g,{modelValue:a(t).form.name,"onUpdate:modelValue":e[0]||(e[0]=o=>a(t).form.name=o),modelModifiers:{trim:!0},placeholder:"请输入通道名称",class:"w-full"},null,8,["modelValue"])]),_:1}),i("div",fe,[l(m,{label:"支付类型",name:"ty",required:""},{default:r(()=>[l(h,{modelValue:a(t).form.ty,"onUpdate:modelValue":e[1]||(e[1]=o=>a(t).form.ty=o),items:a(w),placeholder:"请选择",class:"w-full"},null,8,["modelValue","items"])]),_:1}),l(m,{label:"状态",name:"state",required:""},{default:r(()=>[l(h,{modelValue:a(t).form.state,"onUpdate:modelValue":e[2]||(e[2]=o=>a(t).form.state=o),items:v,placeholder:"请选择",class:"w-full"},null,8,["modelValue"])]),_:1})])]),i("div",ge,[i("div",_e,[l(_,{name:"i-lucide-key",class:"w-4 h-4 text-(--ui-warning)"}),e[17]||(e[17]=i("span",{class:"text-sm font-medium text-(--ui-text-highlighted)"},"商户配置",-1))]),l(m,{label:"商户ID",name:"mch_id",required:""},{default:r(()=>[l(g,{modelValue:a(t).form.mch_id,"onUpdate:modelValue":e[3]||(e[3]=o=>a(t).form.mch_id=o),modelModifiers:{trim:!0},placeholder:"请输入商户ID",class:"w-full"},null,8,["modelValue"])]),_:1}),i("div",xe,[l(m,{label:"App Key",name:"app_key",required:""},{default:r(()=>[l(g,{modelValue:a(t).form.app_key,"onUpdate:modelValue":e[4]||(e[4]=o=>a(t).form.app_key=o),modelModifiers:{trim:!0},placeholder:"请输入",class:"w-full"},null,8,["modelValue"])]),_:1}),l(m,{label:"密钥",name:"secret",required:""},{default:r(()=>[l(g,{modelValue:a(t).form.secret,"onUpdate:modelValue":e[5]||(e[5]=o=>a(t).form.secret=o),modelModifiers:{trim:!0},placeholder:"请输入",class:"w-full"},null,8,["modelValue"])]),_:1})]),l(m,{label:"签名方式",name:"sign_ty",required:""},{default:r(()=>[l(h,{modelValue:a(t).form.sign_ty,"onUpdate:modelValue":e[6]||(e[6]=o=>a(t).form.sign_ty=o),items:d,placeholder:"请选择",class:"w-full"},null,8,["modelValue"])]),_:1})]),i("div",ye,[i("div",be,[l(_,{name:"i-lucide-link",class:"w-4 h-4 text-(--ui-info)"}),e[18]||(e[18]=i("span",{class:"text-sm font-medium text-(--ui-text-highlighted)"},"支付配置",-1))]),l(m,{label:"下单地址",name:"place_uri",required:""},{default:r(()=>[l(g,{modelValue:a(t).form.place_uri,"onUpdate:modelValue":e[7]||(e[7]=o=>a(t).form.place_uri=o),modelModifiers:{trim:!0},placeholder:"请输入下单API地址",class:"w-full"},null,8,["modelValue"])]),_:1}),i("div",we,[l(m,{label:"支付标识",name:"f",required:""},{default:r(()=>[l(g,{modelValue:a(t).form.f,"onUpdate:modelValue":e[8]||(e[8]=o=>a(t).form.f=o),modelModifiers:{trim:!0},placeholder:"请输入",class:"w-full",disabled:!!s.currentForm.id},null,8,["modelValue","disabled"])]),_:1}),l(m,{label:"支付编码",name:"code",required:""},{default:r(()=>[l(g,{modelValue:a(t).form.code,"onUpdate:modelValue":e[9]||(e[9]=o=>a(t).form.code=o),modelModifiers:{trim:!0},placeholder:"请输入",class:"w-full"},null,8,["modelValue"])]),_:1})])]),i("div",he,[i("div",ve,[l(_,{name:"i-lucide-coins",class:"w-4 h-4 text-(--ui-warning)"}),e[19]||(e[19]=i("span",{class:"text-sm font-medium text-(--ui-text-highlighted)"},"金额限制",-1))]),i("div",Ve,[l(m,{label:"限制类型",name:"limit_type"},{default:r(()=>[l(h,{modelValue:a(t).form.limit_type,"onUpdate:modelValue":e[10]||(e[10]=o=>a(t).form.limit_type=o),items:V,placeholder:"请选择",class:"w-full"},null,8,["modelValue"])]),_:1}),l(m,{label:"支付权重",name:"weights",required:""},{default:r(()=>[l(g,{modelValue:a(t).form.weights,"onUpdate:modelValue":e[11]||(e[11]=o=>a(t).form.weights=o),modelModifiers:{trim:!0},placeholder:"数值越大优先级越高",class:"w-full",type:"number",min:"0",max:"99"},null,8,["modelValue"])]),_:1})]),l(m,{label:"金额范围",name:"limit",required:"",description:"格式：最小金额-最大金额，如：1-10000"},{default:r(()=>[l(g,{modelValue:a(t).form.limit,"onUpdate:modelValue":e[12]||(e[12]=o=>a(t).form.limit=o),modelModifiers:{trim:!0},placeholder:"例如：1-10000",class:"w-full"},null,8,["modelValue"])]),_:1})]),i("div",Ue,[i("div",De,[l(_,{name:"i-lucide-file-text",class:"w-4 h-4 text-(--ui-text-muted)"}),e[20]||(e[20]=i("span",{class:"text-sm font-medium text-(--ui-text-highlighted)"},"备注信息",-1))]),l(m,{label:"备注",name:"remark"},{default:r(()=>[l(R,{modelValue:a(t).form.remark,"onUpdate:modelValue":e[13]||(e[13]=o=>a(t).form.remark=o),modelModifiers:{trim:!0},placeholder:"请输入备注信息",class:"w-full",rows:3},null,8,["modelValue"])]),_:1})])]),_:1},8,["state"])]),footer:r(()=>[l($,{label:"取消",color:"neutral",variant:"outline",onClick:y}),l($,{loading:a(t).loading,label:"确认",variant:"solid",onClick:e[14]||(e[14]=o=>a(b)?.submit())},null,8,["loading"])]),_:1},8,["open"])}}}),Te=Object.assign(Me,{__name:"PaymentTypeEdit"}),ke={2:["正常","success"],4:["删除","error"],0:["待审核","warning"]},$e={1:["支付宝","info"],2:["微信","success"],3:["USDT","warning"],4:["自建","neutral"]},qe={1:"MD5-方式1",2:"MD5-方式2",3:"MD5-方式3",4:"MD5-方式4",5:"MD5-方式5"},Ke={1:["固定金额","info"],2:["范围金额","warning"]},Fe=[{accessorKey:"id",header:"ID",meta:{class:{th:"w-[60px]",td:"w-[60px]"}},cell:({row:s})=>n("span",{class:"font-mono text-sm"},s.original.id)},{accessorKey:"name",header:"名称",searchPlaceholder:"筛选名称",meta:{class:{th:"w-[200px]",td:"w-[200px]"}},cell:({row:s})=>n("span",{class:"font-medium truncate"},s.original.name||"-")},{accessorKey:"code",header:"编码",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},cell:({row:s})=>n("code",{class:"text-xs"},s.original.code||"-")},{accessorKey:"ty",header:"类型",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},cell:({row:s})=>{const[c,p]=$e[s.original.ty]||["未知","neutral"];return n(T,{variant:"subtle",color:p},()=>c)}},{accessorKey:"mch_id",header:"商户号",meta:{class:{th:"w-[100px]",td:"w-[100px]"}},cell:({row:s})=>n("span",{class:"text-sm"},s.original.mch_id||"-")},{accessorKey:"sign_ty",header:"签名方式",meta:{class:{th:"w-[100px]",td:"w-[100px]"}},cell:({row:s})=>n("span",{class:"text-sm"},qe[s.original.sign_ty]||"-")},{accessorKey:"limit_type",header:"限制类型",meta:{class:{th:"w-[90px]",td:"w-[90px]"}},cell:({row:s})=>{const[c,p]=Ke[s.original.limit_type]||["未知","neutral"];return n(T,{variant:"subtle",color:p},()=>c)}},{accessorKey:"limit",header:"限额",meta:{class:{th:"w-[100px]",td:"w-[100px]"}},cell:({row:s})=>n("span",{class:"text-sm"},s.original.limit||"-")},{accessorKey:"weights",header:"权重",meta:{class:{th:"w-[60px]",td:"w-[60px]"}},cell:({row:s})=>n("span",{class:"text-sm font-medium"},s.original.weights??"-")},{accessorKey:"f",header:"标识",meta:{class:{th:"w-[60px]",td:"w-[60px]"}},cell:({row:s})=>n("span",{class:"text-sm"},s.original.f||"-")},{accessorKey:"state",header:"状态",meta:{class:{th:"w-[70px]",td:"w-[70px]"}},cell:({row:s})=>{const[c,p]=ke[s.original.state]||["未知","neutral"];return n(T,{variant:"subtle",color:p},()=>c)}},{accessorKey:"updated_at",header:"更新时间",meta:{class:{th:"w-[160px]",td:"w-[160px]"}},cell:({row:s})=>n("span",{class:"text-sm text-(--ui-text-muted)"},ne(s.original.updated_at))}],ft=K({name:"PaymentTypeList",__name:"type-list",setup(s){const c=P(),p=k,x=me(),f=E({isDialog:!1,currentForm:{}}),y=d=>{f.currentForm=d?q(d):{state:2,limit_type:1},f.isDialog=!0},b=()=>{c.value?.reload(),f.isDialog=!1},v=d=>{x.open({color:"error",title:"删除通道",description:`确定要删除「${d.name}」吗？`,onPositiveClick:async()=>{const{error:t}=await Z({id:d.id});t||c.value?.reload()}})};function w(d){return[{label:"编辑",icon:"i-lucide-pencil",onSelect(){y(d.original)}},{type:"separator"},{label:"删除",icon:"i-lucide-trash-2",color:"error",onSelect(){v(d.original)}}]}const V=[...Fe,{id:"actions",header:"操作",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},cell:({row:d})=>n("div",{class:"text-right"},n(I,{content:{align:"end"},items:w(d)},()=>n(k,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost",class:"ml-auto"})))}];return(d,t)=>{const U=O,D=A,M=Te;return F(),ie(re,null,[l(D,null,{actions:r(()=>[l(a(p),{label:"新增",icon:"i-lucide-plus",color:"neutral",onClick:t[0]||(t[0]=u=>y())})]),default:r(()=>[l(U,{ref_key:"tableRef",ref:c,"data-request":a(Y),columns:V,"scroll-x":"min-w-[1500px]"},null,8,["data-request"])]),_:1}),l(M,{dialog:a(f).isDialog,"onUpdate:dialog":t[1]||(t[1]=u=>a(f).isDialog=u),"current-form":a(f).currentForm,onRefresh:b},null,8,["dialog","current-form"])],64)}}});export{ft as default};
