import{f as q,c as O,ap as D,i as G,j as I,aE as P,l as S,a as A,o as w,w as t,D as i,B as e,E as h,I as J,F as V,_ as H,b as s,k as K,C as Q,aq as W,a4 as X,aT as Y,aU as Z}from"./DhOLkSnF.js";import{_ as ee}from"./DAeRr84W.js";import{_ as ae}from"./DAIKkUkW.js";import{_ as le}from"./D0vBe5Vh.js";import{_ as se}from"./CVanS2c1.js";import{_ as te}from"./Db__RPjw.js";import{_ as oe}from"./BZLiX_8y.js";import{f as ie}from"./CzWoDhk-.js";import{c as k}from"./45RcOEEf.js";import{o as re,n as ne,s as _}from"./B-mCBPct.js";const me={class:"p-6"},de={class:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-5"},ue={class:"flex items-center gap-2 mb-4"},fe={class:"flex items-center gap-4"},ce={class:"relative group"},pe={key:0,class:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity rounded-full flex items-center justify-center"},ge={class:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-5 space-y-5"},_e={class:"flex items-center gap-2 mb-1"},be={class:"grid grid-cols-2 gap-4"},ye={class:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-5 space-y-5"},ve={class:"flex items-center gap-2 mb-1"},xe={class:"flex items-center justify-between w-full"},we={class:"text-sm text-gray-500 dark:text-gray-400"},he={class:"flex gap-3"},Ve=q({__name:"Edit",props:{dialog:{type:Boolean,default:!1},currentForm:{default:()=>({})}},emits:["update:dialog","refresh"],setup(u,{emit:U}){const f=u,b=U,d=O({get(){return f.dialog},set(m){b("update:dialog",m)}}),F=()=>{d.value=!1},y=D("formRef"),v=G(),z=re({username:_(),remarks:_(),birthday:_(),state:ne().min(0)}),M=[{label:"启用",value:2},{label:"待审核",value:1},{label:"已删除",value:4}],C=[{label:"保密",value:0},{label:"男",value:1},{label:"女",value:2}],$=[{label:"否",value:0},{label:"是",value:2}],l=I({loading:!1,avatarLoading:!1,form:{}});async function j(m){const a=m.target;if(a.files?.length&&Y(a.files[0])){l.avatarLoading=!0;const{data:r}=await Z({image:a.files[0]});r&&(l.form.avatar=r.uri),l.avatarLoading=!1}}function B(){v.value?.click()}const T=P();async function R(){l.loading=!0;const m=k(l.form),{error:a}=await ie(m);a||(T.add({title:"操作成功",color:"success"}),b("refresh")),l.loading=!1}return S(()=>f.dialog,m=>{m&&(l.loading=!1,l.form=k(f.currentForm))}),(m,a)=>{const r=J,E=W,c=H,n=ee,p=ae,g=le,x=se,L=te,N=oe;return w(),A(N,{open:s(d),"onUpdate:open":a[9]||(a[9]=o=>X(d)?d.value=o:null),title:u.currentForm.id?"编辑客户":"新增客户",dismissible:!1,ui:{content:"sm:max-w-2xl",body:"p-0",footer:"justify-end bg-gray-50 dark:bg-gray-900"}},{body:t(()=>[i("div",me,[e(L,{ref_key:"formRef",ref:y,schema:s(z),state:s(l).form,class:"space-y-6",onSubmit:R},{default:t(()=>[i("div",de,[i("div",ue,[e(r,{name:"i-material-symbols-image-outline",class:"w-5 h-5 text-primary-600"}),a[10]||(a[10]=i("h4",{class:"font-semibold text-gray-900 dark:text-white"}," 头像设置 ",-1))]),e(n,{name:"avatar",description:"JPG, JPEG or PNG. 1MB Max."},{default:t(()=>[i("div",fe,[i("div",ce,[e(E,{src:s(l).form.avatar,alt:s(l).form.username,size:"2xl",class:"ring-2 ring-gray-200 dark:ring-gray-700"},null,8,["src","alt"]),s(l).form.avatar?(w(),K("div",pe,[e(r,{name:"i-material-symbols-edit",class:"w-6 h-6 text-white"})])):Q("",!0)]),i("div",null,[e(c,{loading:s(l).avatarLoading,color:"primary",variant:"outline",size:"lg",onClick:B},{leading:t(()=>[e(r,{name:"i-material-symbols-upload"})]),default:t(()=>[h(" "+V(s(l).form.avatar?"更换头像":"上传头像"),1)]),_:1},8,["loading"]),i("input",{ref_key:"fileRef",ref:v,type:"file",class:"hidden",accept:".jpg, .jpeg, .png",onChange:j},null,544)])])]),_:1})]),i("div",ge,[i("div",_e,[e(r,{name:"i-material-symbols-info-outline",class:"w-5 h-5 text-primary-600"}),a[11]||(a[11]=i("h4",{class:"font-semibold text-gray-900 dark:text-white"}," 基本信息 ",-1))]),e(n,{label:"客户昵称",name:"username",required:""},{default:t(()=>[e(p,{modelValue:s(l).form.username,"onUpdate:modelValue":a[0]||(a[0]=o=>s(l).form.username=o),modelModifiers:{trim:!0},placeholder:"请输入客户昵称",class:"w-full",size:"lg"},{leading:t(()=>[e(r,{name:"i-material-symbols-person-outline",class:"w-5 h-5 text-gray-400"})]),_:1},8,["modelValue"])]),_:1}),i("div",be,[e(n,{label:"性别",name:"sex",required:""},{default:t(()=>[e(g,{modelValue:s(l).form.sex,"onUpdate:modelValue":a[1]||(a[1]=o=>s(l).form.sex=o),items:C,placeholder:"请选择性别",class:"w-full",size:"lg"},null,8,["modelValue"])]),_:1}),e(n,{label:"等级",name:"lv"},{default:t(()=>[e(p,{modelValue:s(l).form.lv,"onUpdate:modelValue":a[2]||(a[2]=o=>s(l).form.lv=o),modelModifiers:{number:!0},placeholder:"请输入等级",class:"w-full",type:"number",size:"lg"},{leading:t(()=>[e(r,{name:"i-material-symbols-star-outline",class:"w-5 h-5 text-gray-400"})]),_:1},8,["modelValue"])]),_:1})]),e(n,{label:"备注",name:"remarks"},{default:t(()=>[e(p,{modelValue:s(l).form.remarks,"onUpdate:modelValue":a[3]||(a[3]=o=>s(l).form.remarks=o),modelModifiers:{trim:!0},placeholder:"请输入备注信息",class:"w-full",size:"lg"},{leading:t(()=>[e(r,{name:"i-material-symbols-note-outline",class:"w-5 h-5 text-gray-400"})]),_:1},8,["modelValue"])]),_:1}),e(n,{label:"状态",name:"state",required:""},{default:t(()=>[e(g,{modelValue:s(l).form.state,"onUpdate:modelValue":a[4]||(a[4]=o=>s(l).form.state=o),items:M,placeholder:"请选择状态",class:"w-full",size:"lg"},null,8,["modelValue"])]),_:1}),e(n,{label:"官方号",name:"is_admin"},{default:t(()=>[e(g,{modelValue:s(l).form.is_admin,"onUpdate:modelValue":a[5]||(a[5]=o=>s(l).form.is_admin=o),items:$,placeholder:"请选择是否为官方号",class:"w-full",size:"lg"},{leading:t(()=>[e(r,{name:"i-material-symbols-verified",class:"w-5 h-5 text-orange-500"})]),_:1},8,["modelValue"])]),_:1})]),i("div",ye,[i("div",ve,[e(r,{name:"i-material-symbols-description-outline",class:"w-5 h-5 text-primary-600"}),a[12]||(a[12]=i("h4",{class:"font-semibold text-gray-900 dark:text-white"}," 详细信息 ",-1))]),e(n,{label:"简介",name:"summary"},{default:t(()=>[e(x,{modelValue:s(l).form.summary,"onUpdate:modelValue":a[6]||(a[6]=o=>s(l).form.summary=o),modelModifiers:{trim:!0},placeholder:"请输入个人简介...",class:"w-full",rows:3,size:"lg"},null,8,["modelValue"])]),_:1}),e(n,{label:"爱好",name:"fetish"},{default:t(()=>[e(x,{modelValue:s(l).form.fetish,"onUpdate:modelValue":a[7]||(a[7]=o=>s(l).form.fetish=o),modelModifiers:{trim:!0},placeholder:"请输入个人爱好...",class:"w-full",rows:3,size:"lg"},null,8,["modelValue"])]),_:1})])]),_:1},8,["schema","state"])])]),footer:t(()=>[i("div",xe,[i("div",we,[e(r,{name:"i-material-symbols-info-outline",class:"inline w-4 h-4"}),h(" "+V(u.currentForm.id?"修改后将更新客户信息":"确认后将创建新客户"),1)]),i("div",he,[e(c,{label:"取消",color:"neutral",variant:"outline",size:"lg",onClick:F},{leading:t(()=>[e(r,{name:"i-material-symbols-close"})]),_:1}),e(c,{loading:s(l).loading,label:"确认保存",variant:"solid",size:"lg",onClick:a[8]||(a[8]=o=>s(y)?.submit())},{leading:t(()=>[e(r,{name:"i-material-symbols-check"})]),_:1},8,["loading"])])])]),_:1},8,["open","title"])}}}),Re=Object.assign(Ve,{__name:"MemberListEdit"});export{Re as _};
