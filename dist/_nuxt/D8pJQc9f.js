import{_ as Q}from"./1OJ4jHSB.js";import{w as W,_ as A,a as T}from"./DiI9-bkE.js";import{_ as G}from"./Odvr87Pg.js";import{_ as H}from"./CuFgEFCp.js";import{_ as X}from"./oJBVUttf.js";import{_ as Y}from"./BdKneTYw.js";import{_ as Z}from"./BkseHKFx.js";import{_ as L}from"./Bml5z8l2.js";import{_ as ee}from"./_BOBmhmt.js";import{_ as te}from"./9B_i7pfW.js";import{_ as oe}from"./8gEztUrL.js";import{e as se,f as ae,d as E,h as ne}from"./DXr9T7Lu.js";import{c as R}from"./B3KMLFeu.js";import{p as j,ai as le,w as re,z as b,a1 as I,a2 as m,a7 as t,u as a,Q as s,i as B,a6 as U,a5 as ie,R as S,A as k,W as K,ah as me,c as M,r as N,E as c,h as ce}from"./Cp_GvCOL.js";import{f as de}from"./CE7u-7DH.js";import{u as ue}from"./BCMcqMGM.js";import"./D7PB4JkZ.js";import"./C-fFc4Sm.js";import"./DnWsfCtc.js";import"./C6Y-ieo6.js";import"./De6cJ90F.js";import"./BrwH2_O0.js";import"./7ga_NNx6.js";import"./BHtpJmxp.js";import"./BlLzDdHJ.js";import"./CM1DIlR0.js";import"./DkYr1hfb.js";import"./DZaB2s8a.js";import"./K6pfE6CB.js";import"./B9BvCEkO.js";import"./DxT_AjaP.js";import"./DaMwIZ4f.js";import"./BnfZ4xmv.js";import"./CangPKqO.js";import"./C8Jf-TuN.js";import"./DVCf4JVd.js";import"./_eNQqsN0.js";const pe={class:"flex items-center gap-2"},fe={class:"font-semibold"},_e={class:"p-4 rounded-lg bg-(--ui-bg-elevated) border border-(--ui-border) space-y-4"},ge={class:"flex items-center gap-2"},xe={class:"flex items-center gap-4"},be={class:"flex items-center h-9"},ye={class:"ml-2 text-sm"},he={class:"grid grid-cols-2 gap-4"},ve={class:"p-4 rounded-lg bg-(--ui-bg-elevated) border border-(--ui-border) space-y-4"},we={class:"flex items-center justify-between"},Ve={class:"flex items-center gap-2"},Ce={class:"space-y-3"},Ue={class:"flex items-center justify-between mb-3"},Le={class:"flex items-center gap-2"},ke={class:"w-6 h-6 rounded-full bg-(--ui-primary)/10 flex items-center justify-center"},$e={class:"text-xs font-medium text-(--ui-primary)"},De={class:"space-y-3"},Fe={class:"grid grid-cols-2 gap-3"},Ae={key:0,class:"py-8 text-center"},Re=j({__name:"Edit",props:{dialog:{type:Boolean,default:!1},currentForm:{default:()=>({})}},emits:["update:dialog","refresh"],setup(r,{emit:d}){const y=r,w=d,i=M({get:()=>y.dialog,set:n=>w("update:dialog",n)}),h=()=>{i.value=!1},V=le("formRef"),$=W(),g=M({get:()=>o.form.state===1,set:n=>{o.form.state=n?1:4}}),o=N({loading:!1,form:{name:"",rating:0,hint:"",state:1,contentList:[]}}),u=()=>{const n=o.form.contentList.length+1;o.form.contentList.push({id:n,name:"",content:"",sort:n})},f=n=>{o.form.contentList.splice(n,1),o.form.contentList.forEach((e,p)=>{e.id=p+1})};async function D(){o.loading=!0;const n=R(o.form);n.content=JSON.stringify(n.contentList),delete n.contentList;const{error:e}=await(n.id?se:ae)(n);e||($.add({title:"操作成功",color:"success"}),h(),w("refresh")),o.loading=!1}return re(()=>y.dialog,n=>{if(n){o.loading=!1;const e=R(y.currentForm);if(e.content)try{const p=JSON.parse(e.content);e.contentList=Array.isArray(p)?p:[]}catch{e.contentList=[]}else e.contentList=[];o.form=e}}),(n,e)=>{const p=T,v=X,_=Y,z=Z,P=L,C=A,q=ee,O=te,J=oe;return b(),I(J,{open:a(i),"onUpdate:open":e[5]||(e[5]=l=>B(i)?i.value=l:null),ui:{content:"sm:max-w-4xl",footer:"justify-end"}},{header:m(()=>[s("div",pe,[t(p,{name:"i-lucide-folder",class:"w-5 h-5 text-(--ui-primary)"}),s("span",fe,U(r.currentForm.id?"编辑分类":"新增分类"),1)])]),body:m(()=>[t(O,{ref_key:"formRef",ref:V,state:a(o).form,class:"space-y-4",onSubmit:D},{default:m(()=>[s("div",_e,[s("div",ge,[t(p,{name:"i-lucide-info",class:"w-4 h-4 text-(--ui-primary)"}),e[6]||(e[6]=s("span",{class:"text-sm font-medium"},"基本信息",-1))]),s("div",xe,[t(_,{label:"分类名称",name:"name",required:"",class:"flex-1"},{default:m(()=>[t(v,{modelValue:a(o).form.name,"onUpdate:modelValue":e[0]||(e[0]=l=>a(o).form.name=l),modelModifiers:{trim:!0},placeholder:"请输入分类名称",class:"w-full"},null,8,["modelValue"])]),_:1}),t(_,{label:"启用"},{default:m(()=>[s("div",be,[t(z,{modelValue:a(g),"onUpdate:modelValue":e[1]||(e[1]=l=>B(g)?g.value=l:null)},null,8,["modelValue"]),s("span",ye,U(a(g)?"启用":"关闭"),1)])]),_:1})]),s("div",he,[t(_,{label:"可评分值",name:"rating"},{default:m(()=>[t(v,{modelValue:a(o).form.rating,"onUpdate:modelValue":e[2]||(e[2]=l=>a(o).form.rating=l),modelModifiers:{number:!0},type:"number",placeholder:"请输入",class:"w-full"},null,8,["modelValue"])]),_:1}),t(_,{label:"提示限制",name:"hint"},{default:m(()=>[t(v,{modelValue:a(o).form.hint,"onUpdate:modelValue":e[3]||(e[3]=l=>a(o).form.hint=l),modelModifiers:{number:!0},type:"number",min:"0",placeholder:"请输入",class:"w-full"},null,8,["modelValue"])]),_:1})])]),s("div",ve,[s("div",we,[s("div",Ve,[t(p,{name:"i-lucide-file-text",class:"w-4 h-4 text-(--ui-primary)"}),e[7]||(e[7]=s("span",{class:"text-sm font-medium"},"内容配置",-1)),a(o).form.contentList?.length?(b(),I(P,{key:0,size:"xs",color:"primary"},{default:m(()=>[ie(U(a(o).form.contentList.length),1)]),_:1})):S("",!0)]),t(C,{size:"xs",icon:"i-lucide-plus",label:"添加",onClick:u})]),s("div",Ce,[(b(!0),k(K,null,me(a(o).form.contentList,(l,F)=>(b(),k("div",{key:F,class:"p-4 rounded-lg bg-(--ui-bg) border border-(--ui-border)"},[s("div",Ue,[s("div",Le,[s("div",ke,[s("span",$e,U(F+1),1)]),e[8]||(e[8]=s("span",{class:"text-sm font-medium"},"内容项",-1))]),t(C,{icon:"i-lucide-trash-2",size:"xs",color:"error",variant:"ghost",onClick:x=>f(F)},null,8,["onClick"])]),s("div",De,[s("div",Fe,[t(_,{label:"内容名称"},{default:m(()=>[t(v,{modelValue:l.name,"onUpdate:modelValue":x=>l.name=x,modelModifiers:{trim:!0},placeholder:"请输入内容名称",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),t(_,{label:"排序"},{default:m(()=>[t(v,{modelValue:l.sort,"onUpdate:modelValue":x=>l.sort=x,modelModifiers:{number:!0},type:"number",placeholder:"请输入排序值",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),t(_,{label:"内容描述"},{default:m(()=>[t(q,{modelValue:l.content,"onUpdate:modelValue":x=>l.content=x,rows:4,placeholder:"请输入内容描述",class:"w-full"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)])]))),128))]),a(o).form.contentList?.length?S("",!0):(b(),k("div",Ae,[t(p,{name:"i-lucide-file-text",class:"w-10 h-10 mx-auto mb-2 text-(--ui-text-dimmed)"}),e[9]||(e[9]=s("p",{class:"text-sm text-(--ui-text-muted)"}," 暂无内容项，点击上方添加 ",-1))]))])]),_:1},8,["state"])]),footer:m(()=>[t(C,{label:"取消",color:"neutral",variant:"outline",onClick:h}),t(C,{loading:a(o).loading,label:"确认",onClick:e[4]||(e[4]=l=>a(V)?.submit())},null,8,["loading"])]),_:1},8,["open"])}}}),Ee=Object.assign(Re,{__name:"AmusementCategoryEdit"}),Ie={1:["启用","success"],2:["待审核","warning"],4:["已删除","error"]},Be=[{accessorKey:"id",header:"ID",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},cell:({row:r})=>c("span",{class:"font-mono text-sm text-(--ui-text-muted)"},r.original.id)},{accessorKey:"name",header:"分类名称",searchPlaceholder:"分类名称",meta:{class:{th:"w-[180px]",td:"w-[180px]"}},cell:({row:r})=>c("div",{class:"flex items-center gap-2"},[c("div",{class:"w-7 h-7 rounded-lg flex items-center justify-center bg-primary-500/10"},[c(T,{name:"i-lucide-folder",class:"w-4 h-4 text-primary-500"})]),c("span",{class:"font-medium"},r.original.name||"-")])},{accessorKey:"rating",header:"可评分值",meta:{class:{th:"w-[100px]",td:"w-[100px]"}},cell:({row:r})=>c(L,{variant:"subtle",color:"info"},()=>r.original.rating)},{accessorKey:"hint",header:"提示限制",meta:{class:{th:"w-[100px]",td:"w-[100px]"}},cell:({row:r})=>c(L,{variant:"subtle",color:"primary"},()=>r.original.hint)},{accessorKey:"created_at",header:"创建时间",meta:{class:{th:"w-[160px]",td:"w-[160px]"}},cell:({row:r})=>{const d=r.original.created_at;return d?c("span",{class:"text-xs text-(--ui-text-muted)"},de(d)):c("span",{class:"text-(--ui-text-muted)"},"-")}},{accessorKey:"state",header:"状态",searchPlaceholder:"筛选状态",meta:{class:{th:"w-[100px]",td:"w-[100px]"}},formItemProps:{component:"Select",componentProps:{options:[{label:"启用",value:1},{label:"待审核",value:2},{label:"已删除",value:4}]}},cell:({row:r})=>{const d=Ie[r.original.state];return d?c(L,{variant:"subtle",color:d[1]},()=>d[0]):c("span",{class:"text-(--ui-text-muted)"},"-")}}],yt=j({name:"AmusementCategoryList",__name:"category",setup(r){const d=ce(),y=A,w=ue(),i=N({isDialog:!1,currentForm:{},totalCount:0}),h=async u=>{if(i.isDialog=!0,u)i.currentForm=R(u);else{const{data:f}=await E({page:1,pagesize:1});i.totalCount=f?.count||0,i.currentForm={state:2}}},V=async()=>{d.value.reload(),i.isDialog=!1},$=async u=>{const{error:f}=await ne({id:u.id});f||d.value.reload()};function g(u){return[{label:"编辑",icon:"material-symbols:edit-square-outline",onSelect(){h(u.original)}},{type:"separator"},{label:"删除",icon:"material-symbols:contract-delete-outline-rounded",color:"error",onSelect(){w.open({color:"error",title:"删除数据",description:"您确定要删除吗？",onPositiveClick(){$(u.original)}})}}]}const o=[...Be,{id:"actions",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},cell:({row:u})=>c("div",{class:"text-right"},c(Q,{content:{align:"end"},items:g(u)},()=>c(A,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost",class:"ml-auto"})))}];return(u,f)=>{const D=G,n=H,e=Ee;return b(),k(K,null,[t(n,null,{actions:m(()=>[t(a(y),{label:"新增",icon:"i-lucide-plus",color:"neutral",onClick:f[0]||(f[0]=p=>h(null))})]),default:m(()=>[t(D,{ref_key:"tableRef",ref:d,"data-request":a(E),columns:o,"scroll-x":"min-w-[1000px]"},null,8,["data-request"])]),_:1}),t(e,{dialog:a(i).isDialog,"onUpdate:dialog":f[1]||(f[1]=p=>a(i).isDialog=p),"current-form":a(i).currentForm,"total-count":a(i).totalCount,onRefresh:V},null,8,["dialog","current-form","total-count"])],64)}}});export{yt as default};
