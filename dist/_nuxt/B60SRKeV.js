import{_ as E}from"./CEcF5dWm.js";import{f as K,c as S,ap as j,j as M,aE as z,l as P,a as b,o as u,w as r,B as a,_ as k,b as o,C as g,a4 as I,aF as v,i as N,k as B,A as L,D as A,G as O}from"./DhOLkSnF.js";import{_ as G,a as H,b as J,c as Q}from"./DAqc9GYg.js";import{_ as W}from"./CSbqei5V.js";import{_ as X}from"./DAIKkUkW.js";import{_ as Y}from"./DAeRr84W.js";import{_ as Z}from"./D0vBe5Vh.js";import{_ as ee}from"./Db__RPjw.js";import{_ as oe}from"./BZLiX_8y.js";import{f as te,h as ae,i as ne,j as le}from"./D1QVHQma.js";import{c as q}from"./45RcOEEf.js";import{o as re,n as D,s as R}from"./B-mCBPct.js";import{u as se,b as ie}from"./Bo5OMT4U.js";import{_ as me}from"./-rcGzxkB.js";import{f as ce}from"./BmKy9gZZ.js";import{u as ue}from"./BVQSm7Ip.js";import"./CZg69nbc.js";import"./CwtpYSSp.js";import"./DPsBupTg.js";import"./9Rxep3Q5.js";import"./CLKxJTZi.js";import"./HRiyi1uV.js";import"./BrXYpapi.js";import"./BXSyqGa5.js";const de=K({__name:"Edit",props:{dialog:{type:Boolean,default:!1},currentForm:{default:()=>({})}},emits:["update:dialog","refresh"],setup(m,{emit:F}){const p=m,_=F,d=S({get(){return p.dialog},set(l){_("update:dialog",l)}}),C=()=>{d.value=!1},s=j("formRef"),y=re({title:R().nonempty(),content:R().nonempty(),coins:D().min(0),amount:D().min(0),state:D().min(0)}),x=[{label:"启用",value:2},{label:"已删除",value:1}],t=M({loading:!1,avatarLoading:!1,form:{}}),V=z();async function w(){t.loading=!0;const l=q(t.form);console.log("postForm",l);const{error:e}=await(l.id?te:ae)(l);e||(V.add({title:"操作成功",color:"success"}),_("refresh")),t.loading=!1}return P(()=>p.dialog,l=>{l&&(t.loading=!1,t.form=p.currentForm)}),(l,e)=>{const i=k,f=X,c=Y,$=Z,U=ee,h=oe;return u(),b(h,{open:o(d),"onUpdate:open":e[12]||(e[12]=n=>I(d)?d.value=n:null),title:m.currentForm.id?"修改":"新增",dismissible:!1,ui:{footer:"justify-end"}},{body:r(()=>[a(U,{ref_key:"formRef",ref:s,schema:o(y),state:o(t).form,class:"flex flex-col gap-4",onSubmit:w},{default:r(()=>[a(c,{label:"标题",name:"title",required:""},{default:r(()=>[a(f,{modelValue:o(t).form.title,"onUpdate:modelValue":e[1]||(e[1]=n=>o(t).form.title=n),modelModifiers:{trim:!0},placeholder:"请输入",class:"w-full",ui:{trailing:"pe-1"}},{trailing:r(()=>[o(t).form.title?(u(),b(i,{key:0,color:"neutral",variant:"link",size:"sm",icon:"i-lucide-circle-x",onClick:e[0]||(e[0]=n=>o(t).form.title="")})):g("",!0)]),_:1},8,["modelValue"])]),_:1}),a(c,{label:"能量数",name:"coins",required:""},{default:r(()=>[a(f,{modelValue:o(t).form.coins,"onUpdate:modelValue":e[3]||(e[3]=n=>o(t).form.coins=n),modelModifiers:{trim:!0},placeholder:"请输入",class:"w-full",ui:{trailing:"pe-1"},type:"number",min:"0"},{trailing:r(()=>[o(t).form.coins?(u(),b(i,{key:0,color:"neutral",variant:"link",size:"sm",icon:"i-lucide-circle-x",onClick:e[2]||(e[2]=n=>o(t).form.coins="")})):g("",!0)]),_:1},8,["modelValue"])]),_:1}),a(c,{label:"原价",name:"amount",required:""},{default:r(()=>[a(f,{modelValue:o(t).form.amount,"onUpdate:modelValue":e[5]||(e[5]=n=>o(t).form.amount=n),modelModifiers:{trim:!0},placeholder:"请输入",class:"w-full",ui:{trailing:"pe-1"},type:"number",min:"0"},{trailing:r(()=>[o(t).form.amount?(u(),b(i,{key:0,color:"neutral",variant:"link",size:"sm",icon:"i-lucide-circle-x",onClick:e[4]||(e[4]=n=>o(t).form.amount="")})):g("",!0)]),_:1},8,["modelValue"])]),_:1}),a(c,{label:"排序",name:"sort"},{default:r(()=>[a(f,{modelValue:o(t).form.sort,"onUpdate:modelValue":e[7]||(e[7]=n=>o(t).form.sort=n),modelModifiers:{trim:!0},placeholder:"请输入",class:"w-full",ui:{trailing:"pe-1"}},{trailing:r(()=>[o(t).form.sort?(u(),b(i,{key:0,color:"neutral",variant:"link",size:"sm",icon:"i-lucide-circle-x",onClick:e[6]||(e[6]=n=>o(t).form.sort="")})):g("",!0)]),_:1},8,["modelValue"])]),_:1}),a(c,{label:"描述",name:"content"},{default:r(()=>[a(f,{modelValue:o(t).form.content,"onUpdate:modelValue":e[9]||(e[9]=n=>o(t).form.content=n),modelModifiers:{trim:!0},placeholder:"请输入",class:"w-full",ui:{trailing:"pe-1"}},{trailing:r(()=>[o(t).form.content?(u(),b(i,{key:0,color:"neutral",variant:"link",size:"sm",icon:"i-lucide-circle-x",onClick:e[8]||(e[8]=n=>o(t).form.content="")})):g("",!0)]),_:1},8,["modelValue"])]),_:1}),a(c,{label:"状态",name:"state",required:""},{default:r(()=>[a($,{modelValue:o(t).form.state,"onUpdate:modelValue":e[10]||(e[10]=n=>o(t).form.state=n),items:x,placeholder:"请选择",class:"w-full"},null,8,["modelValue"])]),_:1})]),_:1},8,["schema","state"])]),footer:r(()=>[a(i,{label:"取消",color:"neutral",variant:"outline",onClick:C}),a(i,{loading:o(t).loading,label:"确认",variant:"solid",onClick:e[11]||(e[11]=n=>o(s)?.submit())},null,8,["loading"])]),_:1},8,["open","title"])}}}),fe=Object.assign(de,{__name:"CommonCoinsEdit"}),T={2:["启用","success"],4:["删除","error"]},pe=[{accessorKey:"id",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},header:()=>v(k,{color:"neutral",variant:"ghost",label:"ID",class:"-mx-2.5 hover:bg-transparent focus:bg-transparent data-[state=open]:bg-transparent"})},{accessorKey:"title",searchPlaceholder:"筛选标题",header:"标题"},{accessorKey:"coins",header:"能量数"},{accessorKey:"amount",header:"原价"},{accessorKey:"sort",header:"排序"},{accessorKey:"content",header:"描述"},{accessorKey:"state",meta:{class:{th:"w-[100px]",td:"w-[80px]"}},header:"状态",formItemProps:{component:"Select",componentProps:{options:[{label:"启动",value:2},{label:"关闭",value:4}]}},cell:({row:m})=>v(me,{class:"capitalize",variant:"subtle",color:T[m.original.state]?.[1]},()=>T[m.original.state]?.[0])},{accessorKey:"updated_at",header:"更新时间",cell:({row:m})=>ce(m.original.updated_at)}],_e={key:0,class:"absolute top-0 left-0 right-0 h-(--ui-header-height) flex items-center justify-between border-b border-(--ui-border) px-4 sm:px-6 bg-(--ui-bg)"},be={class:"flex items-center gap-4"},Ie=K({name:"CoinsList",__name:"coins",setup(m){const p=se(ie).smaller("lg"),_=N(),d=k,C=ue(),s=M({isDialog:!1,currentForm:{}}),y=async l=>{s.isDialog=!0,l?s.currentForm=q(l):s.currentForm={state:2}},x=async()=>{_.value.reload(),s.isDialog=!1},t=async l=>{const{error:e}=await le({id:l.id});e||_.value.reload()};function V(l){return[{label:"编辑",icon:"material-symbols:edit-square-outline",onSelect(){y(l.original)}},{type:"separator"},{label:"删除",icon:"material-symbols:contract-delete-outline-rounded",color:"error",onSelect(){C.open({color:"error",title:"删除数据",description:"您确定要删除吗？",onPositiveClick(){t(l.original)}})}}]}const w=[...pe,{id:"actions",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},cell:({row:l})=>v("div",{class:"text-right"},v(E,{content:{align:"end"},items:V(l)},()=>v(k,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost",class:"ml-auto"})))}];return(l,e)=>{const i=H,f=G,c=J,$=W,U=Q,h=fe;return u(),B(O,null,[a(U,{ui:{body:"pb-[12px]! gap-0!"}},L({body:r(()=>[o(p)?g("",!0):(u(),B("div",_e,[A("div",be,[a(i),a(c)]),a(o(d),{label:"新增",icon:"i-lucide-plus",onClick:e[1]||(e[1]=n=>y(null))})])),a($,{ref_key:"tableRef",ref:_,"data-request":o(ne),columns:w,"scroll-x":"min-w-[1200px]"},null,8,["data-request"])]),_:2},[o(p)?{name:"header",fn:r(()=>[a(f,{title:"模型列表"},{leading:r(()=>[a(i)]),right:r(()=>[a(o(d),{label:"新增",icon:"i-lucide-plus",onClick:e[0]||(e[0]=n=>y(null))})]),_:1})]),key:"0"}:void 0]),1024),a(h,{dialog:o(s).isDialog,"onUpdate:dialog":e[2]||(e[2]=n=>o(s).isDialog=n),"current-form":o(s).currentForm,onRefresh:x},null,8,["dialog","current-form"])],64)}}});export{Ie as default};
