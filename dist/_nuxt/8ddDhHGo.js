import{_ as P}from"./CEcF5dWm.js";import{aF as b,_ as V,f as E,c as S,ap as L,j as B,aE as j,l as I,a as N,o as U,w as r,B as t,b as o,a4 as z,i as A,k as $,A as G,C as H,D as J,G as Q,ax as W}from"./DhOLkSnF.js";import{_ as X,a as Y,b as Z,c as ee}from"./DAqc9GYg.js";import{_ as oe}from"./CSbqei5V.js";import{u as ae,b as te}from"./Bo5OMT4U.js";import{_ as D}from"./-rcGzxkB.js";import{f as le}from"./BmKy9gZZ.js";import{b as se,c as re,d as ne,e as ie}from"./D1QVHQma.js";import{_ as me}from"./DAIKkUkW.js";import{_ as de}from"./DAeRr84W.js";import{_ as ue}from"./D0vBe5Vh.js";import{_ as pe}from"./Db__RPjw.js";import{_ as ce}from"./BZLiX_8y.js";import{c as K}from"./45RcOEEf.js";import{o as fe,n as F,s as y}from"./B-mCBPct.js";import"./CZg69nbc.js";import"./CwtpYSSp.js";import"./DPsBupTg.js";import"./9Rxep3Q5.js";import"./CLKxJTZi.js";import"./HRiyi1uV.js";import"./BrXYpapi.js";import"./BXSyqGa5.js";const O={2:["启用","success"],1:["关闭","error"]},q={2:["是","success"],1:["否","error"]},_e=[{accessorKey:"id",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},header:()=>b(V,{color:"neutral",variant:"ghost",label:"ID",class:"-mx-2.5 hover:bg-transparent focus:bg-transparent data-[state=open]:bg-transparent"})},{accessorKey:"name",searchPlaceholder:"筛选模型名称",header:"模型名称"},{accessorKey:"f",header:"模型标识"},{accessorKey:"m",header:"m"},{accessorKey:"description",header:"描述"},{accessorKey:"uri",header:"请求地址"},{accessorKey:"preset_name",header:"模型预设名称"},{accessorKey:"stream",header:"是否流式",formItemProps:{component:"Select",componentProps:{options:[{label:"是",value:2},{label:"否",value:1}]}},cell:({row:i})=>b(D,{class:"capitalize",variant:"subtle",color:q[i.original.stream]?.[1]},()=>q[i.original.stream]?.[0])},{accessorKey:"state",meta:{class:{th:"w-[100px]",td:"w-[80px]"}},header:"状态",formItemProps:{component:"Select",componentProps:{options:[{label:"启动",value:2},{label:"关闭",value:1}]}},cell:({row:i})=>b(D,{class:"capitalize",variant:"subtle",color:O[i.original.state]?.[1]},()=>O[i.original.state]?.[0])},{accessorKey:"updated_at",header:"更新时间",cell:({row:i})=>le(i.original.updated_at)}],be=E({__name:"Edit",props:{dialog:{type:Boolean,default:!1},currentForm:{default:()=>({})},factoryOwnerOptions:{}},emits:["update:dialog","refresh"],setup(i,{emit:C}){const f=i,g=C,c=S({get(){return f.dialog},set(d){g("update:dialog",d)}}),p=()=>{c.value=!1},u=L("formRef"),h=fe({name:y().nonempty(),f:y().nonempty(),m:y().nonempty(),key:y().nonempty(),uri:y().nonempty(),preset_id:F().min(0),state:F().min(0)}),k=[{label:"启用",value:2},{label:"关闭",value:4}],w=[{label:"是",value:2},{label:"否",value:1}],e=B({loading:!1,avatarLoading:!1,form:{},presetOptions:[],modelLoading:!1}),m=async(d=!1)=>{d&&(e.presetOptions=[]),e.modelLoading=!0,u.value?.clear("preset_id");const{data:a,error:n}=await se({});if(a){const s=[];a.list.forEach(_=>{s.push({label:_.name,value:_.id})}),e.presetOptions=s}else n&&(e.form.mark=void 0,n.code===400?u.value?.setErrors([{name:"preset_id",message:n.msg}]):n.code===401?u.value?.setErrors([{name:"type",message:n.msg}]):u.value?.setErrors([{name:"mark",message:n.msg}]));e.modelLoading=!1},v=j();async function x(){e.loading=!0;const d=K(e.form),{error:a}=await(d.id?re:ne)(d);a||(v.add({title:"操作成功",color:"success"}),g("refresh")),e.loading=!1}return I(()=>f.dialog,d=>{d&&(e.loading=!1,e.form=f.currentForm,m())}),(d,a)=>{const n=me,s=de,_=ue,R=pe,M=V,T=ce;return U(),N(T,{open:o(c),"onUpdate:open":a[11]||(a[11]=l=>z(c)?c.value=l:null),title:i.currentForm.id?"修改":"新增",dismissible:!1,ui:{footer:"justify-end"}},{body:r(()=>[t(R,{ref_key:"formRef",ref:u,schema:o(h),state:o(e).form,class:"flex flex-col gap-4",onSubmit:x},{default:r(()=>[t(s,{label:"名称",name:"name",required:""},{default:r(()=>[t(n,{modelValue:o(e).form.name,"onUpdate:modelValue":a[0]||(a[0]=l=>o(e).form.name=l),modelModifiers:{trim:!0},placeholder:"请输入",class:"w-full",ui:{trailing:"pe-1"}},null,8,["modelValue"])]),_:1}),t(s,{label:"key",name:"key",required:""},{default:r(()=>[t(n,{modelValue:o(e).form.key,"onUpdate:modelValue":a[1]||(a[1]=l=>o(e).form.key=l),modelModifiers:{trim:!0},placeholder:"请输入",class:"w-full",ui:{trailing:"pe-1"}},null,8,["modelValue"])]),_:1}),t(s,{label:"请求地址",name:"uri",required:""},{default:r(()=>[t(n,{modelValue:o(e).form.uri,"onUpdate:modelValue":a[2]||(a[2]=l=>o(e).form.uri=l),modelModifiers:{trim:!0},placeholder:"请输入",class:"w-full",ui:{trailing:"pe-1"}},null,8,["modelValue"])]),_:1}),t(s,{label:"预设类型",name:"preset_id",required:""},{default:r(()=>[t(_,{modelValue:o(e).form.preset_id,"onUpdate:modelValue":a[3]||(a[3]=l=>o(e).form.preset_id=l),items:o(e).presetOptions,placeholder:"请选择",class:"w-full",onChange:a[4]||(a[4]=l=>m(!0))},null,8,["modelValue","items"])]),_:1}),t(s,{label:"模型名称",name:"m",required:""},{default:r(()=>[t(n,{modelValue:o(e).form.m,"onUpdate:modelValue":a[5]||(a[5]=l=>o(e).form.m=l),modelModifiers:{trim:!0},placeholder:"请输入",class:"w-full",ui:{trailing:"pe-1"}},null,8,["modelValue"])]),_:1}),t(s,{label:"f",name:"f",required:""},{default:r(()=>[t(n,{modelValue:o(e).form.f,"onUpdate:modelValue":a[6]||(a[6]=l=>o(e).form.f=l),modelModifiers:{trim:!0},placeholder:"请输入",class:"w-full",ui:{trailing:"pe-1"}},null,8,["modelValue"])]),_:1}),t(s,{label:"描述",name:"description",required:""},{default:r(()=>[t(n,{modelValue:o(e).form.description,"onUpdate:modelValue":a[7]||(a[7]=l=>o(e).form.description=l),modelModifiers:{trim:!0},placeholder:"请输入",class:"w-full",ui:{trailing:"pe-1"}},null,8,["modelValue"])]),_:1}),t(s,{label:"是否流式",name:"stream",required:""},{default:r(()=>[t(_,{modelValue:o(e).form.stream,"onUpdate:modelValue":a[8]||(a[8]=l=>o(e).form.stream=l),items:w,placeholder:"请选择",class:"w-full"},null,8,["modelValue"])]),_:1}),t(s,{label:"状态",name:"state",required:""},{default:r(()=>[t(_,{modelValue:o(e).form.state,"onUpdate:modelValue":a[9]||(a[9]=l=>o(e).form.state=l),items:k,placeholder:"请选择",class:"w-full"},null,8,["modelValue"])]),_:1})]),_:1},8,["schema","state"])]),footer:r(()=>[t(M,{label:"取消",color:"neutral",variant:"outline",onClick:p}),t(M,{loading:o(e).loading,label:"确认",variant:"solid",onClick:a[10]||(a[10]=l=>o(u)?.submit())},null,8,["loading"])]),_:1},8,["open","title"])}}}),ge=Object.assign(be,{__name:"CommonModelEdit"}),ye={key:0,class:"absolute top-0 left-0 right-0 h-(--ui-header-height) flex items-center justify-between border-b border-(--ui-border) px-4 sm:px-6 bg-(--ui-bg)"},ve={class:"flex items-center gap-4"},Ne=E({name:"CommonModelList",__name:"list",setup(i){const f=ae(te).smaller("lg"),g=A(),c=V,p=B({isDialog:!1,currentForm:{},factoryOwnerOptions:[]}),u=async e=>{p.isDialog=!0,e?p.currentForm=K(e):p.currentForm={state:2}},h=async()=>{g.value.reload(),p.isDialog=!1};function k(e){const m=W();return[{label:"编辑",icon:"material-symbols:edit-square-outline",onSelect(){u(e.original)}},{type:"separator"},{label:"模型token",icon:"material-symbols:visibility-outline",onSelect(){m.push(`/model/token/${e.original.id}`)}}]}const w=[..._e,{id:"actions",meta:{class:{th:"w-[80px]",td:"w-[80px]"}},cell:({row:e})=>b("div",{class:"text-right"},b(P,{content:{align:"end"},items:k(e)},()=>b(V,{icon:"i-lucide-ellipsis-vertical",color:"neutral",variant:"ghost",class:"ml-auto"})))}];return(e,m)=>{const v=Y,x=X,d=Z,a=oe,n=ee;return U(),$(Q,null,[t(n,{ui:{body:"pb-[12px]! gap-0!"}},G({body:r(()=>[o(f)?H("",!0):(U(),$("div",ye,[J("div",ve,[t(v),t(d)]),t(o(c),{label:"新增",icon:"i-lucide-plus",onClick:m[1]||(m[1]=s=>u(null))})])),t(a,{ref_key:"tableRef",ref:g,"data-request":o(ie),columns:w,"scroll-x":"min-w-[1800px]"},null,8,["data-request"])]),_:2},[o(f)?{name:"header",fn:r(()=>[t(x,{title:"模型列表"},{leading:r(()=>[t(v)]),right:r(()=>[t(o(c),{label:"新增",icon:"i-lucide-plus",onClick:m[0]||(m[0]=s=>u(null))})]),_:1})]),key:"0"}:void 0]),1024),t(o(ge),{dialog:o(p).isDialog,"onUpdate:dialog":m[2]||(m[2]=s=>o(p).isDialog=s),"current-form":o(p).currentForm,onRefresh:h},null,8,["dialog","current-form"])],64)}}});export{Ne as default};
