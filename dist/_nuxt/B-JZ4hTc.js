import{n as $,m as z,_ as w,a as T}from"./DiI9-bkE.js";import{_ as B}from"./Bml5z8l2.js";import{_ as D}from"./DxT_AjaP.js";import{_ as S}from"./CuFgEFCp.js";import{f as U}from"./CE7u-7DH.js";import{d as V}from"./B33qAI9M.js";import{p as j,j as N,z as l,a1 as A,a2 as c,Q as a,a7 as n,a5 as d,a6 as m,u as e,A as r,W as L,ah as M,R as h,c as R,r as I}from"./Cp_GvCOL.js";import"./CM1DIlR0.js";import"./B3KMLFeu.js";import"./BlLzDdHJ.js";import"./DaMwIZ4f.js";import"./BnfZ4xmv.js";import"./CangPKqO.js";import"./C8Jf-TuN.js";const P={class:"mb-4 flex items-center gap-2"},E={key:0,class:"flex items-center justify-center py-20"},F={key:1,class:"space-y-3"},Q={class:"flex gap-4"},W=["src","alt"],q={class:"flex-1 min-w-0"},G={class:"font-medium truncate"},H={class:"mt-1 text-sm text-(--ui-text-muted) line-clamp-2"},J={class:"mt-2 flex items-center gap-3 text-xs text-(--ui-text-muted)"},K={class:"flex flex-col gap-2 shrink-0"},O={key:2,class:"text-center py-20 text-(--ui-text-muted)"},X={key:3,class:"mt-4 flex justify-end"},pt=j({name:"MemberChatList",__name:"[id]",setup(Y){const v=$(),_=z(),u=R(()=>v.params.id),t=I({loading:!1,list:[],total:0,page:1,pageSize:12}),f=async()=>{t.loading=!0;try{const{data:i}=await V({uid:u.value,page:t.page,pagesize:t.pageSize});t.list=i?.list||[],t.total=i?.count||0}finally{t.loading=!1}},y=i=>{t.page=i,f()};return N(()=>f()),(i,s)=>{const p=w,g=B,x=T,b=D,k=S;return l(),A(k,null,{default:c(()=>[a("div",P,[n(p,{icon:"i-lucide-arrow-left",color:"neutral",variant:"ghost",to:"/member/list"}),s[0]||(s[0]=a("h2",{class:"text-lg font-semibold"},"用户聊天",-1)),n(g,{color:"neutral",variant:"subtle"},{default:c(()=>[d("共 "+m(e(t).total)+" 条",1)]),_:1})]),e(t).loading?(l(),r("div",E,[n(x,{name:"i-lucide-loader",class:"w-8 h-8 animate-spin text-(--ui-text-muted)"})])):(l(),r("div",F,[(l(!0),r(L,null,M(e(t).list,o=>(l(),r("div",{key:o._id,class:"p-4 rounded-xl bg-(--ui-bg-elevated) border border-(--ui-border)"},[a("div",Q,[a("img",{src:o.game?.image,alt:o.game?.name,class:"w-16 h-16 rounded-lg object-cover shrink-0"},null,8,W),a("div",q,[a("div",G,m(o.game?.name),1),a("div",H,m(o.content),1),a("div",J,[n(g,{color:o.role==="assistant"?"primary":"neutral",variant:"subtle",size:"xs"},{default:c(()=>[d(m(o.role==="assistant"?"AI":"用户"),1)]),_:2},1032,["color"]),a("span",null,m(("formatToDateTime"in i?i.formatToDateTime:e(U))(o.created_at)),1)])]),a("div",K,[n(p,{size:"xs",color:"primary",variant:"soft",icon:"i-lucide-file-text",onClick:C=>e(_).push(`/member/chat-summary/${e(u)}/${o.game?.id}`)},{default:c(()=>[...s[1]||(s[1]=[d("摘要",-1)])]),_:1},8,["onClick"]),n(p,{size:"xs",color:"neutral",variant:"soft",icon:"i-lucide-history",onClick:C=>e(_).push(`/member/chat-history/${e(u)}/${o.game?.id}`)},{default:c(()=>[...s[2]||(s[2]=[d("历史",-1)])]),_:1},8,["onClick"])])])]))),128))])),!e(t).loading&&e(t).list.length===0?(l(),r("div",O,[n(x,{name:"i-lucide-message-circle-x",class:"w-12 h-12 mx-auto mb-2 opacity-50"}),s[3]||(s[3]=a("p",null,"暂无聊天记录",-1))])):h("",!0),e(t).total>e(t).pageSize?(l(),r("div",X,[n(b,{"model-value":e(t).page,total:e(t).total,"page-count":e(t).pageSize,"onUpdate:modelValue":y},null,8,["model-value","total","page-count"])])):h("",!0)]),_:1})}}});export{pt as default};
