import{w as D,_ as R,x as h,d as T}from"./DiI9-bkE.js";import{_ as E}from"./oJBVUttf.js";import{_ as M}from"./BdKneTYw.js";import{_ as Y}from"./_BOBmhmt.js";import{_ as z}from"./DkYr1hfb.js";import{_ as S}from"./9B_i7pfW.js";import{_ as H}from"./8gEztUrL.js";import{y as I}from"./adOTzFDE.js";import{c as b}from"./B3KMLFeu.js";import{p as N,ai as O,w as A,z as Q,a1 as q,a2 as m,Q as d,a7 as l,u as a,a6 as w,i as G,c as J,r as L,E as r}from"./Cp_GvCOL.js";import{o as P,n as W}from"./CgOwER5m.js";import{_ as v}from"./Bml5z8l2.js";const X={class:"max-h-[75vh] overflow-y-auto p-6 space-y-4"},Z={class:"flex items-center gap-3 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg"},ee={class:"min-w-0 flex-1"},te={class:"font-medium text-gray-900 dark:text-white"},ae={class:"text-sm text-gray-500 truncate"},se={class:"flex justify-end gap-3"},oe=N({__name:"Edit",props:{dialog:{type:Boolean,default:!1},currentForm:{default:()=>({})}},emits:["update:dialog","refresh"],setup(o,{emit:e}){const i=o,u=e,f=J({get(){return i.dialog},set(c){u("update:dialog",c)}}),_=()=>{f.value=!1},x=O("formRef"),V=D(),k=[{label:"待处理",value:0},{label:"已回复",value:1},{label:"已关闭",value:2}],U=P({state:W().min(0)}),t=L({loading:!1,form:{id:0,title:"",content:"",reply:"",state:0,member:null}});async function $(){t.loading=!0;const c=b(t.form),{error:s}=await I(c);s||(V.add({title:"操作成功",color:"success"}),u("refresh"),_()),t.loading=!1}return A(()=>i.dialog,c=>{c&&i.currentForm&&(t.form=b(i.currentForm))}),(c,s)=>{const F=h,K=E,p=M,g=Y,C=z,j=S,y=R,B=H;return Q(),q(B,{open:a(f),"onUpdate:open":s[5]||(s[5]=n=>G(f)?f.value=n:null),title:"回复反馈",description:"编辑反馈信息并回复用户",ui:{content:"sm:max-w-3xl",body:"p-0",footer:"justify-end bg-gray-50 dark:bg-gray-900"}},{body:m(()=>[d("div",X,[d("div",Z,[l(F,{src:a(t).form.member?.avatar,alt:a(t).form.member?.username,size:"lg"},null,8,["src","alt"]),d("div",ee,[d("div",te,w(a(t).form.member?.username||"未知用户"),1),d("div",ae,w(a(t).form.member?.email||""),1)])]),l(j,{ref_key:"formRef",ref:x,schema:a(U),state:a(t).form,class:"space-y-4",onSubmit:$},{default:m(()=>[l(p,{label:"标题",name:"title"},{default:m(()=>[l(K,{modelValue:a(t).form.title,"onUpdate:modelValue":s[0]||(s[0]=n=>a(t).form.title=n),disabled:"",class:"w-full"},null,8,["modelValue"])]),_:1}),l(p,{label:"反馈内容",name:"content"},{default:m(()=>[l(g,{modelValue:a(t).form.content,"onUpdate:modelValue":s[1]||(s[1]=n=>a(t).form.content=n),rows:3,disabled:"",class:"w-full"},null,8,["modelValue"])]),_:1}),l(p,{label:"回复内容",name:"reply"},{default:m(()=>[l(g,{modelValue:a(t).form.reply,"onUpdate:modelValue":s[2]||(s[2]=n=>a(t).form.reply=n),placeholder:"请输入回复内容",rows:4,class:"w-full"},null,8,["modelValue"])]),_:1}),l(p,{label:"状态",name:"state"},{default:m(()=>[l(C,{modelValue:a(t).form.state,"onUpdate:modelValue":s[3]||(s[3]=n=>a(t).form.state=n),items:k,class:"w-full"},null,8,["modelValue"])]),_:1})]),_:1},8,["schema","state"])])]),footer:m(()=>[d("div",se,[l(y,{label:"取消",color:"neutral",variant:"outline",onClick:_}),l(y,{loading:a(t).loading,label:"保存",onClick:s[4]||(s[4]=n=>a(x)?.submit())},null,8,["loading"])])]),_:1},8,["open"])}}}),ye=Object.assign(oe,{__name:"FeedEdit"}),le={0:["待处理","warning"],1:["已回复","success"],2:["已关闭","info"]},be=[{accessorKey:"id",header:"ID",meta:{class:{th:"w-[60px]",td:"w-[60px]"}}},{accessorKey:"member",header:"用户",meta:{class:{th:"w-[180px]",td:"w-[180px]"}},cell:({row:o})=>{const e=o.original.member;return e?r("div",{class:"flex items-center gap-2"},[r(h,{src:e.avatar,alt:e.username,size:"sm"}),r("div",{class:"min-w-0"},[r("div",{class:"font-medium text-gray-900 dark:text-white truncate"},e.username||"-"),r("div",{class:"text-xs text-gray-500 truncate"},e.email||"")])]):r("span",{class:"text-gray-400"},"-")}},{accessorKey:"title",header:"标题",meta:{class:{th:"min-w-[150px]",td:"min-w-[150px]"}},cell:({row:o})=>{const e=o.original.title||"-";return r("div",{class:"font-medium text-gray-900 dark:text-white"},e)}},{accessorKey:"content",header:"内容",meta:{class:{th:"min-w-[180px]",td:"min-w-[180px]"}},cell:({row:o})=>{const e=o.original.content||"-";return r("div",{class:"text-sm text-gray-600 dark:text-gray-400 truncate max-w-[200px]",title:e},e)}},{accessorKey:"reply",header:"回复",meta:{class:{th:"min-w-[180px]",td:"min-w-[180px]"}},cell:({row:o})=>{const e=o.original.reply;return e?r("div",{class:"text-sm text-gray-600 dark:text-gray-400 truncate max-w-[200px]",title:e},e):r(v,{color:"neutral",variant:"subtle",label:"未回复"})}},{accessorKey:"state",header:"状态",meta:{class:{th:"w-[100px]",td:"w-[100px]"}},cell:({row:o})=>{const e=o.original.state,[i,u]=le[e]||["未知","info"];return r(v,{color:u,variant:"subtle",label:i})}},{accessorKey:"created_at",header:"创建时间",meta:{class:{th:"w-[160px]",td:"w-[160px]"}},cell:({row:o})=>r("span",{class:"text-sm text-gray-600 dark:text-gray-400"},T(o.original.created_at).format("YYYY-MM-DD HH:mm"))}];export{ye as _,be as b};
